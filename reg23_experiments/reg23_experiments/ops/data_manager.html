<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 16.0.0"/>
    <title>reg23_experiments.ops.data_manager API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:27px;vertical-align:bottom;width:50px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../ops.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;reg23_experiments.ops</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#getting-started">Getting started</a></li>
</ul>


            <h2>Submodules</h2>
            <ul>
                    <li><a href="data_manager/updaters.html">updaters</a></li>
            </ul>

            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#dadg_updater">dadg_updater</a>
            </li>
            <li>
                    <a class="function" href="#args_from_dadg">args_from_dadg</a>
            </li>
            <li>
                    <a class="function" href="#data_manager">data_manager</a>
            </li>
            <li>
                    <a class="class" href="#StandaloneDADGSingleton">StandaloneDADGSingleton</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#StandaloneDADGSingleton.get">get</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Updater">Updater</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Updater.__init__">Updater</a>
                        </li>
                        <li>
                                <a class="variable" href="#Updater.function">function</a>
                        </li>
                        <li>
                                <a class="variable" href="#Updater.returned">returned</a>
                        </li>
                        <li>
                                <a class="variable" href="#Updater.arguments">arguments</a>
                        </li>
                        <li>
                                <a class="variable" href="#Updater.dependencies">dependencies</a>
                        </li>
                        <li>
                                <a class="function" href="#Updater.build">build</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#DirectedAcyclicDataGraph">DirectedAcyclicDataGraph</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DirectedAcyclicDataGraph.has_node">has_node</a>
                        </li>
                        <li>
                                <a class="function" href="#DirectedAcyclicDataGraph.get">get</a>
                        </li>
                        <li>
                                <a class="function" href="#DirectedAcyclicDataGraph.set">set</a>
                        </li>
                        <li>
                                <a class="function" href="#DirectedAcyclicDataGraph.set_multiple">set_multiple</a>
                        </li>
                        <li>
                                <a class="function" href="#DirectedAcyclicDataGraph.set_evaluation_laziness">set_evaluation_laziness</a>
                        </li>
                        <li>
                                <a class="function" href="#DirectedAcyclicDataGraph.observe">observe</a>
                        </li>
                        <li>
                                <a class="function" href="#DirectedAcyclicDataGraph.remove_observer">remove_observer</a>
                        </li>
                        <li>
                                <a class="function" href="#DirectedAcyclicDataGraph.add_updater">add_updater</a>
                        </li>
                        <li>
                                <a class="function" href="#DirectedAcyclicDataGraph.remove_updater">remove_updater</a>
                        </li>
                        <li>
                                <a class="function" href="#DirectedAcyclicDataGraph.get_with_args">get_with_args</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ChildDirectedAcyclicDataGraph">ChildDirectedAcyclicDataGraph</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#StandaloneDADG">StandaloneDADG</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#StandaloneDADG.has_node">has_node</a>
                        </li>
                        <li>
                                <a class="function" href="#StandaloneDADG.get">get</a>
                        </li>
                        <li>
                                <a class="function" href="#StandaloneDADG.set">set</a>
                        </li>
                        <li>
                                <a class="function" href="#StandaloneDADG.set_multiple">set_multiple</a>
                        </li>
                        <li>
                                <a class="function" href="#StandaloneDADG.set_evaluation_laziness">set_evaluation_laziness</a>
                        </li>
                        <li>
                                <a class="function" href="#StandaloneDADG.observe">observe</a>
                        </li>
                        <li>
                                <a class="function" href="#StandaloneDADG.remove_observer">remove_observer</a>
                        </li>
                        <li>
                                <a class="function" href="#StandaloneDADG.add_updater">add_updater</a>
                        </li>
                        <li>
                                <a class="function" href="#StandaloneDADG.remove_updater">remove_updater</a>
                        </li>
                        <li>
                                <a class="function" href="#StandaloneDADG.get_with_args">get_with_args</a>
                        </li>
                        <li>
                                <a class="function" href="#StandaloneDADG.render">render</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ChildDADG">ChildDADG</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ChildDADG.__init__">ChildDADG</a>
                        </li>
                        <li>
                                <a class="function" href="#ChildDADG.has_node">has_node</a>
                        </li>
                        <li>
                                <a class="function" href="#ChildDADG.get">get</a>
                        </li>
                        <li>
                                <a class="function" href="#ChildDADG.set">set</a>
                        </li>
                        <li>
                                <a class="function" href="#ChildDADG.set_multiple">set_multiple</a>
                        </li>
                        <li>
                                <a class="function" href="#ChildDADG.set_evaluation_laziness">set_evaluation_laziness</a>
                        </li>
                        <li>
                                <a class="function" href="#ChildDADG.observe">observe</a>
                        </li>
                        <li>
                                <a class="function" href="#ChildDADG.remove_observer">remove_observer</a>
                        </li>
                        <li>
                                <a class="function" href="#ChildDADG.add_updater">add_updater</a>
                        </li>
                        <li>
                                <a class="function" href="#ChildDADG.remove_updater">remove_updater</a>
                        </li>
                        <li>
                                <a class="function" href="#ChildDADG.get_with_args">get_with_args</a>
                        </li>
                        <li>
                                <a class="function" href="#ChildDADG.render">render</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22160%22%20viewBox%3D%220%200%20150%2080%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M132.316%2048.886c.276-4.679%202.342-6.698%204.409-7.982s4.27-1.165%206.751-1.055c1.586.07%203.044.156%204.222-.482%201.142-.619%202.026-1.932%202.162-3.739.268-3.576-1.929-5.368-5.006-5.551s-7.599.524-10.517%201.606c-4.455%201.652-8.588%206.606-9.552%208.992s-2.342%206.193-1.745%2010.873%202.664%209.221%205.878%2011.79%205.878%203.808%2010.103%204.312%203.444.229%206.062.229%205.006-2.202%204.914-4.909-2.296-5.001-4.501-4.863-3.077.505-5.281.229-7.715-2.064-7.899-9.451z%22%20fill%3D%22%23198754%22/%3E%3Ccircle%20cx%3D%22101.504%22%20cy%3D%2248.943%22%20r%3D%2214.208%22%20fill%3D%22none%22%20stroke%3D%22%23198754%22%20stroke-width%3D%229.354%22/%3E%3Cpath%20d%3D%22M87.81.002c-3.637.065-5.001.454-7.014%201.232s-3.443%201.363-6.3%204.282c-1.723%201.76-3.148%205.019-3.776%207.329-.413%201.521-.316%202.63-.316%202.63l-.195%2034.612c.065%205.774-6.755%208.305-9.612%208.37s-9.678-1.038-9.743-9.408%207.128-9.521%208.362-9.521c1.413-.13%202.526-.021%203.718-.016%202.071.009%204.157-.778%204.092-4.671s-4.157-4.736-4.157-4.736c-6.3-.843-11.43%202.206-11.43%202.206S40.917%2038.15%2041.372%2049.634%2051.568%2068.19%2061.311%2068.125s18.316-7.007%2018.445-17.193l.13-22.772c.046-2.291%202.683-3.644%204.476-4.203.745-.232%201.694-.274%201.694-.274l10.457-.13s4.871-.324%207.729-3.114%204.352-6.294%204.352-6.294.974-3.049.13-4.606-.195-1.233-2.792-3.309-8.573-4.477-8.573-4.477S91.447-.063%2087.81.002zM0%2047.169l.065%2028.417S0%2080.127%204.481%2079.997s5.072-3.866%205.049-4.152l-.113-28.482s1.624-7.656%209.937-7.721%2010.002%206.942%2010.002%208.499-.909%2010.51-9.093%2010.51c-.948%200-2.99-.567-4.145-.272-3.919%201-3.194%204.554-3.194%204.554s.065%205.061%207.404%204.996%2018.575-6.034%2018.575-19.074S26.953%2030.04%2019.549%2029.91%201.234%2035.296%200%2047.169z%22%20fill%3D%22%23198754%22/%3E%3Cg%20transform%3D%22matrix%28.325601%200%200%20.325256%20-10.32669%20-45.802786%29%22%3E%3Ccircle%20cx%3D%22297.554%22%20cy%3D%22172.286%22%20r%3D%2216.5%22%20fill%3D%22%23fff%22/%3E%3Cellipse%20cx%3D%22297.709%22%20cy%3D%22172.642%22%20rx%3D%2211.071%22%20ry%3D%2210.871%22%20fill%3D%22%23105a48%22/%3E%3Ccircle%20cx%3D%22304.104%22%20cy%3D%22167.667%22%20r%3D%224.5%22%20fill%3D%22%23fff%22/%3E%3C/g%3E%3Cpath%20d%3D%22M94.661%2017.032l.893-1.476s.99.714%201.916.925%201.575.114%202.955.114l14.565-.162c1.283-.032%203.085-.762%203.02-3.293s-.373-3.503-.373-3.503l1.283-.487s.52.503.877%201.573.309%201.995.292%202.66-.227%201.541-.227%201.541%201.564-.308%202.359-1.038.823-.779%201.489-1.508.812-.86.812-.86.552-.13.877.26.341.957.065%201.46-1.672%202.206-3.247%203.066-2.76%201.427-3.929%201.768-3.848.73-7.063.714l-10.944-.114s-2.143-.081-3.02-.373-2.241-.973-2.598-1.265z%22%20fill%3D%22%23d36d49%22/%3E%3Cg%20fill%3D%22%23105a48%22%3E%3Cellipse%20cx%3D%2293.052%22%20cy%3D%2243.567%22%20rx%3D%22.869%22%20ry%3D%221.014%22%20transform%3D%22rotate%28341.022%29%22/%3E%3Cellipse%20cx%3D%22104.3%22%20cy%3D%22-16.184%22%20rx%3D%22.865%22%20ry%3D%221.009%22%20transform%3D%22rotate%2814.786%29%22/%3E%3C/g%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../reg23_experiments.html">reg23_experiments</a><wbr>.<a href="./../ops.html">ops</a><wbr>.data_manager    </h1>

                        <div class="docstring"><p>This package provides a suite of modular tools built around a directed acyclic data graph (<code>DADG</code>) data structure for
managing data.</p>

<h2 id="getting-started">Getting started</h2>

<p>The <code><a href="#data_manager">data_manager()</a></code> is a singleton instance of <code><a href="#StandaloneDADG">StandaloneDADG</a></code> used to keep track of data and which data depends on
which other data. Here is an example to illustrate its purpose:</p>

<h3 id="motivation-behind-the-directed-acyclic-data-graph">Motivation behind the directed acyclic data graph</h3>

<p>Let's say you have some data read from files at the start, like a CT scan and an X-ray image. Dependent on these you
have a long pipeline of images and data which depend on each other and these images, for example involving cropping,
masking, downsampling, projecting etc.... The <code>IDirectedAcyclicDataGraph</code> allows you to only define the dependencies
between the images, and will automatically perform the operations that evaluate the images when the dependencies change.</p>

<h4 id="a-simple-example">A simple example</h4>

<p>You have a CT scan volume loaded from a file, and want to use it at various downsampling ratios. You could just store
the raw CT volume, and perform a downsampling whenever you want to access it, like so:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="n">ct_volume</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">=</span> <span class="n">load_from_file</span><span class="p">(</span><span class="s2">&quot;/my_ct_volume.nrrd&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">downsample_ct_volume</span><span class="p">(</span><span class="n">vol</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">ratio</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">avg_pool3d</span><span class="p">(</span><span class="n">vol</span><span class="p">,</span> <span class="n">ratio</span><span class="p">)</span>


<span class="o">...</span>

<span class="n">use_ct_volume</span><span class="p">(</span><span class="n">downsample_ct_volume</span><span class="p">(</span><span class="n">ct_volume</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="o">...</span>
<span class="n">use_ct_volume_again</span><span class="p">(</span><span class="n">downsample_ct_volume</span><span class="p">(</span><span class="n">ct_volume</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="o">...</span>
<span class="n">use_ct_volume_again</span><span class="p">(</span><span class="n">downsample_ct_volume</span><span class="p">(</span><span class="n">ct_volume</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</code></pre>
</div>

<p>The issue with this is that <code>downsample_ct_volume</code> could be quite expensive for a large volume, so a lot of time would
wasted if the same downsampling ratio was used multiple times in a row. This also becomes much more ugly and even less
efficient if there are more layers of dependency, e.g. if the <code>ct_volume</code> itself depended on something else (like if the
path from which the volume was loaded might change), or if another value was dependent on the downsampled volume.</p>

<p>Caching of values using <code>functools</code> would solve the former of these two issues, so long as the input values were not
floating-point, which would be quite a restriction.</p>

<p>To partially solve the former issue, and completely solve the latter, we use the <code><a href="#DirectedAcyclicDataGraph">DirectedAcyclicDataGraph</a></code> as follows:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn"><a href="">reg23_experiments.ops.data_manager</a></span><span class="w"> </span><span class="kn">import</span> <span class="n">data_manager</span><span class="p">,</span> <span class="n">dadg_updater</span>

<span class="n">data_manager</span><span class="p">()</span><span class="o">.</span><span class="n">set_multiple</span><span class="p">(</span><span class="n">ct_path</span><span class="o">=</span><span class="s2">&quot;/my_ct_volume.nrrd&quot;</span><span class="p">,</span> <span class="n">downsample_ratio</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>


<span class="nd">@dadg_updater</span><span class="p">(</span><span class="n">names_returned</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ct_volume&quot;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_ct_volume</span><span class="p">(</span><span class="n">ct_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;ct_volume&quot;</span><span class="p">:</span> <span class="n">load_from_file</span><span class="p">(</span><span class="n">ct_path</span><span class="p">)}</span>


<span class="nd">@dadg_updater</span><span class="p">(</span><span class="n">names_returned</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ct_volume_downsampled&quot;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">downsample_ct</span><span class="p">(</span><span class="n">ct_volume</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">downsample_ratio</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;ct_volume_downsampled&quot;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">avg_pool3d</span><span class="p">(</span><span class="n">ct_volume</span><span class="p">,</span> <span class="n">downsample_ratio</span><span class="p">)}</span>


<span class="n">data_manager</span><span class="p">()</span><span class="o">.</span><span class="n">add_updater</span><span class="p">(</span><span class="s2">&quot;load_ct_volume&quot;</span><span class="p">,</span> <span class="n">load_ct_volume</span><span class="p">)</span>
<span class="n">data_manager</span><span class="p">()</span><span class="o">.</span><span class="n">add_updater</span><span class="p">(</span><span class="s2">&quot;downsample_ct&quot;</span><span class="p">,</span> <span class="n">downsample_ct</span><span class="p">)</span>

<span class="o">...</span>

<span class="n">use_ct_volume</span><span class="p">(</span><span class="n">data_manager</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ct_volume_downsampled&quot;</span><span class="p">))</span>
<span class="o">...</span>
<span class="n">use_ct_volume_again</span><span class="p">(</span><span class="n">data_manager</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ct_volume_downsampled&quot;</span><span class="p">))</span>
<span class="o">...</span>
<span class="n">data_manager</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;downsample_ratio&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">use_ct_volume_again</span><span class="p">(</span><span class="n">data_manager</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ct_volume_downsampled&quot;</span><span class="p">))</span>
</code></pre>
</div>

<p>A walk through the above code:</p>

<ul>
<li>The first call to <code>ata_manager()</code> constructs the singleton instance of the <code><a href="#StandaloneDADG">StandaloneDADG</a></code>.</li>
<li>We set some values in the data manager using <code>data_manager().set_multiple(...)</code>. This just interprets each
keyword argument as a new (name, value) pair to insert into the graph.</li>
<li>We define two instances of the <code><a href="#Updater">Updater</a></code> class using the <code>@dadg_updater</code> decorator, which transforms the decorated
function into an instance of <code><a href="#Updater">Updater</a></code>. This is an object which is used to define dependencies between nodes in the
data manager graph: the arguments of the function define the variables that are depended upon, and the (key, value)
pairs in the returned dictionary define the variables that are dependent on them. The function itself defines the
mapping from the 'depended' to the 'dependent'.</li>
<li>We insert these <code><a href="#Updater">Updater</a></code>s into the data manager using <code>data_manager().add_updater(...)</code>. The strings passed here are
just arbitrary names, which we have chosen to match the updater names. Updaters can also be removed from the data,
and this is done by the string name passed here.</li>
<li>Then, to obtain the downsample CT image, we need only call <code>data_manager().get("ct_volume_downsampled")</code>. This will
retrieve a previously calculated value if it is consistent with the dependencies, or run the appropriate <code><a href="#Updater">Updater</a></code>s to
re-evaluate the variable if the dependencies have changed.</li>
<li>The first call to <code>data_manager().get("ct_volume_downsampled")</code> in the code above will result in both <code>load_ct_volume</code>
and <code>downsample_ct</code> being called for the first time to evaluate <code>"ct_volume"</code> and then <code>"ct_volume_downsampled"</code>.</li>
<li>The second call will not perform any evaluation, as the dependencies <code>"ct_path"</code> and <code>"downsample_ratio"</code> have not
changed since the value of <code>"ct_volume_downsampled"</code> was last evaluated.</li>
<li>The third call will result in <code>downsample_ct</code> being called once more, as the value of <code>"downsample_ratio"</code> has changed
since <code>"ct_volume_downsampled"</code> was last evaluated.</li>
</ul>
</div>

                        <input id="mod-data_manager-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-data_manager-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="sd">.. include:: package_documentation.md</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">._public</span><span class="w"> </span><span class="kn">import</span> <span class="n">dadg_updater</span><span class="p">,</span> <span class="n">args_from_dadg</span><span class="p">,</span> <span class="n">data_manager</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">._data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Updater</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">._directed_acyclic_data_graph</span><span class="w"> </span><span class="kn">import</span> <span class="n">DirectedAcyclicDataGraph</span><span class="p">,</span> <span class="n">ChildDirectedAcyclicDataGraph</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">._dadg_standalone</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandaloneDADG</span><span class="p">,</span> <span class="n">StandaloneDADGSingleton</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">._dadg_child</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChildDADG</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;updaters&quot;</span><span class="p">,</span> <span class="s2">&quot;dadg_updater&quot;</span><span class="p">,</span> <span class="s2">&quot;args_from_dadg&quot;</span><span class="p">,</span> <span class="s2">&quot;data_manager&quot;</span><span class="p">,</span> <span class="s2">&quot;StandaloneDADGSingleton&quot;</span><span class="p">,</span> <span class="s2">&quot;Updater&quot;</span><span class="p">,</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a>           <span class="s2">&quot;DirectedAcyclicDataGraph&quot;</span><span class="p">,</span> <span class="s2">&quot;ChildDirectedAcyclicDataGraph&quot;</span><span class="p">,</span> <span class="s2">&quot;StandaloneDADG&quot;</span><span class="p">,</span> <span class="s2">&quot;ChildDADG&quot;</span><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="dadg_updater">
                            <input id="dadg_updater-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">dadg_updater</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">names_returned</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Callable</span><span class="p">[[</span><span class="n">Callable</span><span class="p">],</span> <span class="n"><a href="#Updater">Updater</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="dadg_updater-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#dadg_updater"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="dadg_updater-19"><a href="#dadg_updater-19"><span class="linenos">19</span></a><span class="k">def</span><span class="w"> </span><span class="nf">dadg_updater</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">names_returned</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Callable</span><span class="p">],</span> <span class="n">Updater</span><span class="p">]:</span>
</span><span id="dadg_updater-20"><a href="#dadg_updater-20"><span class="linenos">20</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="dadg_updater-21"><a href="#dadg_updater-21"><span class="linenos">21</span></a><span class="sd">    A decorator for turning a function into an `Updater` for use in an `IDirectedAcyclicDataGraph`. The named</span>
</span><span id="dadg_updater-22"><a href="#dadg_updater-22"><span class="linenos">22</span></a><span class="sd">    arguments of the function will be interpreted as nodes from which to read data from the</span>
</span><span id="dadg_updater-23"><a href="#dadg_updater-23"><span class="linenos">23</span></a><span class="sd">    `IDirectedAcyclicDataGraph`. The return value of the function must be a dictionary mapping string &#39;names&#39; to</span>
</span><span id="dadg_updater-24"><a href="#dadg_updater-24"><span class="linenos">24</span></a><span class="sd">    values, where the strings must match the contents of the list `names_returned`. The returned names will be used</span>
</span><span id="dadg_updater-25"><a href="#dadg_updater-25"><span class="linenos">25</span></a><span class="sd">    as node names for updating values in the `IDirectedAcyclicDataGraph` with the returned values.</span>
</span><span id="dadg_updater-26"><a href="#dadg_updater-26"><span class="linenos">26</span></a><span class="sd">    :param names_returned: A list of the names of the values returned by the function.</span>
</span><span id="dadg_updater-27"><a href="#dadg_updater-27"><span class="linenos">27</span></a><span class="sd">    :return: An instance of `Updater`, built using the decorated function.</span>
</span><span id="dadg_updater-28"><a href="#dadg_updater-28"><span class="linenos">28</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="dadg_updater-29"><a href="#dadg_updater-29"><span class="linenos">29</span></a>
</span><span id="dadg_updater-30"><a href="#dadg_updater-30"><span class="linenos">30</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">function</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Updater</span><span class="p">:</span>
</span><span id="dadg_updater-31"><a href="#dadg_updater-31"><span class="linenos">31</span></a>        <span class="k">return</span> <span class="n">Updater</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="n">function</span><span class="p">,</span> <span class="n">returned</span><span class="o">=</span><span class="n">names_returned</span><span class="p">)</span>
</span><span id="dadg_updater-32"><a href="#dadg_updater-32"><span class="linenos">32</span></a>
</span><span id="dadg_updater-33"><a href="#dadg_updater-33"><span class="linenos">33</span></a>    <span class="k">return</span> <span class="n">decorator</span>
</span></pre></div>


            <div class="docstring"><p>A decorator for turning a function into an <code><a href="#Updater">Updater</a></code> for use in an <code>IDirectedAcyclicDataGraph</code>. The named
arguments of the function will be interpreted as nodes from which to read data from the
<code>IDirectedAcyclicDataGraph</code>. The return value of the function must be a dictionary mapping string 'names' to
values, where the strings must match the contents of the list <code>names_returned</code>. The returned names will be used
as node names for updating values in the <code>IDirectedAcyclicDataGraph</code> with the returned values.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>names_returned</strong>:  A list of the names of the values returned by the function.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>An instance of <code><a href="#Updater">Updater</a></code>, built using the decorated function.</p>
</blockquote>
</div>


                </section>
                <section id="args_from_dadg">
                            <input id="args_from_dadg-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">args_from_dadg</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">names_left</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="args_from_dadg-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#args_from_dadg"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="args_from_dadg-36"><a href="#args_from_dadg-36"><span class="linenos"> 36</span></a><span class="k">def</span><span class="w"> </span><span class="nf">args_from_dadg</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">names_left</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="args_from_dadg-37"><a href="#args_from_dadg-37"><span class="linenos"> 37</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="args_from_dadg-38"><a href="#args_from_dadg-38"><span class="linenos"> 38</span></a><span class="sd">    A decorator for indicating that a function&#39;s arguments should be read from the `DAG`. The named arguments of the</span>
</span><span id="args_from_dadg-39"><a href="#args_from_dadg-39"><span class="linenos"> 39</span></a><span class="sd">    function will be interpreted as nodes from which to read data from the `DAG`. The return value will not be</span>
</span><span id="args_from_dadg-40"><a href="#args_from_dadg-40"><span class="linenos"> 40</span></a><span class="sd">    modified/intercepted, but an `Error` may be returned instead in the case of a failure to get any argument from</span>
</span><span id="args_from_dadg-41"><a href="#args_from_dadg-41"><span class="linenos"> 41</span></a><span class="sd">    the `DAG`. Arguments that should be left alone can be listed in the decorator argument `names_left`.</span>
</span><span id="args_from_dadg-42"><a href="#args_from_dadg-42"><span class="linenos"> 42</span></a><span class="sd">    :param names_left: A list of the arguments to leave in the function&#39;s signature (i.e. to not get from the DAG)</span>
</span><span id="args_from_dadg-43"><a href="#args_from_dadg-43"><span class="linenos"> 43</span></a>
</span><span id="args_from_dadg-44"><a href="#args_from_dadg-44"><span class="linenos"> 44</span></a><span class="sd">    Example use with no `names_left`:</span>
</span><span id="args_from_dadg-45"><a href="#args_from_dadg-45"><span class="linenos"> 45</span></a><span class="sd">    ```</span>
</span><span id="args_from_dadg-46"><a href="#args_from_dadg-46"><span class="linenos"> 46</span></a><span class="sd">    @args_from_dag()</span>
</span><span id="args_from_dadg-47"><a href="#args_from_dadg-47"><span class="linenos"> 47</span></a><span class="sd">    def subtract_moving_from_fixed(moving_image: torch.Tensor, fixed_image: torch.Tensor) -&gt; torch.Tensor:</span>
</span><span id="args_from_dadg-48"><a href="#args_from_dadg-48"><span class="linenos"> 48</span></a><span class="sd">        return fixed_image - moving_image</span>
</span><span id="args_from_dadg-49"><a href="#args_from_dadg-49"><span class="linenos"> 49</span></a><span class="sd">    ```</span>
</span><span id="args_from_dadg-50"><a href="#args_from_dadg-50"><span class="linenos"> 50</span></a><span class="sd">    will be effectively be turned into:</span>
</span><span id="args_from_dadg-51"><a href="#args_from_dadg-51"><span class="linenos"> 51</span></a><span class="sd">    ```</span>
</span><span id="args_from_dadg-52"><a href="#args_from_dadg-52"><span class="linenos"> 52</span></a><span class="sd">    from program import data_manager</span>
</span><span id="args_from_dadg-53"><a href="#args_from_dadg-53"><span class="linenos"> 53</span></a><span class="sd">    def subtract_moving_from_fixed() -&gt; torch.Tensor:</span>
</span><span id="args_from_dadg-54"><a href="#args_from_dadg-54"><span class="linenos"> 54</span></a><span class="sd">        moving_image = data_manager().get(&quot;moving_image&quot;)</span>
</span><span id="args_from_dadg-55"><a href="#args_from_dadg-55"><span class="linenos"> 55</span></a><span class="sd">        fixed_image = data_manager().get(&quot;fixed_image&quot;)</span>
</span><span id="args_from_dadg-56"><a href="#args_from_dadg-56"><span class="linenos"> 56</span></a><span class="sd">        return fixed_image - moving_image</span>
</span><span id="args_from_dadg-57"><a href="#args_from_dadg-57"><span class="linenos"> 57</span></a><span class="sd">    ```</span>
</span><span id="args_from_dadg-58"><a href="#args_from_dadg-58"><span class="linenos"> 58</span></a>
</span><span id="args_from_dadg-59"><a href="#args_from_dadg-59"><span class="linenos"> 59</span></a><span class="sd">    Example use with some `names_left`:</span>
</span><span id="args_from_dadg-60"><a href="#args_from_dadg-60"><span class="linenos"> 60</span></a><span class="sd">    ```</span>
</span><span id="args_from_dadg-61"><a href="#args_from_dadg-61"><span class="linenos"> 61</span></a><span class="sd">    @args_from_dag(names_left = [&quot;moving_image&quot;])</span>
</span><span id="args_from_dadg-62"><a href="#args_from_dadg-62"><span class="linenos"> 62</span></a><span class="sd">    def subtract_moving_from_fixed(moving_image: torch.Tensor, fixed_image: torch.Tensor) -&gt; torch.Tensor:</span>
</span><span id="args_from_dadg-63"><a href="#args_from_dadg-63"><span class="linenos"> 63</span></a><span class="sd">        return fixed_image - moving_image</span>
</span><span id="args_from_dadg-64"><a href="#args_from_dadg-64"><span class="linenos"> 64</span></a><span class="sd">    ```</span>
</span><span id="args_from_dadg-65"><a href="#args_from_dadg-65"><span class="linenos"> 65</span></a><span class="sd">    will be effectively be turned into:</span>
</span><span id="args_from_dadg-66"><a href="#args_from_dadg-66"><span class="linenos"> 66</span></a><span class="sd">    ```</span>
</span><span id="args_from_dadg-67"><a href="#args_from_dadg-67"><span class="linenos"> 67</span></a><span class="sd">    from program import data_manager</span>
</span><span id="args_from_dadg-68"><a href="#args_from_dadg-68"><span class="linenos"> 68</span></a><span class="sd">    def subtract_moving_from_fixed(moving_image: torch.Tensor) -&gt; torch.Tensor:</span>
</span><span id="args_from_dadg-69"><a href="#args_from_dadg-69"><span class="linenos"> 69</span></a><span class="sd">        fixed_image = data_manager().get(&quot;fixed_image&quot;)</span>
</span><span id="args_from_dadg-70"><a href="#args_from_dadg-70"><span class="linenos"> 70</span></a><span class="sd">        return fixed_image - moving_image</span>
</span><span id="args_from_dadg-71"><a href="#args_from_dadg-71"><span class="linenos"> 71</span></a><span class="sd">    ```</span>
</span><span id="args_from_dadg-72"><a href="#args_from_dadg-72"><span class="linenos"> 72</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="args_from_dadg-73"><a href="#args_from_dadg-73"><span class="linenos"> 73</span></a>    <span class="k">if</span> <span class="n">names_left</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="args_from_dadg-74"><a href="#args_from_dadg-74"><span class="linenos"> 74</span></a>        <span class="n">names_left</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="args_from_dadg-75"><a href="#args_from_dadg-75"><span class="linenos"> 75</span></a>
</span><span id="args_from_dadg-76"><a href="#args_from_dadg-76"><span class="linenos"> 76</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">function</span><span class="p">):</span>
</span><span id="args_from_dadg-77"><a href="#args_from_dadg-77"><span class="linenos"> 77</span></a>        <span class="k">if</span> <span class="n">takes_positional_args</span><span class="p">(</span><span class="n">function</span><span class="p">):</span>
</span><span id="args_from_dadg-78"><a href="#args_from_dadg-78"><span class="linenos"> 78</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Functions decorated with `args_from_dag` must not take positional arguments. Prepend &quot;</span>
</span><span id="args_from_dadg-79"><a href="#args_from_dadg-79"><span class="linenos"> 79</span></a>                             <span class="sa">f</span><span class="s2">&quot;arguments with `*` to ensure this.&quot;</span><span class="p">)</span>
</span><span id="args_from_dadg-80"><a href="#args_from_dadg-80"><span class="linenos"> 80</span></a>        <span class="c1"># all names specified in `named_left` must names of function arguments</span>
</span><span id="args_from_dadg-81"><a href="#args_from_dadg-81"><span class="linenos"> 81</span></a>        <span class="n">arguments</span> <span class="o">=</span> <span class="n">FunctionArgument</span><span class="o">.</span><span class="n">get_for_function</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
</span><span id="args_from_dadg-82"><a href="#args_from_dadg-82"><span class="linenos"> 82</span></a>        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names_left</span><span class="p">:</span>
</span><span id="args_from_dadg-83"><a href="#args_from_dadg-83"><span class="linenos"> 83</span></a>            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">argument</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">]:</span>
</span><span id="args_from_dadg-84"><a href="#args_from_dadg-84"><span class="linenos"> 84</span></a>                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Every value in `names_left` must the name of one of the function&#39;s arguments. &quot;</span>
</span><span id="args_from_dadg-85"><a href="#args_from_dadg-85"><span class="linenos"> 85</span></a>                               <span class="sa">f</span><span class="s2">&quot;Unrecognised name &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
</span><span id="args_from_dadg-86"><a href="#args_from_dadg-86"><span class="linenos"> 86</span></a>
</span><span id="args_from_dadg-87"><a href="#args_from_dadg-87"><span class="linenos"> 87</span></a>        <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
</span><span id="args_from_dadg-88"><a href="#args_from_dadg-88"><span class="linenos"> 88</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="args_from_dadg-89"><a href="#args_from_dadg-89"><span class="linenos"> 89</span></a>            <span class="c1"># check all left names are in **kwargs</span>
</span><span id="args_from_dadg-90"><a href="#args_from_dadg-90"><span class="linenos"> 90</span></a>            <span class="k">for</span> <span class="n">_name</span> <span class="ow">in</span> <span class="n">names_left</span><span class="p">:</span>
</span><span id="args_from_dadg-91"><a href="#args_from_dadg-91"><span class="linenos"> 91</span></a>                <span class="k">if</span> <span class="n">_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="args_from_dadg-92"><a href="#args_from_dadg-92"><span class="linenos"> 92</span></a>                    <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Argument &#39;</span><span class="si">{</span><span class="n">_name</span><span class="si">}</span><span class="s2">&#39; specified in `names_left` not provided to function.&quot;</span><span class="p">)</span>
</span><span id="args_from_dadg-93"><a href="#args_from_dadg-93"><span class="linenos"> 93</span></a>            <span class="c1"># get appropriate args from the DAG</span>
</span><span id="args_from_dadg-94"><a href="#args_from_dadg-94"><span class="linenos"> 94</span></a>            <span class="n">arguments_to_get</span> <span class="o">=</span> <span class="p">[</span><span class="n">argument</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">arguments</span> <span class="k">if</span> <span class="n">argument</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">names_left</span><span class="p">]</span>
</span><span id="args_from_dadg-95"><a href="#args_from_dadg-95"><span class="linenos"> 95</span></a>            <span class="n">from_dag</span> <span class="o">=</span> <span class="n">data_manager</span><span class="p">()</span><span class="o">.</span><span class="n">get_with_args</span><span class="p">(</span><span class="n">arguments_to_get</span><span class="p">)</span>
</span><span id="args_from_dadg-96"><a href="#args_from_dadg-96"><span class="linenos"> 96</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">from_dag</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="args_from_dadg-97"><a href="#args_from_dadg-97"><span class="linenos"> 97</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to get arguments to run function from dag: </span><span class="si">{</span><span class="n">from_dag</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="args_from_dadg-98"><a href="#args_from_dadg-98"><span class="linenos"> 98</span></a>            <span class="c1"># execute the function</span>
</span><span id="args_from_dadg-99"><a href="#args_from_dadg-99"><span class="linenos"> 99</span></a>            <span class="k">return</span> <span class="n">function</span><span class="p">(</span><span class="o">**</span><span class="n">from_dag</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="args_from_dadg-100"><a href="#args_from_dadg-100"><span class="linenos">100</span></a>
</span><span id="args_from_dadg-101"><a href="#args_from_dadg-101"><span class="linenos">101</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="args_from_dadg-102"><a href="#args_from_dadg-102"><span class="linenos">102</span></a>
</span><span id="args_from_dadg-103"><a href="#args_from_dadg-103"><span class="linenos">103</span></a>    <span class="k">return</span> <span class="n">decorator</span>
</span></pre></div>


            <div class="docstring"><p>A decorator for indicating that a function's arguments should be read from the <code>DAG</code>. The named arguments of the
function will be interpreted as nodes from which to read data from the <code>DAG</code>. The return value will not be
modified/intercepted, but an <code>Error</code> may be returned instead in the case of a failure to get any argument from
the <code>DAG</code>. Arguments that should be left alone can be listed in the decorator argument <code>names_left</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>names_left</strong>:  A list of the arguments to leave in the function's signature (i.e. to not get from the DAG)</li>
</ul>

<p>Example use with no <code>names_left</code>:</p>

<pre><code>@args_from_dag()
def subtract_moving_from_fixed(moving_image: torch.Tensor, fixed_image: torch.Tensor) -&gt; torch.Tensor:
    return fixed_image - moving_image
</code></pre>

<p>will be effectively be turned into:</p>

<pre><code>from program import data_manager
def subtract_moving_from_fixed() -&gt; torch.Tensor:
    moving_image = data_manager().get("moving_image")
    fixed_image = data_manager().get("fixed_image")
    return fixed_image - moving_image
</code></pre>

<p>Example use with some <code>names_left</code>:</p>

<pre><code>@args_from_dag(names_left = ["moving_image"])
def subtract_moving_from_fixed(moving_image: torch.Tensor, fixed_image: torch.Tensor) -&gt; torch.Tensor:
    return fixed_image - moving_image
</code></pre>

<p>will be effectively be turned into:</p>

<pre><code>from program import data_manager
def subtract_moving_from_fixed(moving_image: torch.Tensor) -&gt; torch.Tensor:
    fixed_image = data_manager().get("fixed_image")
    return fixed_image - moving_image
</code></pre>
</div>


                </section>
                <section id="data_manager">
                            <input id="data_manager-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">data_manager</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="n"><a href="#StandaloneDADG">StandaloneDADG</a></span>:</span></span>

                <label class="view-source-button" for="data_manager-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#data_manager"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="data_manager-106"><a href="#data_manager-106"><span class="linenos">106</span></a><span class="k">def</span><span class="w"> </span><span class="nf">data_manager</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">StandaloneDADG</span><span class="p">:</span>
</span><span id="data_manager-107"><a href="#data_manager-107"><span class="linenos">107</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="data_manager-108"><a href="#data_manager-108"><span class="linenos">108</span></a><span class="sd">    If the data manager singleton has yet to be initialised, initialises it with no arguments.</span>
</span><span id="data_manager-109"><a href="#data_manager-109"><span class="linenos">109</span></a><span class="sd">    :return: The singleton `DAG` instance.</span>
</span><span id="data_manager-110"><a href="#data_manager-110"><span class="linenos">110</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="data_manager-111"><a href="#data_manager-111"><span class="linenos">111</span></a>    <span class="k">return</span> <span class="n">StandaloneDADGSingleton</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>If the data manager singleton has yet to be initialised, initialises it with no arguments.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The singleton <code>DAG</code> instance.</p>
</blockquote>
</div>


                </section>
                <section id="StandaloneDADGSingleton">
                            <input id="StandaloneDADGSingleton-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">StandaloneDADGSingleton</span><wbr>(<span class="base">traitlets.config.configurable.SingletonConfigurable</span>):

                <label class="view-source-button" for="StandaloneDADGSingleton-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StandaloneDADGSingleton"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StandaloneDADGSingleton-413"><a href="#StandaloneDADGSingleton-413"><span class="linenos">413</span></a><span class="k">class</span><span class="w"> </span><span class="nc">StandaloneDADGSingleton</span><span class="p">(</span><span class="n">SingletonConfigurable</span><span class="p">):</span>
</span><span id="StandaloneDADGSingleton-414"><a href="#StandaloneDADGSingleton-414"><span class="linenos">414</span></a>    <span class="n">_standalone_dadg</span><span class="p">:</span> <span class="n">StandaloneDADG</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">traitlets</span><span class="o">.</span><span class="n">Instance</span><span class="p">(</span><span class="n">StandaloneDADG</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="StandaloneDADGSingleton-415"><a href="#StandaloneDADGSingleton-415"><span class="linenos">415</span></a>
</span><span id="StandaloneDADGSingleton-416"><a href="#StandaloneDADGSingleton-416"><span class="linenos">416</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">init_kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StandaloneDADG</span><span class="p">:</span>
</span><span id="StandaloneDADGSingleton-417"><a href="#StandaloneDADGSingleton-417"><span class="linenos">417</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_standalone_dadg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADGSingleton-418"><a href="#StandaloneDADGSingleton-418"><span class="linenos">418</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_standalone_dadg</span> <span class="o">=</span> <span class="n">StandaloneDADG</span><span class="p">(</span><span class="o">**</span><span class="n">init_kwargs</span><span class="p">)</span>
</span><span id="StandaloneDADGSingleton-419"><a href="#StandaloneDADGSingleton-419"><span class="linenos">419</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data manager initialised with the following parameters: </span><span class="si">{</span><span class="n">init_kwargs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADGSingleton-420"><a href="#StandaloneDADGSingleton-420"><span class="linenos">420</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_standalone_dadg</span>
</span></pre></div>


            <div class="docstring"><p>A configurable that only allows one instance.</p>

<p>This class is for classes that should only have one instance of itself
or <em>any</em> subclass. To create and retrieve such a class use the
<code>SingletonConfigurable.instance()</code> method.</p>
</div>


                            <div id="StandaloneDADGSingleton.get" class="classattr">
                                        <input id="StandaloneDADGSingleton.get-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">**</span><span class="n">init_kwargs</span></span><span class="return-annotation">) -> <span class="n"><a href="#StandaloneDADG">StandaloneDADG</a></span>:</span></span>

                <label class="view-source-button" for="StandaloneDADGSingleton.get-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StandaloneDADGSingleton.get"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StandaloneDADGSingleton.get-416"><a href="#StandaloneDADGSingleton.get-416"><span class="linenos">416</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">init_kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StandaloneDADG</span><span class="p">:</span>
</span><span id="StandaloneDADGSingleton.get-417"><a href="#StandaloneDADGSingleton.get-417"><span class="linenos">417</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_standalone_dadg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADGSingleton.get-418"><a href="#StandaloneDADGSingleton.get-418"><span class="linenos">418</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_standalone_dadg</span> <span class="o">=</span> <span class="n">StandaloneDADG</span><span class="p">(</span><span class="o">**</span><span class="n">init_kwargs</span><span class="p">)</span>
</span><span id="StandaloneDADGSingleton.get-419"><a href="#StandaloneDADGSingleton.get-419"><span class="linenos">419</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data manager initialised with the following parameters: </span><span class="si">{</span><span class="n">init_kwargs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADGSingleton.get-420"><a href="#StandaloneDADGSingleton.get-420"><span class="linenos">420</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_standalone_dadg</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="Updater">
                            <input id="Updater-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Updater</span><wbr>(<span class="base">typing.NamedTuple</span>):

                <label class="view-source-button" for="Updater-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Updater"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Updater-21"><a href="#Updater-21"><span class="linenos">21</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Updater</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
</span><span id="Updater-22"><a href="#Updater-22"><span class="linenos">22</span></a>    <span class="n">function</span><span class="p">:</span> <span class="n">Callable</span>
</span><span id="Updater-23"><a href="#Updater-23"><span class="linenos">23</span></a>    <span class="n">returned</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="Updater-24"><a href="#Updater-24"><span class="linenos">24</span></a>    <span class="n">arguments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FunctionArgument</span><span class="p">]</span>
</span><span id="Updater-25"><a href="#Updater-25"><span class="linenos">25</span></a>    <span class="n">dependencies</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Dependency</span><span class="p">]</span>
</span><span id="Updater-26"><a href="#Updater-26"><span class="linenos">26</span></a>
</span><span id="Updater-27"><a href="#Updater-27"><span class="linenos">27</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Updater-28"><a href="#Updater-28"><span class="linenos">28</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">returned</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Updater&#39;</span><span class="p">:</span>
</span><span id="Updater-29"><a href="#Updater-29"><span class="linenos">29</span></a>        <span class="n">arguments</span> <span class="o">=</span> <span class="n">FunctionArgument</span><span class="o">.</span><span class="n">get_for_function</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
</span><span id="Updater-30"><a href="#Updater-30"><span class="linenos">30</span></a>        <span class="n">dependencies</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Dependency</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Updater-31"><a href="#Updater-31"><span class="linenos">31</span></a>        <span class="k">for</span> <span class="n">depended</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">:</span>
</span><span id="Updater-32"><a href="#Updater-32"><span class="linenos">32</span></a>            <span class="k">for</span> <span class="n">depender</span> <span class="ow">in</span> <span class="n">returned</span><span class="p">:</span>
</span><span id="Updater-33"><a href="#Updater-33"><span class="linenos">33</span></a>                <span class="n">dependencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Dependency</span><span class="p">(</span><span class="n">depender</span><span class="o">=</span><span class="n">depender</span><span class="p">,</span> <span class="n">depended</span><span class="o">=</span><span class="n">depended</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</span><span id="Updater-34"><a href="#Updater-34"><span class="linenos">34</span></a>        <span class="k">return</span> <span class="n">Updater</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="n">function</span><span class="p">,</span> <span class="n">returned</span><span class="o">=</span><span class="n">returned</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="n">arguments</span><span class="p">,</span> <span class="n">dependencies</span><span class="o">=</span><span class="n">dependencies</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Updater(function, returned, arguments, dependencies)</p>
</div>


                            <div id="Updater.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">Updater</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">function</span><span class="p">:</span> <span class="n">Callable</span>,</span><span class="param">	<span class="n">returned</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">arguments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="../utils/reflection.html#FunctionArgument">reg23_experiments.utils.reflection.FunctionArgument</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">dependencies</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">reg23_experiments</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">data_manager</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">Dependency</span><span class="p">]</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#Updater.__init__"></a>
    
            <div class="docstring"><p>Create new instance of Updater(function, returned, arguments, dependencies)</p>
</div>


                            </div>
                            <div id="Updater.function" class="classattr">
                                <div class="attr variable">
            <span class="name">function</span><span class="annotation">: Callable</span>

        
    </div>
    <a class="headerlink" href="#Updater.function"></a>
    
            <div class="docstring"><p>Alias for field number 0</p>
</div>


                            </div>
                            <div id="Updater.returned" class="classattr">
                                <div class="attr variable">
            <span class="name">returned</span><span class="annotation">: list[str]</span>

        
    </div>
    <a class="headerlink" href="#Updater.returned"></a>
    
            <div class="docstring"><p>Alias for field number 1</p>
</div>


                            </div>
                            <div id="Updater.arguments" class="classattr">
                                <div class="attr variable">
            <span class="name">arguments</span><span class="annotation">: list[<a href="../utils/reflection.html#FunctionArgument">reg23_experiments.utils.reflection.FunctionArgument</a>]</span>

        
    </div>
    <a class="headerlink" href="#Updater.arguments"></a>
    
            <div class="docstring"><p>Alias for field number 2</p>
</div>


                            </div>
                            <div id="Updater.dependencies" class="classattr">
                                <div class="attr variable">
            <span class="name">dependencies</span><span class="annotation">: list[reg23_experiments.ops.data_manager._data.Dependency]</span>

        
    </div>
    <a class="headerlink" href="#Updater.dependencies"></a>
    
            <div class="docstring"><p>Alias for field number 3</p>
</div>


                            </div>
                            <div id="Updater.build" class="classattr">
                                        <input id="Updater.build-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">build</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">function</span><span class="p">:</span> <span class="n">Callable</span>,</span><span class="param">	<span class="n">returned</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n"><a href="#Updater">Updater</a></span>:</span></span>

                <label class="view-source-button" for="Updater.build-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Updater.build"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Updater.build-27"><a href="#Updater.build-27"><span class="linenos">27</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Updater.build-28"><a href="#Updater.build-28"><span class="linenos">28</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">returned</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;Updater&#39;</span><span class="p">:</span>
</span><span id="Updater.build-29"><a href="#Updater.build-29"><span class="linenos">29</span></a>        <span class="n">arguments</span> <span class="o">=</span> <span class="n">FunctionArgument</span><span class="o">.</span><span class="n">get_for_function</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
</span><span id="Updater.build-30"><a href="#Updater.build-30"><span class="linenos">30</span></a>        <span class="n">dependencies</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Dependency</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Updater.build-31"><a href="#Updater.build-31"><span class="linenos">31</span></a>        <span class="k">for</span> <span class="n">depended</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">:</span>
</span><span id="Updater.build-32"><a href="#Updater.build-32"><span class="linenos">32</span></a>            <span class="k">for</span> <span class="n">depender</span> <span class="ow">in</span> <span class="n">returned</span><span class="p">:</span>
</span><span id="Updater.build-33"><a href="#Updater.build-33"><span class="linenos">33</span></a>                <span class="n">dependencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Dependency</span><span class="p">(</span><span class="n">depender</span><span class="o">=</span><span class="n">depender</span><span class="p">,</span> <span class="n">depended</span><span class="o">=</span><span class="n">depended</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</span><span id="Updater.build-34"><a href="#Updater.build-34"><span class="linenos">34</span></a>        <span class="k">return</span> <span class="n">Updater</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="n">function</span><span class="p">,</span> <span class="n">returned</span><span class="o">=</span><span class="n">returned</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="n">arguments</span><span class="p">,</span> <span class="n">dependencies</span><span class="o">=</span><span class="n">dependencies</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="DirectedAcyclicDataGraph">
                            <input id="DirectedAcyclicDataGraph-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DirectedAcyclicDataGraph</span><wbr>(<span class="base">abc.ABC</span>):

                <label class="view-source-button" for="DirectedAcyclicDataGraph-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DirectedAcyclicDataGraph"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DirectedAcyclicDataGraph-56"><a href="#DirectedAcyclicDataGraph-56"><span class="linenos"> 56</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DirectedAcyclicDataGraph</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="DirectedAcyclicDataGraph-57"><a href="#DirectedAcyclicDataGraph-57"><span class="linenos"> 57</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph-58"><a href="#DirectedAcyclicDataGraph-58"><span class="linenos"> 58</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph-59"><a href="#DirectedAcyclicDataGraph-59"><span class="linenos"> 59</span></a>        <span class="k">pass</span>
</span><span id="DirectedAcyclicDataGraph-60"><a href="#DirectedAcyclicDataGraph-60"><span class="linenos"> 60</span></a>
</span><span id="DirectedAcyclicDataGraph-61"><a href="#DirectedAcyclicDataGraph-61"><span class="linenos"> 61</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph-62"><a href="#DirectedAcyclicDataGraph-62"><span class="linenos"> 62</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">soft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph-63"><a href="#DirectedAcyclicDataGraph-63"><span class="linenos"> 63</span></a>        <span class="k">pass</span>
</span><span id="DirectedAcyclicDataGraph-64"><a href="#DirectedAcyclicDataGraph-64"><span class="linenos"> 64</span></a>
</span><span id="DirectedAcyclicDataGraph-65"><a href="#DirectedAcyclicDataGraph-65"><span class="linenos"> 65</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph-66"><a href="#DirectedAcyclicDataGraph-66"><span class="linenos"> 66</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">check_equality</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph-67"><a href="#DirectedAcyclicDataGraph-67"><span class="linenos"> 67</span></a>        <span class="k">pass</span>
</span><span id="DirectedAcyclicDataGraph-68"><a href="#DirectedAcyclicDataGraph-68"><span class="linenos"> 68</span></a>
</span><span id="DirectedAcyclicDataGraph-69"><a href="#DirectedAcyclicDataGraph-69"><span class="linenos"> 69</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph-70"><a href="#DirectedAcyclicDataGraph-70"><span class="linenos"> 70</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph-71"><a href="#DirectedAcyclicDataGraph-71"><span class="linenos"> 71</span></a>        <span class="k">pass</span>
</span><span id="DirectedAcyclicDataGraph-72"><a href="#DirectedAcyclicDataGraph-72"><span class="linenos"> 72</span></a>
</span><span id="DirectedAcyclicDataGraph-73"><a href="#DirectedAcyclicDataGraph-73"><span class="linenos"> 73</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph-74"><a href="#DirectedAcyclicDataGraph-74"><span class="linenos"> 74</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_evaluation_laziness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">lazily_evaluated</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph-75"><a href="#DirectedAcyclicDataGraph-75"><span class="linenos"> 75</span></a>        <span class="k">pass</span>
</span><span id="DirectedAcyclicDataGraph-76"><a href="#DirectedAcyclicDataGraph-76"><span class="linenos"> 76</span></a>
</span><span id="DirectedAcyclicDataGraph-77"><a href="#DirectedAcyclicDataGraph-77"><span class="linenos"> 77</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph-78"><a href="#DirectedAcyclicDataGraph-78"><span class="linenos"> 78</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">observe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph-79"><a href="#DirectedAcyclicDataGraph-79"><span class="linenos"> 79</span></a>        <span class="k">pass</span>
</span><span id="DirectedAcyclicDataGraph-80"><a href="#DirectedAcyclicDataGraph-80"><span class="linenos"> 80</span></a>
</span><span id="DirectedAcyclicDataGraph-81"><a href="#DirectedAcyclicDataGraph-81"><span class="linenos"> 81</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph-82"><a href="#DirectedAcyclicDataGraph-82"><span class="linenos"> 82</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_observer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph-83"><a href="#DirectedAcyclicDataGraph-83"><span class="linenos"> 83</span></a>        <span class="k">pass</span>
</span><span id="DirectedAcyclicDataGraph-84"><a href="#DirectedAcyclicDataGraph-84"><span class="linenos"> 84</span></a>
</span><span id="DirectedAcyclicDataGraph-85"><a href="#DirectedAcyclicDataGraph-85"><span class="linenos"> 85</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph-86"><a href="#DirectedAcyclicDataGraph-86"><span class="linenos"> 86</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_updater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">updater</span><span class="p">:</span> <span class="n">Updater</span><span class="p">):</span>
</span><span id="DirectedAcyclicDataGraph-87"><a href="#DirectedAcyclicDataGraph-87"><span class="linenos"> 87</span></a>        <span class="k">pass</span>
</span><span id="DirectedAcyclicDataGraph-88"><a href="#DirectedAcyclicDataGraph-88"><span class="linenos"> 88</span></a>
</span><span id="DirectedAcyclicDataGraph-89"><a href="#DirectedAcyclicDataGraph-89"><span class="linenos"> 89</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph-90"><a href="#DirectedAcyclicDataGraph-90"><span class="linenos"> 90</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_updater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph-91"><a href="#DirectedAcyclicDataGraph-91"><span class="linenos"> 91</span></a>        <span class="k">pass</span>
</span><span id="DirectedAcyclicDataGraph-92"><a href="#DirectedAcyclicDataGraph-92"><span class="linenos"> 92</span></a>
</span><span id="DirectedAcyclicDataGraph-93"><a href="#DirectedAcyclicDataGraph-93"><span class="linenos"> 93</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph-94"><a href="#DirectedAcyclicDataGraph-94"><span class="linenos"> 94</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_with_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FunctionArgument</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph-95"><a href="#DirectedAcyclicDataGraph-95"><span class="linenos"> 95</span></a>        <span class="k">pass</span>
</span><span id="DirectedAcyclicDataGraph-96"><a href="#DirectedAcyclicDataGraph-96"><span class="linenos"> 96</span></a>
</span><span id="DirectedAcyclicDataGraph-97"><a href="#DirectedAcyclicDataGraph-97"><span class="linenos"> 97</span></a>    <span class="c1">#### Protected properties and methods for access by ChildDADG</span>
</span><span id="DirectedAcyclicDataGraph-98"><a href="#DirectedAcyclicDataGraph-98"><span class="linenos"> 98</span></a>
</span><span id="DirectedAcyclicDataGraph-99"><a href="#DirectedAcyclicDataGraph-99"><span class="linenos"> 99</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph-100"><a href="#DirectedAcyclicDataGraph-100"><span class="linenos">100</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_node_if_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph-101"><a href="#DirectedAcyclicDataGraph-101"><span class="linenos">101</span></a>        <span class="k">pass</span>
</span><span id="DirectedAcyclicDataGraph-102"><a href="#DirectedAcyclicDataGraph-102"><span class="linenos">102</span></a>
</span><span id="DirectedAcyclicDataGraph-103"><a href="#DirectedAcyclicDataGraph-103"><span class="linenos">103</span></a>    <span class="nd">@property</span>
</span><span id="DirectedAcyclicDataGraph-104"><a href="#DirectedAcyclicDataGraph-104"><span class="linenos">104</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph-105"><a href="#DirectedAcyclicDataGraph-105"><span class="linenos">105</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Node</span><span class="p">]:</span>
</span><span id="DirectedAcyclicDataGraph-106"><a href="#DirectedAcyclicDataGraph-106"><span class="linenos">106</span></a>        <span class="k">pass</span>
</span><span id="DirectedAcyclicDataGraph-107"><a href="#DirectedAcyclicDataGraph-107"><span class="linenos">107</span></a>
</span><span id="DirectedAcyclicDataGraph-108"><a href="#DirectedAcyclicDataGraph-108"><span class="linenos">108</span></a>    <span class="nd">@property</span>
</span><span id="DirectedAcyclicDataGraph-109"><a href="#DirectedAcyclicDataGraph-109"><span class="linenos">109</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph-110"><a href="#DirectedAcyclicDataGraph-110"><span class="linenos">110</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_updaters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Updater</span><span class="p">]:</span>
</span><span id="DirectedAcyclicDataGraph-111"><a href="#DirectedAcyclicDataGraph-111"><span class="linenos">111</span></a>        <span class="k">pass</span>
</span><span id="DirectedAcyclicDataGraph-112"><a href="#DirectedAcyclicDataGraph-112"><span class="linenos">112</span></a>
</span><span id="DirectedAcyclicDataGraph-113"><a href="#DirectedAcyclicDataGraph-113"><span class="linenos">113</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_add_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="s1">&#39;ChildDirectedAcyclicDataGraph&#39;</span><span class="p">):</span>
</span><span id="DirectedAcyclicDataGraph-114"><a href="#DirectedAcyclicDataGraph-114"><span class="linenos">114</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p>
</div>


                            <div id="DirectedAcyclicDataGraph.has_node" class="classattr">
                                        <input id="DirectedAcyclicDataGraph.has_node-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">has_node</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="DirectedAcyclicDataGraph.has_node-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DirectedAcyclicDataGraph.has_node"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DirectedAcyclicDataGraph.has_node-57"><a href="#DirectedAcyclicDataGraph.has_node-57"><span class="linenos">57</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph.has_node-58"><a href="#DirectedAcyclicDataGraph.has_node-58"><span class="linenos">58</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph.has_node-59"><a href="#DirectedAcyclicDataGraph.has_node-59"><span class="linenos">59</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            </div>
                            <div id="DirectedAcyclicDataGraph.get" class="classattr">
                                        <input id="DirectedAcyclicDataGraph.get-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">get</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">soft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="DirectedAcyclicDataGraph.get-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DirectedAcyclicDataGraph.get"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DirectedAcyclicDataGraph.get-61"><a href="#DirectedAcyclicDataGraph.get-61"><span class="linenos">61</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph.get-62"><a href="#DirectedAcyclicDataGraph.get-62"><span class="linenos">62</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">soft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph.get-63"><a href="#DirectedAcyclicDataGraph.get-63"><span class="linenos">63</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            </div>
                            <div id="DirectedAcyclicDataGraph.set" class="classattr">
                                        <input id="DirectedAcyclicDataGraph.set-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">set</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">Any</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">check_equality</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="kc">None</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="DirectedAcyclicDataGraph.set-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DirectedAcyclicDataGraph.set"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DirectedAcyclicDataGraph.set-65"><a href="#DirectedAcyclicDataGraph.set-65"><span class="linenos">65</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph.set-66"><a href="#DirectedAcyclicDataGraph.set-66"><span class="linenos">66</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">check_equality</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph.set-67"><a href="#DirectedAcyclicDataGraph.set-67"><span class="linenos">67</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            </div>
                            <div id="DirectedAcyclicDataGraph.set_multiple" class="classattr">
                                        <input id="DirectedAcyclicDataGraph.set_multiple-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">set_multiple</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="kc">None</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="DirectedAcyclicDataGraph.set_multiple-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DirectedAcyclicDataGraph.set_multiple"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DirectedAcyclicDataGraph.set_multiple-69"><a href="#DirectedAcyclicDataGraph.set_multiple-69"><span class="linenos">69</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph.set_multiple-70"><a href="#DirectedAcyclicDataGraph.set_multiple-70"><span class="linenos">70</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph.set_multiple-71"><a href="#DirectedAcyclicDataGraph.set_multiple-71"><span class="linenos">71</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            </div>
                            <div id="DirectedAcyclicDataGraph.set_evaluation_laziness" class="classattr">
                                        <input id="DirectedAcyclicDataGraph.set_evaluation_laziness-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">set_evaluation_laziness</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">lazily_evaluated</span><span class="p">:</span> <span class="nb">bool</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DirectedAcyclicDataGraph.set_evaluation_laziness-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DirectedAcyclicDataGraph.set_evaluation_laziness"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DirectedAcyclicDataGraph.set_evaluation_laziness-73"><a href="#DirectedAcyclicDataGraph.set_evaluation_laziness-73"><span class="linenos">73</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph.set_evaluation_laziness-74"><a href="#DirectedAcyclicDataGraph.set_evaluation_laziness-74"><span class="linenos">74</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_evaluation_laziness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">lazily_evaluated</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph.set_evaluation_laziness-75"><a href="#DirectedAcyclicDataGraph.set_evaluation_laziness-75"><span class="linenos">75</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            </div>
                            <div id="DirectedAcyclicDataGraph.observe" class="classattr">
                                        <input id="DirectedAcyclicDataGraph.observe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">observe</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DirectedAcyclicDataGraph.observe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DirectedAcyclicDataGraph.observe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DirectedAcyclicDataGraph.observe-77"><a href="#DirectedAcyclicDataGraph.observe-77"><span class="linenos">77</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph.observe-78"><a href="#DirectedAcyclicDataGraph.observe-78"><span class="linenos">78</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">observe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph.observe-79"><a href="#DirectedAcyclicDataGraph.observe-79"><span class="linenos">79</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            </div>
                            <div id="DirectedAcyclicDataGraph.remove_observer" class="classattr">
                                        <input id="DirectedAcyclicDataGraph.remove_observer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">remove_observer</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="DirectedAcyclicDataGraph.remove_observer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DirectedAcyclicDataGraph.remove_observer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DirectedAcyclicDataGraph.remove_observer-81"><a href="#DirectedAcyclicDataGraph.remove_observer-81"><span class="linenos">81</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph.remove_observer-82"><a href="#DirectedAcyclicDataGraph.remove_observer-82"><span class="linenos">82</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_observer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph.remove_observer-83"><a href="#DirectedAcyclicDataGraph.remove_observer-83"><span class="linenos">83</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            </div>
                            <div id="DirectedAcyclicDataGraph.add_updater" class="classattr">
                                        <input id="DirectedAcyclicDataGraph.add_updater-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">add_updater</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">updater</span><span class="p">:</span> <span class="n"><a href="#Updater">Updater</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DirectedAcyclicDataGraph.add_updater-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DirectedAcyclicDataGraph.add_updater"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DirectedAcyclicDataGraph.add_updater-85"><a href="#DirectedAcyclicDataGraph.add_updater-85"><span class="linenos">85</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph.add_updater-86"><a href="#DirectedAcyclicDataGraph.add_updater-86"><span class="linenos">86</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_updater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">updater</span><span class="p">:</span> <span class="n">Updater</span><span class="p">):</span>
</span><span id="DirectedAcyclicDataGraph.add_updater-87"><a href="#DirectedAcyclicDataGraph.add_updater-87"><span class="linenos">87</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            </div>
                            <div id="DirectedAcyclicDataGraph.remove_updater" class="classattr">
                                        <input id="DirectedAcyclicDataGraph.remove_updater-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">remove_updater</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="DirectedAcyclicDataGraph.remove_updater-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DirectedAcyclicDataGraph.remove_updater"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DirectedAcyclicDataGraph.remove_updater-89"><a href="#DirectedAcyclicDataGraph.remove_updater-89"><span class="linenos">89</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph.remove_updater-90"><a href="#DirectedAcyclicDataGraph.remove_updater-90"><span class="linenos">90</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_updater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph.remove_updater-91"><a href="#DirectedAcyclicDataGraph.remove_updater-91"><span class="linenos">91</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            </div>
                            <div id="DirectedAcyclicDataGraph.get_with_args" class="classattr">
                                        <input id="DirectedAcyclicDataGraph.get_with_args-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">get_with_args</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="../utils/reflection.html#FunctionArgument">reg23_experiments.utils.reflection.FunctionArgument</a></span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="DirectedAcyclicDataGraph.get_with_args-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DirectedAcyclicDataGraph.get_with_args"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DirectedAcyclicDataGraph.get_with_args-93"><a href="#DirectedAcyclicDataGraph.get_with_args-93"><span class="linenos">93</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="DirectedAcyclicDataGraph.get_with_args-94"><a href="#DirectedAcyclicDataGraph.get_with_args-94"><span class="linenos">94</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_with_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FunctionArgument</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="DirectedAcyclicDataGraph.get_with_args-95"><a href="#DirectedAcyclicDataGraph.get_with_args-95"><span class="linenos">95</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="ChildDirectedAcyclicDataGraph">
                            <input id="ChildDirectedAcyclicDataGraph-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ChildDirectedAcyclicDataGraph</span><wbr>(<span class="base"><a href="#DirectedAcyclicDataGraph">reg23_experiments.ops.data_manager.DirectedAcyclicDataGraph</a></span>):

                <label class="view-source-button" for="ChildDirectedAcyclicDataGraph-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChildDirectedAcyclicDataGraph"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChildDirectedAcyclicDataGraph-117"><a href="#ChildDirectedAcyclicDataGraph-117"><span class="linenos">117</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ChildDirectedAcyclicDataGraph</span><span class="p">(</span><span class="n">DirectedAcyclicDataGraph</span><span class="p">):</span>
</span><span id="ChildDirectedAcyclicDataGraph-118"><a href="#ChildDirectedAcyclicDataGraph-118"><span class="linenos">118</span></a>    <span class="c1">#### Protected properties and methods for access by parent DADG</span>
</span><span id="ChildDirectedAcyclicDataGraph-119"><a href="#ChildDirectedAcyclicDataGraph-119"><span class="linenos">119</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="ChildDirectedAcyclicDataGraph-120"><a href="#ChildDirectedAcyclicDataGraph-120"><span class="linenos">120</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_make_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDirectedAcyclicDataGraph-121"><a href="#ChildDirectedAcyclicDataGraph-121"><span class="linenos">121</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p>
</div>


                </section>
                <section id="StandaloneDADG">
                            <input id="StandaloneDADG-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">StandaloneDADG</span><wbr>(<span class="base"><a href="#DirectedAcyclicDataGraph">reg23_experiments.ops.data_manager.DirectedAcyclicDataGraph</a></span>):

                <label class="view-source-button" for="StandaloneDADG-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StandaloneDADG"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StandaloneDADG-21"><a href="#StandaloneDADG-21"><span class="linenos"> 21</span></a><span class="k">class</span><span class="w"> </span><span class="nc">StandaloneDADG</span><span class="p">(</span><span class="n">DirectedAcyclicDataGraph</span><span class="p">):</span>
</span><span id="StandaloneDADG-22"><a href="#StandaloneDADG-22"><span class="linenos"> 22</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-23"><a href="#StandaloneDADG-23"><span class="linenos"> 23</span></a><span class="sd">    A data manager that stores data in a directed, acyclic graph.</span>
</span><span id="StandaloneDADG-24"><a href="#StandaloneDADG-24"><span class="linenos"> 24</span></a>
</span><span id="StandaloneDADG-25"><a href="#StandaloneDADG-25"><span class="linenos"> 25</span></a><span class="sd">    Each variable (piece of data) has a `str` name and is stored as a node in the graph.</span>
</span><span id="StandaloneDADG-26"><a href="#StandaloneDADG-26"><span class="linenos"> 26</span></a>
</span><span id="StandaloneDADG-27"><a href="#StandaloneDADG-27"><span class="linenos"> 27</span></a><span class="sd">    The value of a variable can be set using `data_manager().set_data(&lt;variable name&gt;, &lt;value&gt;)`. Multiple can be set</span>
</span><span id="StandaloneDADG-28"><a href="#StandaloneDADG-28"><span class="linenos"> 28</span></a><span class="sd">    at once using `data_manager().set_data_multiple(&lt;variable name&gt;=&lt;value&gt;, &lt;variable name&gt;=&lt;value&gt;, ...)`.</span>
</span><span id="StandaloneDADG-29"><a href="#StandaloneDADG-29"><span class="linenos"> 29</span></a>
</span><span id="StandaloneDADG-30"><a href="#StandaloneDADG-30"><span class="linenos"> 30</span></a><span class="sd">    Dependencies between variables are added using instance of the `Updater` class, and the function</span>
</span><span id="StandaloneDADG-31"><a href="#StandaloneDADG-31"><span class="linenos"> 31</span></a><span class="sd">    `data_manager().add_updater(&lt;updater name&gt;, &lt;updater instance&gt;)`. The `&lt;updater name&gt;` is just a user-defined `str`</span>
</span><span id="StandaloneDADG-32"><a href="#StandaloneDADG-32"><span class="linenos"> 32</span></a><span class="sd">    name associated with the updater instance, which is used if the user wishes to remove the updater later on with</span>
</span><span id="StandaloneDADG-33"><a href="#StandaloneDADG-33"><span class="linenos"> 33</span></a><span class="sd">    `data_manager().remove_updater(&lt;updater name&gt;)`.</span>
</span><span id="StandaloneDADG-34"><a href="#StandaloneDADG-34"><span class="linenos"> 34</span></a>
</span><span id="StandaloneDADG-35"><a href="#StandaloneDADG-35"><span class="linenos"> 35</span></a><span class="sd">    Each updater defines a dependency of a set of variables on a set of other variables, as well as the mapping between</span>
</span><span id="StandaloneDADG-36"><a href="#StandaloneDADG-36"><span class="linenos"> 36</span></a><span class="sd">    them.</span>
</span><span id="StandaloneDADG-37"><a href="#StandaloneDADG-37"><span class="linenos"> 37</span></a>
</span><span id="StandaloneDADG-38"><a href="#StandaloneDADG-38"><span class="linenos"> 38</span></a><span class="sd">    Each variable (node) may be updated by:</span>
</span><span id="StandaloneDADG-39"><a href="#StandaloneDADG-39"><span class="linenos"> 39</span></a><span class="sd">    - no updaters, so its value is always valid, and is only ever changed using `data_manager().set_data` /</span>
</span><span id="StandaloneDADG-40"><a href="#StandaloneDADG-40"><span class="linenos"> 40</span></a><span class="sd">    `data_manager().set_data_multiple`, or</span>
</span><span id="StandaloneDADG-41"><a href="#StandaloneDADG-41"><span class="linenos"> 41</span></a><span class="sd">    - one updater, so its value is invalidated by changes to its dependents, and will be re-evaluated automatically by</span>
</span><span id="StandaloneDADG-42"><a href="#StandaloneDADG-42"><span class="linenos"> 42</span></a><span class="sd">    its updater when read.</span>
</span><span id="StandaloneDADG-43"><a href="#StandaloneDADG-43"><span class="linenos"> 43</span></a>
</span><span id="StandaloneDADG-44"><a href="#StandaloneDADG-44"><span class="linenos"> 44</span></a><span class="sd">    By default, all variables are evaluated lazily, i.e. updaters will only be run to re-evaluate invalidated values</span>
</span><span id="StandaloneDADG-45"><a href="#StandaloneDADG-45"><span class="linenos"> 45</span></a><span class="sd">    upon reading of the dependent variables. While this is good for optimisation, when data are displayed in a GUI, this</span>
</span><span id="StandaloneDADG-46"><a href="#StandaloneDADG-46"><span class="linenos"> 46</span></a><span class="sd">    is generally not desirable, as the user will generally wish to only be shown valid data. In this case, variables</span>
</span><span id="StandaloneDADG-47"><a href="#StandaloneDADG-47"><span class="linenos"> 47</span></a><span class="sd">    can manually be set to non-lazy have evaluation using</span>
</span><span id="StandaloneDADG-48"><a href="#StandaloneDADG-48"><span class="linenos"> 48</span></a><span class="sd">    `data_manager().set_evaluation_laziness(&lt;variable name&gt;, lazily_evaluated=False)`.</span>
</span><span id="StandaloneDADG-49"><a href="#StandaloneDADG-49"><span class="linenos"> 49</span></a>
</span><span id="StandaloneDADG-50"><a href="#StandaloneDADG-50"><span class="linenos"> 50</span></a><span class="sd">    It is sometimes useful to know when a variable&#39;s value changes, e.g. for updating GUI elements. Callbacks can be</span>
</span><span id="StandaloneDADG-51"><a href="#StandaloneDADG-51"><span class="linenos"> 51</span></a><span class="sd">    added using `data_manager().add_callback(&lt;variable name&gt;, &lt;callback name&gt;, &lt;callback value&gt;)`. The `&lt;callback name&gt;`</span>
</span><span id="StandaloneDADG-52"><a href="#StandaloneDADG-52"><span class="linenos"> 52</span></a><span class="sd">    is just a user-defined `str` name associated with the callback, which is used if the user wishes to remove the</span>
</span><span id="StandaloneDADG-53"><a href="#StandaloneDADG-53"><span class="linenos"> 53</span></a><span class="sd">    callback later on with `data_manager().remove_callback(&lt;variable name&gt;, &lt;callback name&gt;)`.</span>
</span><span id="StandaloneDADG-54"><a href="#StandaloneDADG-54"><span class="linenos"> 54</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-55"><a href="#StandaloneDADG-55"><span class="linenos"> 55</span></a>
</span><span id="StandaloneDADG-56"><a href="#StandaloneDADG-56"><span class="linenos"> 56</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="StandaloneDADG-57"><a href="#StandaloneDADG-57"><span class="linenos"> 57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Node</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StandaloneDADG-58"><a href="#StandaloneDADG-58"><span class="linenos"> 58</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Updater</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="StandaloneDADG-59"><a href="#StandaloneDADG-59"><span class="linenos"> 59</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__in_top_level_call</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="StandaloneDADG-60"><a href="#StandaloneDADG-60"><span class="linenos"> 60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__children</span><span class="p">:</span> <span class="n">weakref</span><span class="o">.</span><span class="n">WeakSet</span><span class="p">[</span>
</span><span id="StandaloneDADG-61"><a href="#StandaloneDADG-61"><span class="linenos"> 61</span></a>            <span class="n">ChildDirectedAcyclicDataGraph</span><span class="p">]</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">WeakSet</span><span class="p">()</span>  <span class="c1"># children add themselves, and will be automatically</span>
</span><span id="StandaloneDADG-62"><a href="#StandaloneDADG-62"><span class="linenos"> 62</span></a>        <span class="c1"># removed on destruction</span>
</span><span id="StandaloneDADG-63"><a href="#StandaloneDADG-63"><span class="linenos"> 63</span></a>
</span><span id="StandaloneDADG-64"><a href="#StandaloneDADG-64"><span class="linenos"> 64</span></a>    <span class="nd">@staticmethod</span>
</span><span id="StandaloneDADG-65"><a href="#StandaloneDADG-65"><span class="linenos"> 65</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__data_mutating</span><span class="p">(</span><span class="n">function</span><span class="p">):</span>
</span><span id="StandaloneDADG-66"><a href="#StandaloneDADG-66"><span class="linenos"> 66</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-67"><a href="#StandaloneDADG-67"><span class="linenos"> 67</span></a><span class="sd">        A private decorator for marking methods as having the potential to make data dirty, such that</span>
</span><span id="StandaloneDADG-68"><a href="#StandaloneDADG-68"><span class="linenos"> 68</span></a><span class="sd">        non-lazily-evaluated nodes can be cleaned automatically. This tracks whether it is in the top-level call to</span>
</span><span id="StandaloneDADG-69"><a href="#StandaloneDADG-69"><span class="linenos"> 69</span></a><span class="sd">        avoid repeated evaluation of the same node, which would waste computation.</span>
</span><span id="StandaloneDADG-70"><a href="#StandaloneDADG-70"><span class="linenos"> 70</span></a><span class="sd">        :param function:</span>
</span><span id="StandaloneDADG-71"><a href="#StandaloneDADG-71"><span class="linenos"> 71</span></a><span class="sd">        :return:</span>
</span><span id="StandaloneDADG-72"><a href="#StandaloneDADG-72"><span class="linenos"> 72</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-73"><a href="#StandaloneDADG-73"><span class="linenos"> 73</span></a>
</span><span id="StandaloneDADG-74"><a href="#StandaloneDADG-74"><span class="linenos"> 74</span></a>        <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
</span><span id="StandaloneDADG-75"><a href="#StandaloneDADG-75"><span class="linenos"> 75</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="StandaloneDADG-76"><a href="#StandaloneDADG-76"><span class="linenos"> 76</span></a>            <span class="n">this_is_top_level_call</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__in_top_level_call</span>
</span><span id="StandaloneDADG-77"><a href="#StandaloneDADG-77"><span class="linenos"> 77</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__in_top_level_call</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="StandaloneDADG-78"><a href="#StandaloneDADG-78"><span class="linenos"> 78</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="StandaloneDADG-79"><a href="#StandaloneDADG-79"><span class="linenos"> 79</span></a>            <span class="k">if</span> <span class="n">this_is_top_level_call</span><span class="p">:</span>
</span><span id="StandaloneDADG-80"><a href="#StandaloneDADG-80"><span class="linenos"> 80</span></a>                <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__clean_graph</span><span class="p">()</span>
</span><span id="StandaloneDADG-81"><a href="#StandaloneDADG-81"><span class="linenos"> 81</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="StandaloneDADG-82"><a href="#StandaloneDADG-82"><span class="linenos"> 82</span></a>                    <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error cleaning graph after call to data mutating function: </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-83"><a href="#StandaloneDADG-83"><span class="linenos"> 83</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__in_top_level_call</span> <span class="o">=</span> <span class="n">this_is_top_level_call</span>
</span><span id="StandaloneDADG-84"><a href="#StandaloneDADG-84"><span class="linenos"> 84</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="StandaloneDADG-85"><a href="#StandaloneDADG-85"><span class="linenos"> 85</span></a>
</span><span id="StandaloneDADG-86"><a href="#StandaloneDADG-86"><span class="linenos"> 86</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="StandaloneDADG-87"><a href="#StandaloneDADG-87"><span class="linenos"> 87</span></a>
</span><span id="StandaloneDADG-88"><a href="#StandaloneDADG-88"><span class="linenos"> 88</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="StandaloneDADG-89"><a href="#StandaloneDADG-89"><span class="linenos"> 89</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="s2">&quot;StandaloneDADG(</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="StandaloneDADG-90"><a href="#StandaloneDADG-90"><span class="linenos"> 90</span></a>        <span class="n">ret</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Nodes:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="StandaloneDADG-91"><a href="#StandaloneDADG-91"><span class="linenos"> 91</span></a>        <span class="k">for</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StandaloneDADG-92"><a href="#StandaloneDADG-92"><span class="linenos"> 92</span></a>            <span class="n">ret</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="StandaloneDADG-93"><a href="#StandaloneDADG-93"><span class="linenos"> 93</span></a>        <span class="n">ret</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Updaters:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="StandaloneDADG-94"><a href="#StandaloneDADG-94"><span class="linenos"> 94</span></a>        <span class="k">for</span> <span class="n">updater_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StandaloneDADG-95"><a href="#StandaloneDADG-95"><span class="linenos"> 95</span></a>            <span class="n">ret</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="StandaloneDADG-96"><a href="#StandaloneDADG-96"><span class="linenos"> 96</span></a>        <span class="n">ret</span> <span class="o">+=</span> <span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="StandaloneDADG-97"><a href="#StandaloneDADG-97"><span class="linenos"> 97</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span><span id="StandaloneDADG-98"><a href="#StandaloneDADG-98"><span class="linenos"> 98</span></a>
</span><span id="StandaloneDADG-99"><a href="#StandaloneDADG-99"><span class="linenos"> 99</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StandaloneDADG-100"><a href="#StandaloneDADG-100"><span class="linenos">100</span></a>        <span class="k">return</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span>
</span><span id="StandaloneDADG-101"><a href="#StandaloneDADG-101"><span class="linenos">101</span></a>
</span><span id="StandaloneDADG-102"><a href="#StandaloneDADG-102"><span class="linenos">102</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="StandaloneDADG-103"><a href="#StandaloneDADG-103"><span class="linenos">103</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">soft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG-104"><a href="#StandaloneDADG-104"><span class="linenos">104</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-105"><a href="#StandaloneDADG-105"><span class="linenos">105</span></a><span class="sd">        Get the data associated with the named node. Will lazily re-calculate the value if previously made dirty by</span>
</span><span id="StandaloneDADG-106"><a href="#StandaloneDADG-106"><span class="linenos">106</span></a><span class="sd">        changes to other values.</span>
</span><span id="StandaloneDADG-107"><a href="#StandaloneDADG-107"><span class="linenos">107</span></a><span class="sd">        :param node_name: The name of the node.</span>
</span><span id="StandaloneDADG-108"><a href="#StandaloneDADG-108"><span class="linenos">108</span></a><span class="sd">        :param soft: [Optional; default=False] Whether to return an Error if there is not enough data to clean the node.</span>
</span><span id="StandaloneDADG-109"><a href="#StandaloneDADG-109"><span class="linenos">109</span></a><span class="sd">        :return: The data associated with the name node, or an instance of `Error` on failure.</span>
</span><span id="StandaloneDADG-110"><a href="#StandaloneDADG-110"><span class="linenos">110</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-111"><a href="#StandaloneDADG-111"><span class="linenos">111</span></a>        <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__clean_node</span><span class="p">(</span><span class="n">node_name</span><span class="p">,</span> <span class="n">soft</span><span class="o">=</span><span class="n">soft</span><span class="p">)</span>
</span><span id="StandaloneDADG-112"><a href="#StandaloneDADG-112"><span class="linenos">112</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="StandaloneDADG-113"><a href="#StandaloneDADG-113"><span class="linenos">113</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error cleaning node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; before &#39;get&#39;: </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-114"><a href="#StandaloneDADG-114"><span class="linenos">114</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="n">NoNodeData</span><span class="p">:</span>
</span><span id="StandaloneDADG-115"><a href="#StandaloneDADG-115"><span class="linenos">115</span></a>            <span class="k">if</span> <span class="n">soft</span><span class="p">:</span>
</span><span id="StandaloneDADG-116"><a href="#StandaloneDADG-116"><span class="linenos">116</span></a>                <span class="k">return</span> <span class="n">NoNodeData</span>
</span><span id="StandaloneDADG-117"><a href="#StandaloneDADG-117"><span class="linenos">117</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No data stored for node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; in graph.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-118"><a href="#StandaloneDADG-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</span><span id="StandaloneDADG-119"><a href="#StandaloneDADG-119"><span class="linenos">119</span></a>
</span><span id="StandaloneDADG-120"><a href="#StandaloneDADG-120"><span class="linenos">120</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="StandaloneDADG-121"><a href="#StandaloneDADG-121"><span class="linenos">121</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">check_equality</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG-122"><a href="#StandaloneDADG-122"><span class="linenos">122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-123"><a href="#StandaloneDADG-123"><span class="linenos">123</span></a><span class="sd">        Set the data associated with a named node. Will create the node if it doesn&#39;t exist.</span>
</span><span id="StandaloneDADG-124"><a href="#StandaloneDADG-124"><span class="linenos">124</span></a><span class="sd">        :param node_name: Name of the node.</span>
</span><span id="StandaloneDADG-125"><a href="#StandaloneDADG-125"><span class="linenos">125</span></a><span class="sd">        :param data: New data to assign.</span>
</span><span id="StandaloneDADG-126"><a href="#StandaloneDADG-126"><span class="linenos">126</span></a><span class="sd">        :param check_equality: [Optional; default=False] Whether to check the new value against the old value,</span>
</span><span id="StandaloneDADG-127"><a href="#StandaloneDADG-127"><span class="linenos">127</span></a><span class="sd">        and leave the node clean if the new value is the same.</span>
</span><span id="StandaloneDADG-128"><a href="#StandaloneDADG-128"><span class="linenos">128</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-129"><a href="#StandaloneDADG-129"><span class="linenos">129</span></a>        <span class="c1"># make sure node exists</span>
</span><span id="StandaloneDADG-130"><a href="#StandaloneDADG-130"><span class="linenos">130</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG-131"><a href="#StandaloneDADG-131"><span class="linenos">131</span></a>        <span class="c1"># set the data and make not dirty</span>
</span><span id="StandaloneDADG-132"><a href="#StandaloneDADG-132"><span class="linenos">132</span></a>        <span class="k">if</span> <span class="n">check_equality</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="n">data</span><span class="p">:</span>
</span><span id="StandaloneDADG-133"><a href="#StandaloneDADG-133"><span class="linenos">133</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="StandaloneDADG-134"><a href="#StandaloneDADG-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG-135"><a href="#StandaloneDADG-135"><span class="linenos">135</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="StandaloneDADG-136"><a href="#StandaloneDADG-136"><span class="linenos">136</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">dirty</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="StandaloneDADG-137"><a href="#StandaloneDADG-137"><span class="linenos">137</span></a>        <span class="c1"># call the node&#39;s set callbacks</span>
</span><span id="StandaloneDADG-138"><a href="#StandaloneDADG-138"><span class="linenos">138</span></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">observers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StandaloneDADG-139"><a href="#StandaloneDADG-139"><span class="linenos">139</span></a>            <span class="n">err</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StandaloneDADG-140"><a href="#StandaloneDADG-140"><span class="linenos">140</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="StandaloneDADG-141"><a href="#StandaloneDADG-141"><span class="linenos">141</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Observer callback returned error: </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-142"><a href="#StandaloneDADG-142"><span class="linenos">142</span></a>        <span class="c1"># make all dependents dirty</span>
</span><span id="StandaloneDADG-143"><a href="#StandaloneDADG-143"><span class="linenos">143</span></a>        <span class="k">for</span> <span class="n">dependent</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">dependents</span><span class="p">:</span>
</span><span id="StandaloneDADG-144"><a href="#StandaloneDADG-144"><span class="linenos">144</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__set_dirty</span><span class="p">(</span><span class="n">dependent</span><span class="p">)</span>
</span><span id="StandaloneDADG-145"><a href="#StandaloneDADG-145"><span class="linenos">145</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="StandaloneDADG-146"><a href="#StandaloneDADG-146"><span class="linenos">146</span></a>
</span><span id="StandaloneDADG-147"><a href="#StandaloneDADG-147"><span class="linenos">147</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="StandaloneDADG-148"><a href="#StandaloneDADG-148"><span class="linenos">148</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG-149"><a href="#StandaloneDADG-149"><span class="linenos">149</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-150"><a href="#StandaloneDADG-150"><span class="linenos">150</span></a><span class="sd">        Set the data associated with multiple named nodes. Will create the node if it doesn&#39;t exist.</span>
</span><span id="StandaloneDADG-151"><a href="#StandaloneDADG-151"><span class="linenos">151</span></a><span class="sd">        Each keyword argument `name=value` will set the data `value` for the node `name`.</span>
</span><span id="StandaloneDADG-152"><a href="#StandaloneDADG-152"><span class="linenos">152</span></a><span class="sd">        :return: Nothing on success; an `Error` on failure.</span>
</span><span id="StandaloneDADG-153"><a href="#StandaloneDADG-153"><span class="linenos">153</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-154"><a href="#StandaloneDADG-154"><span class="linenos">154</span></a>        <span class="k">for</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StandaloneDADG-155"><a href="#StandaloneDADG-155"><span class="linenos">155</span></a>            <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">node_name</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="StandaloneDADG-156"><a href="#StandaloneDADG-156"><span class="linenos">156</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="StandaloneDADG-157"><a href="#StandaloneDADG-157"><span class="linenos">157</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error setting multiple data; specifically for &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-158"><a href="#StandaloneDADG-158"><span class="linenos">158</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="StandaloneDADG-159"><a href="#StandaloneDADG-159"><span class="linenos">159</span></a>
</span><span id="StandaloneDADG-160"><a href="#StandaloneDADG-160"><span class="linenos">160</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="StandaloneDADG-161"><a href="#StandaloneDADG-161"><span class="linenos">161</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_evaluation_laziness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">lazily_evaluated</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG-162"><a href="#StandaloneDADG-162"><span class="linenos">162</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-163"><a href="#StandaloneDADG-163"><span class="linenos">163</span></a><span class="sd">        Set whether the named node will be evaluated lazily. Nodes will be evaluated lazily by default. A node that is</span>
</span><span id="StandaloneDADG-164"><a href="#StandaloneDADG-164"><span class="linenos">164</span></a><span class="sd">        not evaluated lazily will be re-evaluated if dirty and the required data exists, every time data in the graph</span>
</span><span id="StandaloneDADG-165"><a href="#StandaloneDADG-165"><span class="linenos">165</span></a><span class="sd">        changes.</span>
</span><span id="StandaloneDADG-166"><a href="#StandaloneDADG-166"><span class="linenos">166</span></a><span class="sd">        :param node_name: The name of the node to modify</span>
</span><span id="StandaloneDADG-167"><a href="#StandaloneDADG-167"><span class="linenos">167</span></a><span class="sd">        :param lazily_evaluated: Whether the named node should be evaluated lazily</span>
</span><span id="StandaloneDADG-168"><a href="#StandaloneDADG-168"><span class="linenos">168</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-169"><a href="#StandaloneDADG-169"><span class="linenos">169</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG-170"><a href="#StandaloneDADG-170"><span class="linenos">170</span></a>        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG-171"><a href="#StandaloneDADG-171"><span class="linenos">171</span></a>            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">lazily_evaluated</span> <span class="o">==</span> <span class="n">lazily_evaluated</span><span class="p">:</span>
</span><span id="StandaloneDADG-172"><a href="#StandaloneDADG-172"><span class="linenos">172</span></a>                <span class="k">return</span>
</span><span id="StandaloneDADG-173"><a href="#StandaloneDADG-173"><span class="linenos">173</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG-174"><a href="#StandaloneDADG-174"><span class="linenos">174</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG-175"><a href="#StandaloneDADG-175"><span class="linenos">175</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">lazily_evaluated</span> <span class="o">=</span> <span class="n">lazily_evaluated</span>
</span><span id="StandaloneDADG-176"><a href="#StandaloneDADG-176"><span class="linenos">176</span></a>
</span><span id="StandaloneDADG-177"><a href="#StandaloneDADG-177"><span class="linenos">177</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">observe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG-178"><a href="#StandaloneDADG-178"><span class="linenos">178</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-179"><a href="#StandaloneDADG-179"><span class="linenos">179</span></a><span class="sd">        Add a callback function to a node that will be called whenever the node&#39;s data changes.</span>
</span><span id="StandaloneDADG-180"><a href="#StandaloneDADG-180"><span class="linenos">180</span></a><span class="sd">        :param node_name:</span>
</span><span id="StandaloneDADG-181"><a href="#StandaloneDADG-181"><span class="linenos">181</span></a><span class="sd">        :param observer_name:</span>
</span><span id="StandaloneDADG-182"><a href="#StandaloneDADG-182"><span class="linenos">182</span></a><span class="sd">        :param callback:</span>
</span><span id="StandaloneDADG-183"><a href="#StandaloneDADG-183"><span class="linenos">183</span></a><span class="sd">        :return:</span>
</span><span id="StandaloneDADG-184"><a href="#StandaloneDADG-184"><span class="linenos">184</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-185"><a href="#StandaloneDADG-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span><span class="o">.</span><span class="n">observers</span><span class="p">[</span><span class="n">observer_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
</span><span id="StandaloneDADG-186"><a href="#StandaloneDADG-186"><span class="linenos">186</span></a>
</span><span id="StandaloneDADG-187"><a href="#StandaloneDADG-187"><span class="linenos">187</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_observer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG-188"><a href="#StandaloneDADG-188"><span class="linenos">188</span></a>        <span class="n">node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG-189"><a href="#StandaloneDADG-189"><span class="linenos">189</span></a>        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG-190"><a href="#StandaloneDADG-190"><span class="linenos">190</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No node named &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; from which to remove callback.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-191"><a href="#StandaloneDADG-191"><span class="linenos">191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG-192"><a href="#StandaloneDADG-192"><span class="linenos">192</span></a>        <span class="k">if</span> <span class="n">observer_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">observers</span><span class="p">:</span>
</span><span id="StandaloneDADG-193"><a href="#StandaloneDADG-193"><span class="linenos">193</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No observer named &#39;</span><span class="si">{</span><span class="n">observer_name</span><span class="si">}</span><span class="s2">&#39; in node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-194"><a href="#StandaloneDADG-194"><span class="linenos">194</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">observers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">observer_name</span><span class="p">)</span>
</span><span id="StandaloneDADG-195"><a href="#StandaloneDADG-195"><span class="linenos">195</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="StandaloneDADG-196"><a href="#StandaloneDADG-196"><span class="linenos">196</span></a>
</span><span id="StandaloneDADG-197"><a href="#StandaloneDADG-197"><span class="linenos">197</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="StandaloneDADG-198"><a href="#StandaloneDADG-198"><span class="linenos">198</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_updater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">updater</span><span class="p">:</span> <span class="n">Updater</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG-199"><a href="#StandaloneDADG-199"><span class="linenos">199</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-200"><a href="#StandaloneDADG-200"><span class="linenos">200</span></a><span class="sd">        Add a new updater object to the DAG. Each node may only be updated by a single updater, or no updater.</span>
</span><span id="StandaloneDADG-201"><a href="#StandaloneDADG-201"><span class="linenos">201</span></a><span class="sd">        :param updater_name: A human-readable name to assign to the added updater.</span>
</span><span id="StandaloneDADG-202"><a href="#StandaloneDADG-202"><span class="linenos">202</span></a><span class="sd">        :param updater: The updater object. Can be created from a function using the `dag_updater` decorator.</span>
</span><span id="StandaloneDADG-203"><a href="#StandaloneDADG-203"><span class="linenos">203</span></a><span class="sd">        :return: None, or an `Error` object on failure.</span>
</span><span id="StandaloneDADG-204"><a href="#StandaloneDADG-204"><span class="linenos">204</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-205"><a href="#StandaloneDADG-205"><span class="linenos">205</span></a>        <span class="c1"># insert the new updater, checking that there isn&#39;t already one of the same name</span>
</span><span id="StandaloneDADG-206"><a href="#StandaloneDADG-206"><span class="linenos">206</span></a>        <span class="k">if</span> <span class="n">updater_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">:</span>
</span><span id="StandaloneDADG-207"><a href="#StandaloneDADG-207"><span class="linenos">207</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updater named &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39; already exists in graph.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-208"><a href="#StandaloneDADG-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">[</span><span class="n">updater_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">updater</span>
</span><span id="StandaloneDADG-209"><a href="#StandaloneDADG-209"><span class="linenos">209</span></a>        <span class="c1"># set the updater names for updated nodes</span>
</span><span id="StandaloneDADG-210"><a href="#StandaloneDADG-210"><span class="linenos">210</span></a>        <span class="k">for</span> <span class="n">updated</span> <span class="ow">in</span> <span class="n">updater</span><span class="o">.</span><span class="n">returned</span><span class="p">:</span>
</span><span id="StandaloneDADG-211"><a href="#StandaloneDADG-211"><span class="linenos">211</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">updated</span><span class="p">)</span>
</span><span id="StandaloneDADG-212"><a href="#StandaloneDADG-212"><span class="linenos">212</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">updated</span><span class="p">)</span>
</span><span id="StandaloneDADG-213"><a href="#StandaloneDADG-213"><span class="linenos">213</span></a>            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">updater</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG-214"><a href="#StandaloneDADG-214"><span class="linenos">214</span></a>                <span class="n">node</span><span class="o">.</span><span class="n">updater</span> <span class="o">=</span> <span class="n">updater_name</span>
</span><span id="StandaloneDADG-215"><a href="#StandaloneDADG-215"><span class="linenos">215</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StandaloneDADG-216"><a href="#StandaloneDADG-216"><span class="linenos">216</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="n">updated</span><span class="si">}</span><span class="s2"> is already updated by </span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">updater</span><span class="si">}</span><span class="s2">; tried to add updater &quot;</span>
</span><span id="StandaloneDADG-217"><a href="#StandaloneDADG-217"><span class="linenos">217</span></a>                             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2"> which wants to update the same node.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-218"><a href="#StandaloneDADG-218"><span class="linenos">218</span></a>        <span class="c1"># add dependencies now that updated nodes have assigned updaters</span>
</span><span id="StandaloneDADG-219"><a href="#StandaloneDADG-219"><span class="linenos">219</span></a>        <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="n">updater</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
</span><span id="StandaloneDADG-220"><a href="#StandaloneDADG-220"><span class="linenos">220</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__add_dependency</span><span class="p">(</span><span class="n">dependency</span><span class="p">)</span>
</span><span id="StandaloneDADG-221"><a href="#StandaloneDADG-221"><span class="linenos">221</span></a>        <span class="c1"># check that the graph is not acyclic</span>
</span><span id="StandaloneDADG-222"><a href="#StandaloneDADG-222"><span class="linenos">222</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__check_acyclic</span><span class="p">():</span>
</span><span id="StandaloneDADG-223"><a href="#StandaloneDADG-223"><span class="linenos">223</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">remove_updater</span><span class="p">(</span><span class="n">updater_name</span><span class="p">)</span>
</span><span id="StandaloneDADG-224"><a href="#StandaloneDADG-224"><span class="linenos">224</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to add updater &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39;, as this added cycles to the graph.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-225"><a href="#StandaloneDADG-225"><span class="linenos">225</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="StandaloneDADG-226"><a href="#StandaloneDADG-226"><span class="linenos">226</span></a>
</span><span id="StandaloneDADG-227"><a href="#StandaloneDADG-227"><span class="linenos">227</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_updater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG-228"><a href="#StandaloneDADG-228"><span class="linenos">228</span></a>        <span class="c1"># check updater exists with given updater_name</span>
</span><span id="StandaloneDADG-229"><a href="#StandaloneDADG-229"><span class="linenos">229</span></a>        <span class="k">if</span> <span class="n">updater_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">:</span>
</span><span id="StandaloneDADG-230"><a href="#StandaloneDADG-230"><span class="linenos">230</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to remove updater &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39;; it doesn&#39;t exist.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-231"><a href="#StandaloneDADG-231"><span class="linenos">231</span></a>        <span class="c1"># remove the dependencies</span>
</span><span id="StandaloneDADG-232"><a href="#StandaloneDADG-232"><span class="linenos">232</span></a>        <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">[</span><span class="n">updater_name</span><span class="p">]</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
</span><span id="StandaloneDADG-233"><a href="#StandaloneDADG-233"><span class="linenos">233</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__remove_dependency</span><span class="p">(</span><span class="n">dependency</span><span class="p">)</span>
</span><span id="StandaloneDADG-234"><a href="#StandaloneDADG-234"><span class="linenos">234</span></a>        <span class="c1"># remove the updater names for the updated nodes</span>
</span><span id="StandaloneDADG-235"><a href="#StandaloneDADG-235"><span class="linenos">235</span></a>        <span class="k">for</span> <span class="n">updated</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">[</span><span class="n">updater_name</span><span class="p">]</span><span class="o">.</span><span class="n">returned</span><span class="p">:</span>
</span><span id="StandaloneDADG-236"><a href="#StandaloneDADG-236"><span class="linenos">236</span></a>            <span class="k">if</span> <span class="n">updated</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="StandaloneDADG-237"><a href="#StandaloneDADG-237"><span class="linenos">237</span></a>                <span class="k">continue</span>
</span><span id="StandaloneDADG-238"><a href="#StandaloneDADG-238"><span class="linenos">238</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">updated</span><span class="p">)</span>
</span><span id="StandaloneDADG-239"><a href="#StandaloneDADG-239"><span class="linenos">239</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">updated</span><span class="p">]</span><span class="o">.</span><span class="n">updater</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="StandaloneDADG-240"><a href="#StandaloneDADG-240"><span class="linenos">240</span></a>        <span class="c1"># remove the updater</span>
</span><span id="StandaloneDADG-241"><a href="#StandaloneDADG-241"><span class="linenos">241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">updater_name</span><span class="p">)</span>
</span><span id="StandaloneDADG-242"><a href="#StandaloneDADG-242"><span class="linenos">242</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="StandaloneDADG-243"><a href="#StandaloneDADG-243"><span class="linenos">243</span></a>
</span><span id="StandaloneDADG-244"><a href="#StandaloneDADG-244"><span class="linenos">244</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="StandaloneDADG-245"><a href="#StandaloneDADG-245"><span class="linenos">245</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_with_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FunctionArgument</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG-246"><a href="#StandaloneDADG-246"><span class="linenos">246</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-247"><a href="#StandaloneDADG-247"><span class="linenos">247</span></a><span class="sd">        Get the given list of named arguments from the `DAG`, returning an Error if any required argument is not</span>
</span><span id="StandaloneDADG-248"><a href="#StandaloneDADG-248"><span class="linenos">248</span></a><span class="sd">        available.</span>
</span><span id="StandaloneDADG-249"><a href="#StandaloneDADG-249"><span class="linenos">249</span></a><span class="sd">        :param args: list of function arguments, marked with whether they are required</span>
</span><span id="StandaloneDADG-250"><a href="#StandaloneDADG-250"><span class="linenos">250</span></a><span class="sd">        :return: A dictionary mapping argument name to retrieved value.</span>
</span><span id="StandaloneDADG-251"><a href="#StandaloneDADG-251"><span class="linenos">251</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StandaloneDADG-252"><a href="#StandaloneDADG-252"><span class="linenos">252</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StandaloneDADG-253"><a href="#StandaloneDADG-253"><span class="linenos">253</span></a>        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
</span><span id="StandaloneDADG-254"><a href="#StandaloneDADG-254"><span class="linenos">254</span></a>            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StandaloneDADG-255"><a href="#StandaloneDADG-255"><span class="linenos">255</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="StandaloneDADG-256"><a href="#StandaloneDADG-256"><span class="linenos">256</span></a>                <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
</span><span id="StandaloneDADG-257"><a href="#StandaloneDADG-257"><span class="linenos">257</span></a>                    <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting argument </span><span class="si">{</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: &#39;</span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-258"><a href="#StandaloneDADG-258"><span class="linenos">258</span></a>                <span class="k">continue</span>
</span><span id="StandaloneDADG-259"><a href="#StandaloneDADG-259"><span class="linenos">259</span></a>            <span class="n">ret</span><span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StandaloneDADG-260"><a href="#StandaloneDADG-260"><span class="linenos">260</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span><span id="StandaloneDADG-261"><a href="#StandaloneDADG-261"><span class="linenos">261</span></a>
</span><span id="StandaloneDADG-262"><a href="#StandaloneDADG-262"><span class="linenos">262</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG-263"><a href="#StandaloneDADG-263"><span class="linenos">263</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">graphviz</span>
</span><span id="StandaloneDADG-264"><a href="#StandaloneDADG-264"><span class="linenos">264</span></a>        <span class="n">g</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Digraph</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>
</span><span id="StandaloneDADG-265"><a href="#StandaloneDADG-265"><span class="linenos">265</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">updater</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StandaloneDADG-266"><a href="#StandaloneDADG-266"><span class="linenos">266</span></a>            <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="n">updater</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
</span><span id="StandaloneDADG-267"><a href="#StandaloneDADG-267"><span class="linenos">267</span></a>                <span class="n">g</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="p">,</span> <span class="n">dependency</span><span class="o">.</span><span class="n">depended</span><span class="p">)</span>
</span><span id="StandaloneDADG-268"><a href="#StandaloneDADG-268"><span class="linenos">268</span></a>        <span class="n">g</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-269"><a href="#StandaloneDADG-269"><span class="linenos">269</span></a>
</span><span id="StandaloneDADG-270"><a href="#StandaloneDADG-270"><span class="linenos">270</span></a>    <span class="c1">##### Protected methods and properties</span>
</span><span id="StandaloneDADG-271"><a href="#StandaloneDADG-271"><span class="linenos">271</span></a>
</span><span id="StandaloneDADG-272"><a href="#StandaloneDADG-272"><span class="linenos">272</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_node_if_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG-273"><a href="#StandaloneDADG-273"><span class="linenos">273</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="k">if</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="StandaloneDADG-274"><a href="#StandaloneDADG-274"><span class="linenos">274</span></a>
</span><span id="StandaloneDADG-275"><a href="#StandaloneDADG-275"><span class="linenos">275</span></a>    <span class="nd">@property</span>
</span><span id="StandaloneDADG-276"><a href="#StandaloneDADG-276"><span class="linenos">276</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Node</span><span class="p">]:</span>
</span><span id="StandaloneDADG-277"><a href="#StandaloneDADG-277"><span class="linenos">277</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span>
</span><span id="StandaloneDADG-278"><a href="#StandaloneDADG-278"><span class="linenos">278</span></a>
</span><span id="StandaloneDADG-279"><a href="#StandaloneDADG-279"><span class="linenos">279</span></a>    <span class="nd">@property</span>
</span><span id="StandaloneDADG-280"><a href="#StandaloneDADG-280"><span class="linenos">280</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_updaters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Updater</span><span class="p">]:</span>
</span><span id="StandaloneDADG-281"><a href="#StandaloneDADG-281"><span class="linenos">281</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span>
</span><span id="StandaloneDADG-282"><a href="#StandaloneDADG-282"><span class="linenos">282</span></a>
</span><span id="StandaloneDADG-283"><a href="#StandaloneDADG-283"><span class="linenos">283</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_add_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="n">ChildDirectedAcyclicDataGraph</span><span class="p">):</span>
</span><span id="StandaloneDADG-284"><a href="#StandaloneDADG-284"><span class="linenos">284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__children</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
</span><span id="StandaloneDADG-285"><a href="#StandaloneDADG-285"><span class="linenos">285</span></a>
</span><span id="StandaloneDADG-286"><a href="#StandaloneDADG-286"><span class="linenos">286</span></a>    <span class="c1">##### Private methods</span>
</span><span id="StandaloneDADG-287"><a href="#StandaloneDADG-287"><span class="linenos">287</span></a>
</span><span id="StandaloneDADG-288"><a href="#StandaloneDADG-288"><span class="linenos">288</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__get_node_ensure_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
</span><span id="StandaloneDADG-289"><a href="#StandaloneDADG-289"><span class="linenos">289</span></a>        <span class="k">if</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="StandaloneDADG-290"><a href="#StandaloneDADG-290"><span class="linenos">290</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span>
</span><span id="StandaloneDADG-291"><a href="#StandaloneDADG-291"><span class="linenos">291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">()</span>
</span><span id="StandaloneDADG-292"><a href="#StandaloneDADG-292"><span class="linenos">292</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span>
</span><span id="StandaloneDADG-293"><a href="#StandaloneDADG-293"><span class="linenos">293</span></a>
</span><span id="StandaloneDADG-294"><a href="#StandaloneDADG-294"><span class="linenos">294</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__set_dirty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG-295"><a href="#StandaloneDADG-295"><span class="linenos">295</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG-296"><a href="#StandaloneDADG-296"><span class="linenos">296</span></a>        <span class="c1"># make sure node exists</span>
</span><span id="StandaloneDADG-297"><a href="#StandaloneDADG-297"><span class="linenos">297</span></a>        <span class="n">node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG-298"><a href="#StandaloneDADG-298"><span class="linenos">298</span></a>        <span class="c1"># make node and all dependents dirty</span>
</span><span id="StandaloneDADG-299"><a href="#StandaloneDADG-299"><span class="linenos">299</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">dirty</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="StandaloneDADG-300"><a href="#StandaloneDADG-300"><span class="linenos">300</span></a>        <span class="k">for</span> <span class="n">dependent</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">dependents</span><span class="p">:</span>
</span><span id="StandaloneDADG-301"><a href="#StandaloneDADG-301"><span class="linenos">301</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__set_dirty</span><span class="p">(</span><span class="n">dependent</span><span class="p">)</span>
</span><span id="StandaloneDADG-302"><a href="#StandaloneDADG-302"><span class="linenos">302</span></a>
</span><span id="StandaloneDADG-303"><a href="#StandaloneDADG-303"><span class="linenos">303</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__add_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dependency</span><span class="p">:</span> <span class="n">Dependency</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG-304"><a href="#StandaloneDADG-304"><span class="linenos">304</span></a>        <span class="c1"># make sure both nodes exist</span>
</span><span id="StandaloneDADG-305"><a href="#StandaloneDADG-305"><span class="linenos">305</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="p">)</span>
</span><span id="StandaloneDADG-306"><a href="#StandaloneDADG-306"><span class="linenos">306</span></a>        <span class="n">depended_node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depended</span><span class="p">)</span>
</span><span id="StandaloneDADG-307"><a href="#StandaloneDADG-307"><span class="linenos">307</span></a>        <span class="c1"># make sure depender is in depended&#39;s list of dependents</span>
</span><span id="StandaloneDADG-308"><a href="#StandaloneDADG-308"><span class="linenos">308</span></a>        <span class="k">if</span> <span class="n">dependency</span><span class="o">.</span><span class="n">depender</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">depended_node</span><span class="o">.</span><span class="n">dependents</span><span class="p">:</span>
</span><span id="StandaloneDADG-309"><a href="#StandaloneDADG-309"><span class="linenos">309</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depended</span><span class="p">)</span>
</span><span id="StandaloneDADG-310"><a href="#StandaloneDADG-310"><span class="linenos">310</span></a>            <span class="n">depended_node</span><span class="o">.</span><span class="n">dependents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="p">)</span>
</span><span id="StandaloneDADG-311"><a href="#StandaloneDADG-311"><span class="linenos">311</span></a>        <span class="c1"># make depender dirty</span>
</span><span id="StandaloneDADG-312"><a href="#StandaloneDADG-312"><span class="linenos">312</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__set_dirty</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="p">)</span>
</span><span id="StandaloneDADG-313"><a href="#StandaloneDADG-313"><span class="linenos">313</span></a>
</span><span id="StandaloneDADG-314"><a href="#StandaloneDADG-314"><span class="linenos">314</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__remove_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dependency</span><span class="p">:</span> <span class="n">Dependency</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG-315"><a href="#StandaloneDADG-315"><span class="linenos">315</span></a>        <span class="c1"># check both nodes exist</span>
</span><span id="StandaloneDADG-316"><a href="#StandaloneDADG-316"><span class="linenos">316</span></a>        <span class="n">depender_node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="p">)</span>
</span><span id="StandaloneDADG-317"><a href="#StandaloneDADG-317"><span class="linenos">317</span></a>        <span class="n">depended_node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depended</span><span class="p">)</span>
</span><span id="StandaloneDADG-318"><a href="#StandaloneDADG-318"><span class="linenos">318</span></a>        <span class="k">if</span> <span class="n">depender_node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG-319"><a href="#StandaloneDADG-319"><span class="linenos">319</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error removing dependency: depender </span><span class="si">{</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="si">}</span><span class="s2"> doesn&#39;t exist.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-320"><a href="#StandaloneDADG-320"><span class="linenos">320</span></a>        <span class="k">if</span> <span class="n">depended_node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG-321"><a href="#StandaloneDADG-321"><span class="linenos">321</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error removing dependency: depender </span><span class="si">{</span><span class="n">dependency</span><span class="o">.</span><span class="n">depended</span><span class="si">}</span><span class="s2"> doesn&#39;t exist.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-322"><a href="#StandaloneDADG-322"><span class="linenos">322</span></a>        <span class="c1"># make sure depender is not in depended&#39;s list of dependents</span>
</span><span id="StandaloneDADG-323"><a href="#StandaloneDADG-323"><span class="linenos">323</span></a>        <span class="k">if</span> <span class="n">dependency</span><span class="o">.</span><span class="n">depender</span> <span class="ow">in</span> <span class="n">depended_node</span><span class="o">.</span><span class="n">dependents</span><span class="p">:</span>
</span><span id="StandaloneDADG-324"><a href="#StandaloneDADG-324"><span class="linenos">324</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="p">)</span>
</span><span id="StandaloneDADG-325"><a href="#StandaloneDADG-325"><span class="linenos">325</span></a>            <span class="n">depended_node</span><span class="o">.</span><span class="n">dependents</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="p">)</span>
</span><span id="StandaloneDADG-326"><a href="#StandaloneDADG-326"><span class="linenos">326</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="StandaloneDADG-327"><a href="#StandaloneDADG-327"><span class="linenos">327</span></a>
</span><span id="StandaloneDADG-328"><a href="#StandaloneDADG-328"><span class="linenos">328</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__run_updater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">soft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG-329"><a href="#StandaloneDADG-329"><span class="linenos">329</span></a>        <span class="c1"># get the updater object</span>
</span><span id="StandaloneDADG-330"><a href="#StandaloneDADG-330"><span class="linenos">330</span></a>        <span class="k">if</span> <span class="n">updater_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">:</span>
</span><span id="StandaloneDADG-331"><a href="#StandaloneDADG-331"><span class="linenos">331</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No updater named &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39; in graph.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-332"><a href="#StandaloneDADG-332"><span class="linenos">332</span></a>        <span class="n">updater</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">[</span><span class="n">updater_name</span><span class="p">]</span>
</span><span id="StandaloneDADG-333"><a href="#StandaloneDADG-333"><span class="linenos">333</span></a>        <span class="c1"># get the arguments for the function</span>
</span><span id="StandaloneDADG-334"><a href="#StandaloneDADG-334"><span class="linenos">334</span></a>        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_with_args</span><span class="p">(</span><span class="n">updater</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span>
</span><span id="StandaloneDADG-335"><a href="#StandaloneDADG-335"><span class="linenos">335</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="StandaloneDADG-336"><a href="#StandaloneDADG-336"><span class="linenos">336</span></a>            <span class="k">if</span> <span class="n">soft</span><span class="p">:</span>
</span><span id="StandaloneDADG-337"><a href="#StandaloneDADG-337"><span class="linenos">337</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="StandaloneDADG-338"><a href="#StandaloneDADG-338"><span class="linenos">338</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to get arguments to run updater &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">kwargs</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-339"><a href="#StandaloneDADG-339"><span class="linenos">339</span></a>        <span class="c1"># execute the function</span>
</span><span id="StandaloneDADG-340"><a href="#StandaloneDADG-340"><span class="linenos">340</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">updater</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="StandaloneDADG-341"><a href="#StandaloneDADG-341"><span class="linenos">341</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="StandaloneDADG-342"><a href="#StandaloneDADG-342"><span class="linenos">342</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error running updater function &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-343"><a href="#StandaloneDADG-343"><span class="linenos">343</span></a>        <span class="c1"># for each promised value, check it exists, and set the data</span>
</span><span id="StandaloneDADG-344"><a href="#StandaloneDADG-344"><span class="linenos">344</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="StandaloneDADG-345"><a href="#StandaloneDADG-345"><span class="linenos">345</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected data updater function &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39; to return a dictionary.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-346"><a href="#StandaloneDADG-346"><span class="linenos">346</span></a>        <span class="k">for</span> <span class="n">variable_updated</span> <span class="ow">in</span> <span class="n">updater</span><span class="o">.</span><span class="n">returned</span><span class="p">:</span>
</span><span id="StandaloneDADG-347"><a href="#StandaloneDADG-347"><span class="linenos">347</span></a>            <span class="k">if</span> <span class="n">variable_updated</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="StandaloneDADG-348"><a href="#StandaloneDADG-348"><span class="linenos">348</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span>
</span><span id="StandaloneDADG-349"><a href="#StandaloneDADG-349"><span class="linenos">349</span></a>                    <span class="sa">f</span><span class="s2">&quot;Variable &#39;</span><span class="si">{</span><span class="n">variable_updated</span><span class="si">}</span><span class="s2">&#39; not returned by updater function &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39; which promised &quot;</span>
</span><span id="StandaloneDADG-350"><a href="#StandaloneDADG-350"><span class="linenos">350</span></a>                    <span class="sa">f</span><span class="s2">&quot;it.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-351"><a href="#StandaloneDADG-351"><span class="linenos">351</span></a>            <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">variable_updated</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">variable_updated</span><span class="p">))</span>
</span><span id="StandaloneDADG-352"><a href="#StandaloneDADG-352"><span class="linenos">352</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="StandaloneDADG-353"><a href="#StandaloneDADG-353"><span class="linenos">353</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error setting value for &#39;</span><span class="si">{</span><span class="n">variable_updated</span><span class="si">}</span><span class="s2">&#39; after running updater &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39;: &quot;</span>
</span><span id="StandaloneDADG-354"><a href="#StandaloneDADG-354"><span class="linenos">354</span></a>                             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-355"><a href="#StandaloneDADG-355"><span class="linenos">355</span></a>        <span class="c1"># check for values returned that weren&#39;t promised</span>
</span><span id="StandaloneDADG-356"><a href="#StandaloneDADG-356"><span class="linenos">356</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="StandaloneDADG-357"><a href="#StandaloneDADG-357"><span class="linenos">357</span></a>            <span class="n">variable_names</span> <span class="o">=</span> <span class="s2">&quot;&#39;, &#39;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="StandaloneDADG-358"><a href="#StandaloneDADG-358"><span class="linenos">358</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updater function &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39; returned unexpected variables: &#39;</span><span class="si">{</span><span class="n">variable_names</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-359"><a href="#StandaloneDADG-359"><span class="linenos">359</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="StandaloneDADG-360"><a href="#StandaloneDADG-360"><span class="linenos">360</span></a>
</span><span id="StandaloneDADG-361"><a href="#StandaloneDADG-361"><span class="linenos">361</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__clean_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">soft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG-362"><a href="#StandaloneDADG-362"><span class="linenos">362</span></a>        <span class="n">node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG-363"><a href="#StandaloneDADG-363"><span class="linenos">363</span></a>        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG-364"><a href="#StandaloneDADG-364"><span class="linenos">364</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No node named &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; in graph.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-365"><a href="#StandaloneDADG-365"><span class="linenos">365</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">dirty</span><span class="p">:</span>
</span><span id="StandaloneDADG-366"><a href="#StandaloneDADG-366"><span class="linenos">366</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="StandaloneDADG-367"><a href="#StandaloneDADG-367"><span class="linenos">367</span></a>        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">updater</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG-368"><a href="#StandaloneDADG-368"><span class="linenos">368</span></a>            <span class="k">if</span> <span class="n">soft</span><span class="p">:</span>
</span><span id="StandaloneDADG-369"><a href="#StandaloneDADG-369"><span class="linenos">369</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="StandaloneDADG-370"><a href="#StandaloneDADG-370"><span class="linenos">370</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dirty node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; cannot be cleaned as it has no updater.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-371"><a href="#StandaloneDADG-371"><span class="linenos">371</span></a>        <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__run_updater</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">updater</span><span class="p">,</span> <span class="n">soft</span><span class="o">=</span><span class="n">soft</span><span class="p">)</span>
</span><span id="StandaloneDADG-372"><a href="#StandaloneDADG-372"><span class="linenos">372</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="StandaloneDADG-373"><a href="#StandaloneDADG-373"><span class="linenos">373</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to clean dirty node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39;; error running updater &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">updater</span><span class="si">}</span><span class="s2">&#39;: &quot;</span>
</span><span id="StandaloneDADG-374"><a href="#StandaloneDADG-374"><span class="linenos">374</span></a>                         <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-375"><a href="#StandaloneDADG-375"><span class="linenos">375</span></a>        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">dirty</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">soft</span><span class="p">:</span>
</span><span id="StandaloneDADG-376"><a href="#StandaloneDADG-376"><span class="linenos">376</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; still dirty after running updater &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">updater</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-377"><a href="#StandaloneDADG-377"><span class="linenos">377</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="StandaloneDADG-378"><a href="#StandaloneDADG-378"><span class="linenos">378</span></a>
</span><span id="StandaloneDADG-379"><a href="#StandaloneDADG-379"><span class="linenos">379</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__clean_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG-380"><a href="#StandaloneDADG-380"><span class="linenos">380</span></a>        <span class="k">for</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StandaloneDADG-381"><a href="#StandaloneDADG-381"><span class="linenos">381</span></a>            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">lazily_evaluated</span><span class="p">:</span>
</span><span id="StandaloneDADG-382"><a href="#StandaloneDADG-382"><span class="linenos">382</span></a>                <span class="k">continue</span>
</span><span id="StandaloneDADG-383"><a href="#StandaloneDADG-383"><span class="linenos">383</span></a>            <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__clean_node</span><span class="p">(</span><span class="n">node_name</span><span class="p">,</span> <span class="n">soft</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="StandaloneDADG-384"><a href="#StandaloneDADG-384"><span class="linenos">384</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="StandaloneDADG-385"><a href="#StandaloneDADG-385"><span class="linenos">385</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Graph clean failed on node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG-386"><a href="#StandaloneDADG-386"><span class="linenos">386</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="StandaloneDADG-387"><a href="#StandaloneDADG-387"><span class="linenos">387</span></a>
</span><span id="StandaloneDADG-388"><a href="#StandaloneDADG-388"><span class="linenos">388</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__eval_in_degrees</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="StandaloneDADG-389"><a href="#StandaloneDADG-389"><span class="linenos">389</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="p">{</span><span class="n">node_name</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">}</span>
</span><span id="StandaloneDADG-390"><a href="#StandaloneDADG-390"><span class="linenos">390</span></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StandaloneDADG-391"><a href="#StandaloneDADG-391"><span class="linenos">391</span></a>            <span class="k">for</span> <span class="n">dependent</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">dependents</span><span class="p">:</span>
</span><span id="StandaloneDADG-392"><a href="#StandaloneDADG-392"><span class="linenos">392</span></a>                <span class="n">ret</span><span class="p">[</span><span class="n">dependent</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="StandaloneDADG-393"><a href="#StandaloneDADG-393"><span class="linenos">393</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span><span id="StandaloneDADG-394"><a href="#StandaloneDADG-394"><span class="linenos">394</span></a>
</span><span id="StandaloneDADG-395"><a href="#StandaloneDADG-395"><span class="linenos">395</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__check_acyclic</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StandaloneDADG-396"><a href="#StandaloneDADG-396"><span class="linenos">396</span></a>        <span class="n">in_degrees</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__eval_in_degrees</span><span class="p">()</span>
</span><span id="StandaloneDADG-397"><a href="#StandaloneDADG-397"><span class="linenos">397</span></a>        <span class="n">q</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">([</span><span class="n">node_name</span> <span class="k">for</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span> <span class="k">if</span> <span class="n">in_degrees</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="StandaloneDADG-398"><a href="#StandaloneDADG-398"><span class="linenos">398</span></a>        <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="StandaloneDADG-399"><a href="#StandaloneDADG-399"><span class="linenos">399</span></a>        <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
</span><span id="StandaloneDADG-400"><a href="#StandaloneDADG-400"><span class="linenos">400</span></a>            <span class="n">first</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</span><span id="StandaloneDADG-401"><a href="#StandaloneDADG-401"><span class="linenos">401</span></a>            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="StandaloneDADG-402"><a href="#StandaloneDADG-402"><span class="linenos">402</span></a>            <span class="k">for</span> <span class="n">dependent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">first</span><span class="p">]</span><span class="o">.</span><span class="n">dependents</span><span class="p">:</span>
</span><span id="StandaloneDADG-403"><a href="#StandaloneDADG-403"><span class="linenos">403</span></a>                <span class="n">in_degrees</span><span class="p">[</span><span class="n">dependent</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="StandaloneDADG-404"><a href="#StandaloneDADG-404"><span class="linenos">404</span></a>                <span class="k">if</span> <span class="n">in_degrees</span><span class="p">[</span><span class="n">dependent</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="StandaloneDADG-405"><a href="#StandaloneDADG-405"><span class="linenos">405</span></a>                    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dependent</span><span class="p">)</span>
</span><span id="StandaloneDADG-406"><a href="#StandaloneDADG-406"><span class="linenos">406</span></a>        <span class="k">return</span> <span class="n">count</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">)</span>
</span><span id="StandaloneDADG-407"><a href="#StandaloneDADG-407"><span class="linenos">407</span></a>
</span><span id="StandaloneDADG-408"><a href="#StandaloneDADG-408"><span class="linenos">408</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__send_children_copies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG-409"><a href="#StandaloneDADG-409"><span class="linenos">409</span></a>        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__children</span><span class="p">:</span>
</span><span id="StandaloneDADG-410"><a href="#StandaloneDADG-410"><span class="linenos">410</span></a>            <span class="n">child</span><span class="o">.</span><span class="n">_make_copy</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A data manager that stores data in a directed, acyclic graph.</p>

<p>Each variable (piece of data) has a <code>str</code> name and is stored as a node in the graph.</p>

<p>The value of a variable can be set using <code>data_manager().set_data(&lt;variable name&gt;, &lt;value&gt;)</code>. Multiple can be set
at once using <code>data_manager().set_data_multiple(&lt;variable name&gt;=&lt;value&gt;, &lt;variable name&gt;=&lt;value&gt;, ...)</code>.</p>

<p>Dependencies between variables are added using instance of the <code><a href="#Updater">Updater</a></code> class, and the function
<code>data_manager().add_updater(&lt;updater name&gt;, &lt;updater instance&gt;)</code>. The <code>&lt;updater name&gt;</code> is just a user-defined <code>str</code>
name associated with the updater instance, which is used if the user wishes to remove the updater later on with
<code>data_manager().remove_updater(&lt;updater name&gt;)</code>.</p>

<p>Each updater defines a dependency of a set of variables on a set of other variables, as well as the mapping between
them.</p>

<p>Each variable (node) may be updated by:</p>

<ul>
<li>no updaters, so its value is always valid, and is only ever changed using <code>data_manager().set_data</code> /
<code>data_manager().set_data_multiple</code>, or</li>
<li>one updater, so its value is invalidated by changes to its dependents, and will be re-evaluated automatically by
its updater when read.</li>
</ul>

<p>By default, all variables are evaluated lazily, i.e. updaters will only be run to re-evaluate invalidated values
upon reading of the dependent variables. While this is good for optimisation, when data are displayed in a GUI, this
is generally not desirable, as the user will generally wish to only be shown valid data. In this case, variables
can manually be set to non-lazy have evaluation using
<code>data_manager().set_evaluation_laziness(&lt;variable name&gt;, lazily_evaluated=False)</code>.</p>

<p>It is sometimes useful to know when a variable's value changes, e.g. for updating GUI elements. Callbacks can be
added using <code>data_manager().add_callback(&lt;variable name&gt;, &lt;callback name&gt;, &lt;callback value&gt;)</code>. The <code>&lt;callback name&gt;</code>
is just a user-defined <code>str</code> name associated with the callback, which is used if the user wishes to remove the
callback later on with <code>data_manager().remove_callback(&lt;variable name&gt;, &lt;callback name&gt;)</code>.</p>
</div>


                            <div id="StandaloneDADG.has_node" class="classattr">
                                        <input id="StandaloneDADG.has_node-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">has_node</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="StandaloneDADG.has_node-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StandaloneDADG.has_node"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StandaloneDADG.has_node-99"><a href="#StandaloneDADG.has_node-99"><span class="linenos"> 99</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="StandaloneDADG.has_node-100"><a href="#StandaloneDADG.has_node-100"><span class="linenos">100</span></a>        <span class="k">return</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span>
</span></pre></div>


    

                            </div>
                            <div id="StandaloneDADG.get" class="classattr">
                                        <input id="StandaloneDADG.get-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">soft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="StandaloneDADG.get-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StandaloneDADG.get"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StandaloneDADG.get-102"><a href="#StandaloneDADG.get-102"><span class="linenos">102</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="StandaloneDADG.get-103"><a href="#StandaloneDADG.get-103"><span class="linenos">103</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">soft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG.get-104"><a href="#StandaloneDADG.get-104"><span class="linenos">104</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandaloneDADG.get-105"><a href="#StandaloneDADG.get-105"><span class="linenos">105</span></a><span class="sd">        Get the data associated with the named node. Will lazily re-calculate the value if previously made dirty by</span>
</span><span id="StandaloneDADG.get-106"><a href="#StandaloneDADG.get-106"><span class="linenos">106</span></a><span class="sd">        changes to other values.</span>
</span><span id="StandaloneDADG.get-107"><a href="#StandaloneDADG.get-107"><span class="linenos">107</span></a><span class="sd">        :param node_name: The name of the node.</span>
</span><span id="StandaloneDADG.get-108"><a href="#StandaloneDADG.get-108"><span class="linenos">108</span></a><span class="sd">        :param soft: [Optional; default=False] Whether to return an Error if there is not enough data to clean the node.</span>
</span><span id="StandaloneDADG.get-109"><a href="#StandaloneDADG.get-109"><span class="linenos">109</span></a><span class="sd">        :return: The data associated with the name node, or an instance of `Error` on failure.</span>
</span><span id="StandaloneDADG.get-110"><a href="#StandaloneDADG.get-110"><span class="linenos">110</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StandaloneDADG.get-111"><a href="#StandaloneDADG.get-111"><span class="linenos">111</span></a>        <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__clean_node</span><span class="p">(</span><span class="n">node_name</span><span class="p">,</span> <span class="n">soft</span><span class="o">=</span><span class="n">soft</span><span class="p">)</span>
</span><span id="StandaloneDADG.get-112"><a href="#StandaloneDADG.get-112"><span class="linenos">112</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="StandaloneDADG.get-113"><a href="#StandaloneDADG.get-113"><span class="linenos">113</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error cleaning node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; before &#39;get&#39;: </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG.get-114"><a href="#StandaloneDADG.get-114"><span class="linenos">114</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="n">NoNodeData</span><span class="p">:</span>
</span><span id="StandaloneDADG.get-115"><a href="#StandaloneDADG.get-115"><span class="linenos">115</span></a>            <span class="k">if</span> <span class="n">soft</span><span class="p">:</span>
</span><span id="StandaloneDADG.get-116"><a href="#StandaloneDADG.get-116"><span class="linenos">116</span></a>                <span class="k">return</span> <span class="n">NoNodeData</span>
</span><span id="StandaloneDADG.get-117"><a href="#StandaloneDADG.get-117"><span class="linenos">117</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No data stored for node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; in graph.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG.get-118"><a href="#StandaloneDADG.get-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</span></pre></div>


            <div class="docstring"><p>Get the data associated with the named node. Will lazily re-calculate the value if previously made dirty by
changes to other values.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>node_name</strong>:  The name of the node.</li>
<li><strong>soft</strong>:  [Optional; default=False] Whether to return an Error if there is not enough data to clean the node.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The data associated with the name node, or an instance of <code>Error</code> on failure.</p>
</blockquote>
</div>


                            </div>
                            <div id="StandaloneDADG.set" class="classattr">
                                        <input id="StandaloneDADG.set-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">Any</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">check_equality</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="kc">None</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="StandaloneDADG.set-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StandaloneDADG.set"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StandaloneDADG.set-120"><a href="#StandaloneDADG.set-120"><span class="linenos">120</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="StandaloneDADG.set-121"><a href="#StandaloneDADG.set-121"><span class="linenos">121</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">check_equality</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG.set-122"><a href="#StandaloneDADG.set-122"><span class="linenos">122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandaloneDADG.set-123"><a href="#StandaloneDADG.set-123"><span class="linenos">123</span></a><span class="sd">        Set the data associated with a named node. Will create the node if it doesn&#39;t exist.</span>
</span><span id="StandaloneDADG.set-124"><a href="#StandaloneDADG.set-124"><span class="linenos">124</span></a><span class="sd">        :param node_name: Name of the node.</span>
</span><span id="StandaloneDADG.set-125"><a href="#StandaloneDADG.set-125"><span class="linenos">125</span></a><span class="sd">        :param data: New data to assign.</span>
</span><span id="StandaloneDADG.set-126"><a href="#StandaloneDADG.set-126"><span class="linenos">126</span></a><span class="sd">        :param check_equality: [Optional; default=False] Whether to check the new value against the old value,</span>
</span><span id="StandaloneDADG.set-127"><a href="#StandaloneDADG.set-127"><span class="linenos">127</span></a><span class="sd">        and leave the node clean if the new value is the same.</span>
</span><span id="StandaloneDADG.set-128"><a href="#StandaloneDADG.set-128"><span class="linenos">128</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StandaloneDADG.set-129"><a href="#StandaloneDADG.set-129"><span class="linenos">129</span></a>        <span class="c1"># make sure node exists</span>
</span><span id="StandaloneDADG.set-130"><a href="#StandaloneDADG.set-130"><span class="linenos">130</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG.set-131"><a href="#StandaloneDADG.set-131"><span class="linenos">131</span></a>        <span class="c1"># set the data and make not dirty</span>
</span><span id="StandaloneDADG.set-132"><a href="#StandaloneDADG.set-132"><span class="linenos">132</span></a>        <span class="k">if</span> <span class="n">check_equality</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="n">data</span><span class="p">:</span>
</span><span id="StandaloneDADG.set-133"><a href="#StandaloneDADG.set-133"><span class="linenos">133</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="StandaloneDADG.set-134"><a href="#StandaloneDADG.set-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG.set-135"><a href="#StandaloneDADG.set-135"><span class="linenos">135</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="StandaloneDADG.set-136"><a href="#StandaloneDADG.set-136"><span class="linenos">136</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">dirty</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="StandaloneDADG.set-137"><a href="#StandaloneDADG.set-137"><span class="linenos">137</span></a>        <span class="c1"># call the node&#39;s set callbacks</span>
</span><span id="StandaloneDADG.set-138"><a href="#StandaloneDADG.set-138"><span class="linenos">138</span></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">observers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StandaloneDADG.set-139"><a href="#StandaloneDADG.set-139"><span class="linenos">139</span></a>            <span class="n">err</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="StandaloneDADG.set-140"><a href="#StandaloneDADG.set-140"><span class="linenos">140</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="StandaloneDADG.set-141"><a href="#StandaloneDADG.set-141"><span class="linenos">141</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Observer callback returned error: </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG.set-142"><a href="#StandaloneDADG.set-142"><span class="linenos">142</span></a>        <span class="c1"># make all dependents dirty</span>
</span><span id="StandaloneDADG.set-143"><a href="#StandaloneDADG.set-143"><span class="linenos">143</span></a>        <span class="k">for</span> <span class="n">dependent</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">dependents</span><span class="p">:</span>
</span><span id="StandaloneDADG.set-144"><a href="#StandaloneDADG.set-144"><span class="linenos">144</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__set_dirty</span><span class="p">(</span><span class="n">dependent</span><span class="p">)</span>
</span><span id="StandaloneDADG.set-145"><a href="#StandaloneDADG.set-145"><span class="linenos">145</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Set the data associated with a named node. Will create the node if it doesn't exist.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>node_name</strong>:  Name of the node.</li>
<li><strong>data</strong>:  New data to assign.</li>
<li><strong>check_equality</strong>:  [Optional; default=False] Whether to check the new value against the old value,
and leave the node clean if the new value is the same.</li>
</ul>
</div>


                            </div>
                            <div id="StandaloneDADG.set_multiple" class="classattr">
                                        <input id="StandaloneDADG.set_multiple-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_multiple</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="kc">None</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="StandaloneDADG.set_multiple-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StandaloneDADG.set_multiple"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StandaloneDADG.set_multiple-147"><a href="#StandaloneDADG.set_multiple-147"><span class="linenos">147</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="StandaloneDADG.set_multiple-148"><a href="#StandaloneDADG.set_multiple-148"><span class="linenos">148</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG.set_multiple-149"><a href="#StandaloneDADG.set_multiple-149"><span class="linenos">149</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandaloneDADG.set_multiple-150"><a href="#StandaloneDADG.set_multiple-150"><span class="linenos">150</span></a><span class="sd">        Set the data associated with multiple named nodes. Will create the node if it doesn&#39;t exist.</span>
</span><span id="StandaloneDADG.set_multiple-151"><a href="#StandaloneDADG.set_multiple-151"><span class="linenos">151</span></a><span class="sd">        Each keyword argument `name=value` will set the data `value` for the node `name`.</span>
</span><span id="StandaloneDADG.set_multiple-152"><a href="#StandaloneDADG.set_multiple-152"><span class="linenos">152</span></a><span class="sd">        :return: Nothing on success; an `Error` on failure.</span>
</span><span id="StandaloneDADG.set_multiple-153"><a href="#StandaloneDADG.set_multiple-153"><span class="linenos">153</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StandaloneDADG.set_multiple-154"><a href="#StandaloneDADG.set_multiple-154"><span class="linenos">154</span></a>        <span class="k">for</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StandaloneDADG.set_multiple-155"><a href="#StandaloneDADG.set_multiple-155"><span class="linenos">155</span></a>            <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">node_name</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="StandaloneDADG.set_multiple-156"><a href="#StandaloneDADG.set_multiple-156"><span class="linenos">156</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="StandaloneDADG.set_multiple-157"><a href="#StandaloneDADG.set_multiple-157"><span class="linenos">157</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error setting multiple data; specifically for &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG.set_multiple-158"><a href="#StandaloneDADG.set_multiple-158"><span class="linenos">158</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Set the data associated with multiple named nodes. Will create the node if it doesn't exist.
Each keyword argument <code>name=value</code> will set the data <code>value</code> for the node <code>name</code>.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Nothing on success; an <code>Error</code> on failure.</p>
</blockquote>
</div>


                            </div>
                            <div id="StandaloneDADG.set_evaluation_laziness" class="classattr">
                                        <input id="StandaloneDADG.set_evaluation_laziness-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_evaluation_laziness</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">lazily_evaluated</span><span class="p">:</span> <span class="nb">bool</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="StandaloneDADG.set_evaluation_laziness-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StandaloneDADG.set_evaluation_laziness"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StandaloneDADG.set_evaluation_laziness-160"><a href="#StandaloneDADG.set_evaluation_laziness-160"><span class="linenos">160</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="StandaloneDADG.set_evaluation_laziness-161"><a href="#StandaloneDADG.set_evaluation_laziness-161"><span class="linenos">161</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_evaluation_laziness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">lazily_evaluated</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG.set_evaluation_laziness-162"><a href="#StandaloneDADG.set_evaluation_laziness-162"><span class="linenos">162</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandaloneDADG.set_evaluation_laziness-163"><a href="#StandaloneDADG.set_evaluation_laziness-163"><span class="linenos">163</span></a><span class="sd">        Set whether the named node will be evaluated lazily. Nodes will be evaluated lazily by default. A node that is</span>
</span><span id="StandaloneDADG.set_evaluation_laziness-164"><a href="#StandaloneDADG.set_evaluation_laziness-164"><span class="linenos">164</span></a><span class="sd">        not evaluated lazily will be re-evaluated if dirty and the required data exists, every time data in the graph</span>
</span><span id="StandaloneDADG.set_evaluation_laziness-165"><a href="#StandaloneDADG.set_evaluation_laziness-165"><span class="linenos">165</span></a><span class="sd">        changes.</span>
</span><span id="StandaloneDADG.set_evaluation_laziness-166"><a href="#StandaloneDADG.set_evaluation_laziness-166"><span class="linenos">166</span></a><span class="sd">        :param node_name: The name of the node to modify</span>
</span><span id="StandaloneDADG.set_evaluation_laziness-167"><a href="#StandaloneDADG.set_evaluation_laziness-167"><span class="linenos">167</span></a><span class="sd">        :param lazily_evaluated: Whether the named node should be evaluated lazily</span>
</span><span id="StandaloneDADG.set_evaluation_laziness-168"><a href="#StandaloneDADG.set_evaluation_laziness-168"><span class="linenos">168</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StandaloneDADG.set_evaluation_laziness-169"><a href="#StandaloneDADG.set_evaluation_laziness-169"><span class="linenos">169</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG.set_evaluation_laziness-170"><a href="#StandaloneDADG.set_evaluation_laziness-170"><span class="linenos">170</span></a>        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG.set_evaluation_laziness-171"><a href="#StandaloneDADG.set_evaluation_laziness-171"><span class="linenos">171</span></a>            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">lazily_evaluated</span> <span class="o">==</span> <span class="n">lazily_evaluated</span><span class="p">:</span>
</span><span id="StandaloneDADG.set_evaluation_laziness-172"><a href="#StandaloneDADG.set_evaluation_laziness-172"><span class="linenos">172</span></a>                <span class="k">return</span>
</span><span id="StandaloneDADG.set_evaluation_laziness-173"><a href="#StandaloneDADG.set_evaluation_laziness-173"><span class="linenos">173</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG.set_evaluation_laziness-174"><a href="#StandaloneDADG.set_evaluation_laziness-174"><span class="linenos">174</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG.set_evaluation_laziness-175"><a href="#StandaloneDADG.set_evaluation_laziness-175"><span class="linenos">175</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">lazily_evaluated</span> <span class="o">=</span> <span class="n">lazily_evaluated</span>
</span></pre></div>


            <div class="docstring"><p>Set whether the named node will be evaluated lazily. Nodes will be evaluated lazily by default. A node that is
not evaluated lazily will be re-evaluated if dirty and the required data exists, every time data in the graph
changes.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>node_name</strong>:  The name of the node to modify</li>
<li><strong>lazily_evaluated</strong>:  Whether the named node should be evaluated lazily</li>
</ul>
</div>


                            </div>
                            <div id="StandaloneDADG.observe" class="classattr">
                                        <input id="StandaloneDADG.observe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">observe</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="StandaloneDADG.observe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StandaloneDADG.observe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StandaloneDADG.observe-177"><a href="#StandaloneDADG.observe-177"><span class="linenos">177</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">observe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG.observe-178"><a href="#StandaloneDADG.observe-178"><span class="linenos">178</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandaloneDADG.observe-179"><a href="#StandaloneDADG.observe-179"><span class="linenos">179</span></a><span class="sd">        Add a callback function to a node that will be called whenever the node&#39;s data changes.</span>
</span><span id="StandaloneDADG.observe-180"><a href="#StandaloneDADG.observe-180"><span class="linenos">180</span></a><span class="sd">        :param node_name:</span>
</span><span id="StandaloneDADG.observe-181"><a href="#StandaloneDADG.observe-181"><span class="linenos">181</span></a><span class="sd">        :param observer_name:</span>
</span><span id="StandaloneDADG.observe-182"><a href="#StandaloneDADG.observe-182"><span class="linenos">182</span></a><span class="sd">        :param callback:</span>
</span><span id="StandaloneDADG.observe-183"><a href="#StandaloneDADG.observe-183"><span class="linenos">183</span></a><span class="sd">        :return:</span>
</span><span id="StandaloneDADG.observe-184"><a href="#StandaloneDADG.observe-184"><span class="linenos">184</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StandaloneDADG.observe-185"><a href="#StandaloneDADG.observe-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span><span class="o">.</span><span class="n">observers</span><span class="p">[</span><span class="n">observer_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
</span></pre></div>


            <div class="docstring"><p>Add a callback function to a node that will be called whenever the node's data changes.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>node_name</strong>: </li>
<li><strong>observer_name</strong>: </li>
<li><strong>callback</strong>: </li>
</ul>

<h6 id="returns">Returns</h6>
</div>


                            </div>
                            <div id="StandaloneDADG.remove_observer" class="classattr">
                                        <input id="StandaloneDADG.remove_observer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_observer</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="StandaloneDADG.remove_observer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StandaloneDADG.remove_observer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StandaloneDADG.remove_observer-187"><a href="#StandaloneDADG.remove_observer-187"><span class="linenos">187</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_observer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG.remove_observer-188"><a href="#StandaloneDADG.remove_observer-188"><span class="linenos">188</span></a>        <span class="n">node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG.remove_observer-189"><a href="#StandaloneDADG.remove_observer-189"><span class="linenos">189</span></a>        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG.remove_observer-190"><a href="#StandaloneDADG.remove_observer-190"><span class="linenos">190</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No node named &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; from which to remove callback.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG.remove_observer-191"><a href="#StandaloneDADG.remove_observer-191"><span class="linenos">191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="StandaloneDADG.remove_observer-192"><a href="#StandaloneDADG.remove_observer-192"><span class="linenos">192</span></a>        <span class="k">if</span> <span class="n">observer_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">observers</span><span class="p">:</span>
</span><span id="StandaloneDADG.remove_observer-193"><a href="#StandaloneDADG.remove_observer-193"><span class="linenos">193</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No observer named &#39;</span><span class="si">{</span><span class="n">observer_name</span><span class="si">}</span><span class="s2">&#39; in node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG.remove_observer-194"><a href="#StandaloneDADG.remove_observer-194"><span class="linenos">194</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">observers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">observer_name</span><span class="p">)</span>
</span><span id="StandaloneDADG.remove_observer-195"><a href="#StandaloneDADG.remove_observer-195"><span class="linenos">195</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


    

                            </div>
                            <div id="StandaloneDADG.add_updater" class="classattr">
                                        <input id="StandaloneDADG.add_updater-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_updater</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">updater</span><span class="p">:</span> <span class="n"><a href="#Updater">Updater</a></span></span><span class="return-annotation">) -> <span class="kc">None</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="StandaloneDADG.add_updater-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StandaloneDADG.add_updater"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StandaloneDADG.add_updater-197"><a href="#StandaloneDADG.add_updater-197"><span class="linenos">197</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="StandaloneDADG.add_updater-198"><a href="#StandaloneDADG.add_updater-198"><span class="linenos">198</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_updater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">updater</span><span class="p">:</span> <span class="n">Updater</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG.add_updater-199"><a href="#StandaloneDADG.add_updater-199"><span class="linenos">199</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandaloneDADG.add_updater-200"><a href="#StandaloneDADG.add_updater-200"><span class="linenos">200</span></a><span class="sd">        Add a new updater object to the DAG. Each node may only be updated by a single updater, or no updater.</span>
</span><span id="StandaloneDADG.add_updater-201"><a href="#StandaloneDADG.add_updater-201"><span class="linenos">201</span></a><span class="sd">        :param updater_name: A human-readable name to assign to the added updater.</span>
</span><span id="StandaloneDADG.add_updater-202"><a href="#StandaloneDADG.add_updater-202"><span class="linenos">202</span></a><span class="sd">        :param updater: The updater object. Can be created from a function using the `dag_updater` decorator.</span>
</span><span id="StandaloneDADG.add_updater-203"><a href="#StandaloneDADG.add_updater-203"><span class="linenos">203</span></a><span class="sd">        :return: None, or an `Error` object on failure.</span>
</span><span id="StandaloneDADG.add_updater-204"><a href="#StandaloneDADG.add_updater-204"><span class="linenos">204</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StandaloneDADG.add_updater-205"><a href="#StandaloneDADG.add_updater-205"><span class="linenos">205</span></a>        <span class="c1"># insert the new updater, checking that there isn&#39;t already one of the same name</span>
</span><span id="StandaloneDADG.add_updater-206"><a href="#StandaloneDADG.add_updater-206"><span class="linenos">206</span></a>        <span class="k">if</span> <span class="n">updater_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">:</span>
</span><span id="StandaloneDADG.add_updater-207"><a href="#StandaloneDADG.add_updater-207"><span class="linenos">207</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updater named &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39; already exists in graph.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG.add_updater-208"><a href="#StandaloneDADG.add_updater-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">[</span><span class="n">updater_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">updater</span>
</span><span id="StandaloneDADG.add_updater-209"><a href="#StandaloneDADG.add_updater-209"><span class="linenos">209</span></a>        <span class="c1"># set the updater names for updated nodes</span>
</span><span id="StandaloneDADG.add_updater-210"><a href="#StandaloneDADG.add_updater-210"><span class="linenos">210</span></a>        <span class="k">for</span> <span class="n">updated</span> <span class="ow">in</span> <span class="n">updater</span><span class="o">.</span><span class="n">returned</span><span class="p">:</span>
</span><span id="StandaloneDADG.add_updater-211"><a href="#StandaloneDADG.add_updater-211"><span class="linenos">211</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">updated</span><span class="p">)</span>
</span><span id="StandaloneDADG.add_updater-212"><a href="#StandaloneDADG.add_updater-212"><span class="linenos">212</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">updated</span><span class="p">)</span>
</span><span id="StandaloneDADG.add_updater-213"><a href="#StandaloneDADG.add_updater-213"><span class="linenos">213</span></a>            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">updater</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG.add_updater-214"><a href="#StandaloneDADG.add_updater-214"><span class="linenos">214</span></a>                <span class="n">node</span><span class="o">.</span><span class="n">updater</span> <span class="o">=</span> <span class="n">updater_name</span>
</span><span id="StandaloneDADG.add_updater-215"><a href="#StandaloneDADG.add_updater-215"><span class="linenos">215</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="StandaloneDADG.add_updater-216"><a href="#StandaloneDADG.add_updater-216"><span class="linenos">216</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="n">updated</span><span class="si">}</span><span class="s2"> is already updated by </span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">updater</span><span class="si">}</span><span class="s2">; tried to add updater &quot;</span>
</span><span id="StandaloneDADG.add_updater-217"><a href="#StandaloneDADG.add_updater-217"><span class="linenos">217</span></a>                             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2"> which wants to update the same node.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG.add_updater-218"><a href="#StandaloneDADG.add_updater-218"><span class="linenos">218</span></a>        <span class="c1"># add dependencies now that updated nodes have assigned updaters</span>
</span><span id="StandaloneDADG.add_updater-219"><a href="#StandaloneDADG.add_updater-219"><span class="linenos">219</span></a>        <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="n">updater</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
</span><span id="StandaloneDADG.add_updater-220"><a href="#StandaloneDADG.add_updater-220"><span class="linenos">220</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__add_dependency</span><span class="p">(</span><span class="n">dependency</span><span class="p">)</span>
</span><span id="StandaloneDADG.add_updater-221"><a href="#StandaloneDADG.add_updater-221"><span class="linenos">221</span></a>        <span class="c1"># check that the graph is not acyclic</span>
</span><span id="StandaloneDADG.add_updater-222"><a href="#StandaloneDADG.add_updater-222"><span class="linenos">222</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__check_acyclic</span><span class="p">():</span>
</span><span id="StandaloneDADG.add_updater-223"><a href="#StandaloneDADG.add_updater-223"><span class="linenos">223</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">remove_updater</span><span class="p">(</span><span class="n">updater_name</span><span class="p">)</span>
</span><span id="StandaloneDADG.add_updater-224"><a href="#StandaloneDADG.add_updater-224"><span class="linenos">224</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to add updater &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39;, as this added cycles to the graph.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG.add_updater-225"><a href="#StandaloneDADG.add_updater-225"><span class="linenos">225</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Add a new updater object to the DAG. Each node may only be updated by a single updater, or no updater.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>updater_name</strong>:  A human-readable name to assign to the added updater.</li>
<li><strong>updater</strong>:  The updater object. Can be created from a function using the <code>dag_updater</code> decorator.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None, or an <code>Error</code> object on failure.</p>
</blockquote>
</div>


                            </div>
                            <div id="StandaloneDADG.remove_updater" class="classattr">
                                        <input id="StandaloneDADG.remove_updater-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_updater</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="StandaloneDADG.remove_updater-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StandaloneDADG.remove_updater"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StandaloneDADG.remove_updater-227"><a href="#StandaloneDADG.remove_updater-227"><span class="linenos">227</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_updater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG.remove_updater-228"><a href="#StandaloneDADG.remove_updater-228"><span class="linenos">228</span></a>        <span class="c1"># check updater exists with given updater_name</span>
</span><span id="StandaloneDADG.remove_updater-229"><a href="#StandaloneDADG.remove_updater-229"><span class="linenos">229</span></a>        <span class="k">if</span> <span class="n">updater_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">:</span>
</span><span id="StandaloneDADG.remove_updater-230"><a href="#StandaloneDADG.remove_updater-230"><span class="linenos">230</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to remove updater &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39;; it doesn&#39;t exist.&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG.remove_updater-231"><a href="#StandaloneDADG.remove_updater-231"><span class="linenos">231</span></a>        <span class="c1"># remove the dependencies</span>
</span><span id="StandaloneDADG.remove_updater-232"><a href="#StandaloneDADG.remove_updater-232"><span class="linenos">232</span></a>        <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">[</span><span class="n">updater_name</span><span class="p">]</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
</span><span id="StandaloneDADG.remove_updater-233"><a href="#StandaloneDADG.remove_updater-233"><span class="linenos">233</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__remove_dependency</span><span class="p">(</span><span class="n">dependency</span><span class="p">)</span>
</span><span id="StandaloneDADG.remove_updater-234"><a href="#StandaloneDADG.remove_updater-234"><span class="linenos">234</span></a>        <span class="c1"># remove the updater names for the updated nodes</span>
</span><span id="StandaloneDADG.remove_updater-235"><a href="#StandaloneDADG.remove_updater-235"><span class="linenos">235</span></a>        <span class="k">for</span> <span class="n">updated</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">[</span><span class="n">updater_name</span><span class="p">]</span><span class="o">.</span><span class="n">returned</span><span class="p">:</span>
</span><span id="StandaloneDADG.remove_updater-236"><a href="#StandaloneDADG.remove_updater-236"><span class="linenos">236</span></a>            <span class="k">if</span> <span class="n">updated</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="StandaloneDADG.remove_updater-237"><a href="#StandaloneDADG.remove_updater-237"><span class="linenos">237</span></a>                <span class="k">continue</span>
</span><span id="StandaloneDADG.remove_updater-238"><a href="#StandaloneDADG.remove_updater-238"><span class="linenos">238</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">updated</span><span class="p">)</span>
</span><span id="StandaloneDADG.remove_updater-239"><a href="#StandaloneDADG.remove_updater-239"><span class="linenos">239</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">updated</span><span class="p">]</span><span class="o">.</span><span class="n">updater</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="StandaloneDADG.remove_updater-240"><a href="#StandaloneDADG.remove_updater-240"><span class="linenos">240</span></a>        <span class="c1"># remove the updater</span>
</span><span id="StandaloneDADG.remove_updater-241"><a href="#StandaloneDADG.remove_updater-241"><span class="linenos">241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">updater_name</span><span class="p">)</span>
</span><span id="StandaloneDADG.remove_updater-242"><a href="#StandaloneDADG.remove_updater-242"><span class="linenos">242</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


    

                            </div>
                            <div id="StandaloneDADG.get_with_args" class="classattr">
                                        <input id="StandaloneDADG.get_with_args-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_with_args</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="../utils/reflection.html#FunctionArgument">reg23_experiments.utils.reflection.FunctionArgument</a></span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="StandaloneDADG.get_with_args-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StandaloneDADG.get_with_args"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StandaloneDADG.get_with_args-244"><a href="#StandaloneDADG.get_with_args-244"><span class="linenos">244</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="StandaloneDADG.get_with_args-245"><a href="#StandaloneDADG.get_with_args-245"><span class="linenos">245</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_with_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FunctionArgument</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="StandaloneDADG.get_with_args-246"><a href="#StandaloneDADG.get_with_args-246"><span class="linenos">246</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandaloneDADG.get_with_args-247"><a href="#StandaloneDADG.get_with_args-247"><span class="linenos">247</span></a><span class="sd">        Get the given list of named arguments from the `DAG`, returning an Error if any required argument is not</span>
</span><span id="StandaloneDADG.get_with_args-248"><a href="#StandaloneDADG.get_with_args-248"><span class="linenos">248</span></a><span class="sd">        available.</span>
</span><span id="StandaloneDADG.get_with_args-249"><a href="#StandaloneDADG.get_with_args-249"><span class="linenos">249</span></a><span class="sd">        :param args: list of function arguments, marked with whether they are required</span>
</span><span id="StandaloneDADG.get_with_args-250"><a href="#StandaloneDADG.get_with_args-250"><span class="linenos">250</span></a><span class="sd">        :return: A dictionary mapping argument name to retrieved value.</span>
</span><span id="StandaloneDADG.get_with_args-251"><a href="#StandaloneDADG.get_with_args-251"><span class="linenos">251</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="StandaloneDADG.get_with_args-252"><a href="#StandaloneDADG.get_with_args-252"><span class="linenos">252</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="StandaloneDADG.get_with_args-253"><a href="#StandaloneDADG.get_with_args-253"><span class="linenos">253</span></a>        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
</span><span id="StandaloneDADG.get_with_args-254"><a href="#StandaloneDADG.get_with_args-254"><span class="linenos">254</span></a>            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="StandaloneDADG.get_with_args-255"><a href="#StandaloneDADG.get_with_args-255"><span class="linenos">255</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="StandaloneDADG.get_with_args-256"><a href="#StandaloneDADG.get_with_args-256"><span class="linenos">256</span></a>                <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
</span><span id="StandaloneDADG.get_with_args-257"><a href="#StandaloneDADG.get_with_args-257"><span class="linenos">257</span></a>                    <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting argument </span><span class="si">{</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: &#39;</span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="StandaloneDADG.get_with_args-258"><a href="#StandaloneDADG.get_with_args-258"><span class="linenos">258</span></a>                <span class="k">continue</span>
</span><span id="StandaloneDADG.get_with_args-259"><a href="#StandaloneDADG.get_with_args-259"><span class="linenos">259</span></a>            <span class="n">ret</span><span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="StandaloneDADG.get_with_args-260"><a href="#StandaloneDADG.get_with_args-260"><span class="linenos">260</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span></pre></div>


            <div class="docstring"><p>Get the given list of named arguments from the <code>DAG</code>, returning an Error if any required argument is not
available.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>args</strong>:  list of function arguments, marked with whether they are required</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A dictionary mapping argument name to retrieved value.</p>
</blockquote>
</div>


                            </div>
                            <div id="StandaloneDADG.render" class="classattr">
                                        <input id="StandaloneDADG.render-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">render</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="StandaloneDADG.render-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StandaloneDADG.render"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="StandaloneDADG.render-262"><a href="#StandaloneDADG.render-262"><span class="linenos">262</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="StandaloneDADG.render-263"><a href="#StandaloneDADG.render-263"><span class="linenos">263</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">graphviz</span>
</span><span id="StandaloneDADG.render-264"><a href="#StandaloneDADG.render-264"><span class="linenos">264</span></a>        <span class="n">g</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Digraph</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>
</span><span id="StandaloneDADG.render-265"><a href="#StandaloneDADG.render-265"><span class="linenos">265</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">updater</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="StandaloneDADG.render-266"><a href="#StandaloneDADG.render-266"><span class="linenos">266</span></a>            <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="n">updater</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
</span><span id="StandaloneDADG.render-267"><a href="#StandaloneDADG.render-267"><span class="linenos">267</span></a>                <span class="n">g</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="p">,</span> <span class="n">dependency</span><span class="o">.</span><span class="n">depended</span><span class="p">)</span>
</span><span id="StandaloneDADG.render-268"><a href="#StandaloneDADG.render-268"><span class="linenos">268</span></a>        <span class="n">g</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="ChildDADG">
                            <input id="ChildDADG-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ChildDADG</span><wbr>(<span class="base"><a href="#ChildDirectedAcyclicDataGraph">reg23_experiments.ops.data_manager.ChildDirectedAcyclicDataGraph</a></span>):

                <label class="view-source-button" for="ChildDADG-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChildDADG"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChildDADG-20"><a href="#ChildDADG-20"><span class="linenos"> 20</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ChildDADG</span><span class="p">(</span><span class="n">ChildDirectedAcyclicDataGraph</span><span class="p">):</span>
</span><span id="ChildDADG-21"><a href="#ChildDADG-21"><span class="linenos"> 21</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">DirectedAcyclicDataGraph</span><span class="p">):</span>
</span><span id="ChildDADG-22"><a href="#ChildDADG-22"><span class="linenos"> 22</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__parent</span> <span class="o">=</span> <span class="n">parent</span>  <span class="c1"># strong reference to parent, so parent stays alive as long as there are children</span>
</span><span id="ChildDADG-23"><a href="#ChildDADG-23"><span class="linenos"> 23</span></a>        <span class="c1"># parent holds weak reference to this, which will automatically be removed from the WeakSet when this is</span>
</span><span id="ChildDADG-24"><a href="#ChildDADG-24"><span class="linenos"> 24</span></a>        <span class="c1"># destroyed</span>
</span><span id="ChildDADG-25"><a href="#ChildDADG-25"><span class="linenos"> 25</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__parent</span><span class="o">.</span><span class="n">_add_child</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="ChildDADG-26"><a href="#ChildDADG-26"><span class="linenos"> 26</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__nodes_inheriting</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__parent</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="ChildDADG-27"><a href="#ChildDADG-27"><span class="linenos"> 27</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Node</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="ChildDADG-28"><a href="#ChildDADG-28"><span class="linenos"> 28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Updater</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__parent</span><span class="o">.</span><span class="n">_updaters</span><span class="p">)</span>
</span><span id="ChildDADG-29"><a href="#ChildDADG-29"><span class="linenos"> 29</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__in_top_level_call</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="ChildDADG-30"><a href="#ChildDADG-30"><span class="linenos"> 30</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__children</span><span class="p">:</span> <span class="n">weakref</span><span class="o">.</span><span class="n">WeakSet</span><span class="p">[</span>
</span><span id="ChildDADG-31"><a href="#ChildDADG-31"><span class="linenos"> 31</span></a>            <span class="n">ChildDirectedAcyclicDataGraph</span><span class="p">]</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">WeakSet</span><span class="p">()</span>  <span class="c1"># children add themselves, and will be automatically</span>
</span><span id="ChildDADG-32"><a href="#ChildDADG-32"><span class="linenos"> 32</span></a>        <span class="c1"># removed on destruction</span>
</span><span id="ChildDADG-33"><a href="#ChildDADG-33"><span class="linenos"> 33</span></a>
</span><span id="ChildDADG-34"><a href="#ChildDADG-34"><span class="linenos"> 34</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="ChildDADG-35"><a href="#ChildDADG-35"><span class="linenos"> 35</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="s2">&quot;ChildDADG(</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="ChildDADG-36"><a href="#ChildDADG-36"><span class="linenos"> 36</span></a>        <span class="n">ret</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">My nodes:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="ChildDADG-37"><a href="#ChildDADG-37"><span class="linenos"> 37</span></a>        <span class="k">for</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ChildDADG-38"><a href="#ChildDADG-38"><span class="linenos"> 38</span></a>            <span class="n">ret</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="ChildDADG-39"><a href="#ChildDADG-39"><span class="linenos"> 39</span></a>        <span class="n">ret</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Parent nodes I am still using:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="ChildDADG-40"><a href="#ChildDADG-40"><span class="linenos"> 40</span></a>        <span class="k">for</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__parent</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ChildDADG-41"><a href="#ChildDADG-41"><span class="linenos"> 41</span></a>            <span class="k">if</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span> <span class="ow">or</span> <span class="n">node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes_inheriting</span><span class="p">:</span>
</span><span id="ChildDADG-42"><a href="#ChildDADG-42"><span class="linenos"> 42</span></a>                <span class="k">continue</span>
</span><span id="ChildDADG-43"><a href="#ChildDADG-43"><span class="linenos"> 43</span></a>            <span class="n">ret</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="ChildDADG-44"><a href="#ChildDADG-44"><span class="linenos"> 44</span></a>        <span class="n">ret</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Updaters:</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="ChildDADG-45"><a href="#ChildDADG-45"><span class="linenos"> 45</span></a>        <span class="k">for</span> <span class="n">updater_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ChildDADG-46"><a href="#ChildDADG-46"><span class="linenos"> 46</span></a>            <span class="n">ret</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="ChildDADG-47"><a href="#ChildDADG-47"><span class="linenos"> 47</span></a>        <span class="n">ret</span> <span class="o">+=</span> <span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="ChildDADG-48"><a href="#ChildDADG-48"><span class="linenos"> 48</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span><span id="ChildDADG-49"><a href="#ChildDADG-49"><span class="linenos"> 49</span></a>
</span><span id="ChildDADG-50"><a href="#ChildDADG-50"><span class="linenos"> 50</span></a>    <span class="nd">@staticmethod</span>
</span><span id="ChildDADG-51"><a href="#ChildDADG-51"><span class="linenos"> 51</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__data_mutating</span><span class="p">(</span><span class="n">function</span><span class="p">):</span>
</span><span id="ChildDADG-52"><a href="#ChildDADG-52"><span class="linenos"> 52</span></a>        <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
</span><span id="ChildDADG-53"><a href="#ChildDADG-53"><span class="linenos"> 53</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ChildDADG-54"><a href="#ChildDADG-54"><span class="linenos"> 54</span></a>            <span class="n">this_is_top_level_call</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__in_top_level_call</span>
</span><span id="ChildDADG-55"><a href="#ChildDADG-55"><span class="linenos"> 55</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__in_top_level_call</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ChildDADG-56"><a href="#ChildDADG-56"><span class="linenos"> 56</span></a>            <span class="n">ret</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ChildDADG-57"><a href="#ChildDADG-57"><span class="linenos"> 57</span></a>            <span class="k">if</span> <span class="n">this_is_top_level_call</span><span class="p">:</span>
</span><span id="ChildDADG-58"><a href="#ChildDADG-58"><span class="linenos"> 58</span></a>                <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__clean_graph</span><span class="p">()</span>
</span><span id="ChildDADG-59"><a href="#ChildDADG-59"><span class="linenos"> 59</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="ChildDADG-60"><a href="#ChildDADG-60"><span class="linenos"> 60</span></a>                    <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error cleaning graph after call to data mutating function: </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-61"><a href="#ChildDADG-61"><span class="linenos"> 61</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__in_top_level_call</span> <span class="o">=</span> <span class="n">this_is_top_level_call</span>
</span><span id="ChildDADG-62"><a href="#ChildDADG-62"><span class="linenos"> 62</span></a>            <span class="k">return</span> <span class="n">ret</span>
</span><span id="ChildDADG-63"><a href="#ChildDADG-63"><span class="linenos"> 63</span></a>
</span><span id="ChildDADG-64"><a href="#ChildDADG-64"><span class="linenos"> 64</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="ChildDADG-65"><a href="#ChildDADG-65"><span class="linenos"> 65</span></a>
</span><span id="ChildDADG-66"><a href="#ChildDADG-66"><span class="linenos"> 66</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="ChildDADG-67"><a href="#ChildDADG-67"><span class="linenos"> 67</span></a>        <span class="k">return</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span> <span class="ow">or</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes_inheriting</span>
</span><span id="ChildDADG-68"><a href="#ChildDADG-68"><span class="linenos"> 68</span></a>
</span><span id="ChildDADG-69"><a href="#ChildDADG-69"><span class="linenos"> 69</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="ChildDADG-70"><a href="#ChildDADG-70"><span class="linenos"> 70</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">soft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG-71"><a href="#ChildDADG-71"><span class="linenos"> 71</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChildDADG-72"><a href="#ChildDADG-72"><span class="linenos"> 72</span></a><span class="sd">        Get the data associated with the named node. Will lazily re-calculate the value if previously made dirty by</span>
</span><span id="ChildDADG-73"><a href="#ChildDADG-73"><span class="linenos"> 73</span></a><span class="sd">        changes to other values.</span>
</span><span id="ChildDADG-74"><a href="#ChildDADG-74"><span class="linenos"> 74</span></a><span class="sd">        :param node_name: The name of the node.</span>
</span><span id="ChildDADG-75"><a href="#ChildDADG-75"><span class="linenos"> 75</span></a><span class="sd">        :param soft: [Optional; default=False] Whether to return an Error if there is not enough data to clean the node.</span>
</span><span id="ChildDADG-76"><a href="#ChildDADG-76"><span class="linenos"> 76</span></a><span class="sd">        :return: The data associated with the name node, or an instance of `Error` on failure.</span>
</span><span id="ChildDADG-77"><a href="#ChildDADG-77"><span class="linenos"> 77</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChildDADG-78"><a href="#ChildDADG-78"><span class="linenos"> 78</span></a>        <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__clean_node</span><span class="p">(</span><span class="n">node_name</span><span class="p">,</span> <span class="n">soft</span><span class="o">=</span><span class="n">soft</span><span class="p">)</span>
</span><span id="ChildDADG-79"><a href="#ChildDADG-79"><span class="linenos"> 79</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="ChildDADG-80"><a href="#ChildDADG-80"><span class="linenos"> 80</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error cleaning node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; before &#39;get&#39;: </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-81"><a href="#ChildDADG-81"><span class="linenos"> 81</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
</span><span id="ChildDADG-82"><a href="#ChildDADG-82"><span class="linenos"> 82</span></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">NoNodeData</span><span class="p">:</span>
</span><span id="ChildDADG-83"><a href="#ChildDADG-83"><span class="linenos"> 83</span></a>            <span class="k">if</span> <span class="n">soft</span><span class="p">:</span>
</span><span id="ChildDADG-84"><a href="#ChildDADG-84"><span class="linenos"> 84</span></a>                <span class="k">return</span> <span class="n">NoNodeData</span>
</span><span id="ChildDADG-85"><a href="#ChildDADG-85"><span class="linenos"> 85</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No data stored for node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; in graph.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-86"><a href="#ChildDADG-86"><span class="linenos"> 86</span></a>        <span class="k">return</span> <span class="n">data</span>
</span><span id="ChildDADG-87"><a href="#ChildDADG-87"><span class="linenos"> 87</span></a>
</span><span id="ChildDADG-88"><a href="#ChildDADG-88"><span class="linenos"> 88</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="ChildDADG-89"><a href="#ChildDADG-89"><span class="linenos"> 89</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">check_equality</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG-90"><a href="#ChildDADG-90"><span class="linenos"> 90</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChildDADG-91"><a href="#ChildDADG-91"><span class="linenos"> 91</span></a><span class="sd">        Set the data associated with a named node. Will create the node if it doesn&#39;t exist.</span>
</span><span id="ChildDADG-92"><a href="#ChildDADG-92"><span class="linenos"> 92</span></a><span class="sd">        :param node_name: Name of the node.</span>
</span><span id="ChildDADG-93"><a href="#ChildDADG-93"><span class="linenos"> 93</span></a><span class="sd">        :param data: New data to assign.</span>
</span><span id="ChildDADG-94"><a href="#ChildDADG-94"><span class="linenos"> 94</span></a><span class="sd">        :param check_equality: [Optional; default=False] Whether to check the new value against the old value,</span>
</span><span id="ChildDADG-95"><a href="#ChildDADG-95"><span class="linenos"> 95</span></a><span class="sd">        and leave the node clean if the new value is the same.</span>
</span><span id="ChildDADG-96"><a href="#ChildDADG-96"><span class="linenos"> 96</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChildDADG-97"><a href="#ChildDADG-97"><span class="linenos"> 97</span></a>        <span class="c1"># make sure node exists</span>
</span><span id="ChildDADG-98"><a href="#ChildDADG-98"><span class="linenos"> 98</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG-99"><a href="#ChildDADG-99"><span class="linenos"> 99</span></a>        <span class="c1"># set the data and make not dirty</span>
</span><span id="ChildDADG-100"><a href="#ChildDADG-100"><span class="linenos">100</span></a>        <span class="k">if</span> <span class="n">check_equality</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="n">data</span><span class="p">:</span>
</span><span id="ChildDADG-101"><a href="#ChildDADG-101"><span class="linenos">101</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG-102"><a href="#ChildDADG-102"><span class="linenos">102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG-103"><a href="#ChildDADG-103"><span class="linenos">103</span></a>        <span class="k">if</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG-104"><a href="#ChildDADG-104"><span class="linenos">104</span></a>            <span class="c1"># this node is already in the child, so we can just mutate it</span>
</span><span id="ChildDADG-105"><a href="#ChildDADG-105"><span class="linenos">105</span></a>            <span class="n">node</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="ChildDADG-106"><a href="#ChildDADG-106"><span class="linenos">106</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ChildDADG-107"><a href="#ChildDADG-107"><span class="linenos">107</span></a>            <span class="c1"># this is a parent node, so now we copy this node to the child so that we can mutate it</span>
</span><span id="ChildDADG-108"><a href="#ChildDADG-108"><span class="linenos">108</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">copy_with_new_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="ChildDADG-109"><a href="#ChildDADG-109"><span class="linenos">109</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span>
</span><span id="ChildDADG-110"><a href="#ChildDADG-110"><span class="linenos">110</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">dirty</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ChildDADG-111"><a href="#ChildDADG-111"><span class="linenos">111</span></a>        <span class="c1"># call the node&#39;s observer callbacks</span>
</span><span id="ChildDADG-112"><a href="#ChildDADG-112"><span class="linenos">112</span></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">observers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ChildDADG-113"><a href="#ChildDADG-113"><span class="linenos">113</span></a>            <span class="n">err</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="ChildDADG-114"><a href="#ChildDADG-114"><span class="linenos">114</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="ChildDADG-115"><a href="#ChildDADG-115"><span class="linenos">115</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Observer callback returned error: </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-116"><a href="#ChildDADG-116"><span class="linenos">116</span></a>        <span class="c1"># make all dependents dirty</span>
</span><span id="ChildDADG-117"><a href="#ChildDADG-117"><span class="linenos">117</span></a>        <span class="k">for</span> <span class="n">dependent</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">dependents</span><span class="p">:</span>
</span><span id="ChildDADG-118"><a href="#ChildDADG-118"><span class="linenos">118</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__set_dirty</span><span class="p">(</span><span class="n">dependent</span><span class="p">)</span>
</span><span id="ChildDADG-119"><a href="#ChildDADG-119"><span class="linenos">119</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG-120"><a href="#ChildDADG-120"><span class="linenos">120</span></a>
</span><span id="ChildDADG-121"><a href="#ChildDADG-121"><span class="linenos">121</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="ChildDADG-122"><a href="#ChildDADG-122"><span class="linenos">122</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG-123"><a href="#ChildDADG-123"><span class="linenos">123</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChildDADG-124"><a href="#ChildDADG-124"><span class="linenos">124</span></a><span class="sd">        Set the data associated with multiple named nodes. Will create the node if it doesn&#39;t exist.</span>
</span><span id="ChildDADG-125"><a href="#ChildDADG-125"><span class="linenos">125</span></a><span class="sd">        Each keyword argument `name=value` will set the data `value` for the node `name`.</span>
</span><span id="ChildDADG-126"><a href="#ChildDADG-126"><span class="linenos">126</span></a><span class="sd">        :return: Nothing on success; an `Error` on failure.</span>
</span><span id="ChildDADG-127"><a href="#ChildDADG-127"><span class="linenos">127</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChildDADG-128"><a href="#ChildDADG-128"><span class="linenos">128</span></a>        <span class="k">for</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ChildDADG-129"><a href="#ChildDADG-129"><span class="linenos">129</span></a>            <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">node_name</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="ChildDADG-130"><a href="#ChildDADG-130"><span class="linenos">130</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="ChildDADG-131"><a href="#ChildDADG-131"><span class="linenos">131</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error setting multiple data; specifically for &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-132"><a href="#ChildDADG-132"><span class="linenos">132</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG-133"><a href="#ChildDADG-133"><span class="linenos">133</span></a>
</span><span id="ChildDADG-134"><a href="#ChildDADG-134"><span class="linenos">134</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="ChildDADG-135"><a href="#ChildDADG-135"><span class="linenos">135</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_evaluation_laziness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">lazily_evaluated</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG-136"><a href="#ChildDADG-136"><span class="linenos">136</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChildDADG-137"><a href="#ChildDADG-137"><span class="linenos">137</span></a><span class="sd">        Set whether the named node will be evaluated lazily. Nodes will be evaluated lazily by default. A node that is</span>
</span><span id="ChildDADG-138"><a href="#ChildDADG-138"><span class="linenos">138</span></a><span class="sd">        not evaluated lazily will be re-evaluated if dirty and the required data exists, every time data in the graph</span>
</span><span id="ChildDADG-139"><a href="#ChildDADG-139"><span class="linenos">139</span></a><span class="sd">        changes.</span>
</span><span id="ChildDADG-140"><a href="#ChildDADG-140"><span class="linenos">140</span></a><span class="sd">        :param node_name: The name of the node to modify</span>
</span><span id="ChildDADG-141"><a href="#ChildDADG-141"><span class="linenos">141</span></a><span class="sd">        :param lazily_evaluated: Whether the named node should be evaluated lazily</span>
</span><span id="ChildDADG-142"><a href="#ChildDADG-142"><span class="linenos">142</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChildDADG-143"><a href="#ChildDADG-143"><span class="linenos">143</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG-144"><a href="#ChildDADG-144"><span class="linenos">144</span></a>        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG-145"><a href="#ChildDADG-145"><span class="linenos">145</span></a>            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">lazily_evaluated</span> <span class="o">==</span> <span class="n">lazily_evaluated</span><span class="p">:</span>
</span><span id="ChildDADG-146"><a href="#ChildDADG-146"><span class="linenos">146</span></a>                <span class="k">return</span>
</span><span id="ChildDADG-147"><a href="#ChildDADG-147"><span class="linenos">147</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG-148"><a href="#ChildDADG-148"><span class="linenos">148</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG-149"><a href="#ChildDADG-149"><span class="linenos">149</span></a>        <span class="k">if</span> <span class="n">node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG-150"><a href="#ChildDADG-150"><span class="linenos">150</span></a>            <span class="c1"># This is a parent node, so we copy in order to mutate</span>
</span><span id="ChildDADG-151"><a href="#ChildDADG-151"><span class="linenos">151</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ChildDADG-152"><a href="#ChildDADG-152"><span class="linenos">152</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span>
</span><span id="ChildDADG-153"><a href="#ChildDADG-153"><span class="linenos">153</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">lazily_evaluated</span> <span class="o">=</span> <span class="n">lazily_evaluated</span>
</span><span id="ChildDADG-154"><a href="#ChildDADG-154"><span class="linenos">154</span></a>
</span><span id="ChildDADG-155"><a href="#ChildDADG-155"><span class="linenos">155</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">observe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG-156"><a href="#ChildDADG-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChildDADG-157"><a href="#ChildDADG-157"><span class="linenos">157</span></a><span class="sd">        Add a callback function to a node that will be called whenever the node&#39;s data changes.</span>
</span><span id="ChildDADG-158"><a href="#ChildDADG-158"><span class="linenos">158</span></a><span class="sd">        :param node_name:</span>
</span><span id="ChildDADG-159"><a href="#ChildDADG-159"><span class="linenos">159</span></a><span class="sd">        :param observer_name:</span>
</span><span id="ChildDADG-160"><a href="#ChildDADG-160"><span class="linenos">160</span></a><span class="sd">        :param callback:</span>
</span><span id="ChildDADG-161"><a href="#ChildDADG-161"><span class="linenos">161</span></a><span class="sd">        :return:</span>
</span><span id="ChildDADG-162"><a href="#ChildDADG-162"><span class="linenos">162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChildDADG-163"><a href="#ChildDADG-163"><span class="linenos">163</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG-164"><a href="#ChildDADG-164"><span class="linenos">164</span></a>        <span class="k">if</span> <span class="n">node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG-165"><a href="#ChildDADG-165"><span class="linenos">165</span></a>            <span class="c1"># This is a parent node, so we copy in order to mutate</span>
</span><span id="ChildDADG-166"><a href="#ChildDADG-166"><span class="linenos">166</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ChildDADG-167"><a href="#ChildDADG-167"><span class="linenos">167</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span>
</span><span id="ChildDADG-168"><a href="#ChildDADG-168"><span class="linenos">168</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">observers</span><span class="p">[</span><span class="n">observer_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
</span><span id="ChildDADG-169"><a href="#ChildDADG-169"><span class="linenos">169</span></a>
</span><span id="ChildDADG-170"><a href="#ChildDADG-170"><span class="linenos">170</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_observer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG-171"><a href="#ChildDADG-171"><span class="linenos">171</span></a>        <span class="n">node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG-172"><a href="#ChildDADG-172"><span class="linenos">172</span></a>        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG-173"><a href="#ChildDADG-173"><span class="linenos">173</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No node named &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; from which to remove callback.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-174"><a href="#ChildDADG-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG-175"><a href="#ChildDADG-175"><span class="linenos">175</span></a>        <span class="k">if</span> <span class="n">observer_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">observers</span><span class="p">:</span>
</span><span id="ChildDADG-176"><a href="#ChildDADG-176"><span class="linenos">176</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No observer named &#39;</span><span class="si">{</span><span class="n">observer_name</span><span class="si">}</span><span class="s2">&#39; in node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-177"><a href="#ChildDADG-177"><span class="linenos">177</span></a>        <span class="k">if</span> <span class="n">node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG-178"><a href="#ChildDADG-178"><span class="linenos">178</span></a>            <span class="c1"># This is a parent node, so we copy in order to mutate</span>
</span><span id="ChildDADG-179"><a href="#ChildDADG-179"><span class="linenos">179</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ChildDADG-180"><a href="#ChildDADG-180"><span class="linenos">180</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span>
</span><span id="ChildDADG-181"><a href="#ChildDADG-181"><span class="linenos">181</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">observers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">observer_name</span><span class="p">)</span>
</span><span id="ChildDADG-182"><a href="#ChildDADG-182"><span class="linenos">182</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG-183"><a href="#ChildDADG-183"><span class="linenos">183</span></a>
</span><span id="ChildDADG-184"><a href="#ChildDADG-184"><span class="linenos">184</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="ChildDADG-185"><a href="#ChildDADG-185"><span class="linenos">185</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_updater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">updater</span><span class="p">:</span> <span class="n">Updater</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG-186"><a href="#ChildDADG-186"><span class="linenos">186</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChildDADG-187"><a href="#ChildDADG-187"><span class="linenos">187</span></a><span class="sd">        Add a new updater object to the DAG. Each node may only be updated by a single updater, or no updater.</span>
</span><span id="ChildDADG-188"><a href="#ChildDADG-188"><span class="linenos">188</span></a><span class="sd">        :param updater_name: A human-readable name to assign to the added updater.</span>
</span><span id="ChildDADG-189"><a href="#ChildDADG-189"><span class="linenos">189</span></a><span class="sd">        :param updater: The updater object. Can be created from a function using the `dag_updater` decorator.</span>
</span><span id="ChildDADG-190"><a href="#ChildDADG-190"><span class="linenos">190</span></a><span class="sd">        :return: None, or an `Error` object on failure.</span>
</span><span id="ChildDADG-191"><a href="#ChildDADG-191"><span class="linenos">191</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChildDADG-192"><a href="#ChildDADG-192"><span class="linenos">192</span></a>        <span class="c1"># insert the new updater, checking that there isn&#39;t already one of the same name</span>
</span><span id="ChildDADG-193"><a href="#ChildDADG-193"><span class="linenos">193</span></a>        <span class="k">if</span> <span class="n">updater_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">:</span>
</span><span id="ChildDADG-194"><a href="#ChildDADG-194"><span class="linenos">194</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updater named &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39; already exists in graph.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-195"><a href="#ChildDADG-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">[</span><span class="n">updater_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">updater</span>
</span><span id="ChildDADG-196"><a href="#ChildDADG-196"><span class="linenos">196</span></a>        <span class="c1"># set the updater names for updated nodes</span>
</span><span id="ChildDADG-197"><a href="#ChildDADG-197"><span class="linenos">197</span></a>        <span class="k">for</span> <span class="n">updated</span> <span class="ow">in</span> <span class="n">updater</span><span class="o">.</span><span class="n">returned</span><span class="p">:</span>
</span><span id="ChildDADG-198"><a href="#ChildDADG-198"><span class="linenos">198</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">updated</span><span class="p">)</span>
</span><span id="ChildDADG-199"><a href="#ChildDADG-199"><span class="linenos">199</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">updated</span><span class="p">)</span>
</span><span id="ChildDADG-200"><a href="#ChildDADG-200"><span class="linenos">200</span></a>            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">updater</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG-201"><a href="#ChildDADG-201"><span class="linenos">201</span></a>                <span class="k">if</span> <span class="n">updated</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG-202"><a href="#ChildDADG-202"><span class="linenos">202</span></a>                    <span class="c1"># This is a parent node, so we copy in order to mutate</span>
</span><span id="ChildDADG-203"><a href="#ChildDADG-203"><span class="linenos">203</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">updated</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ChildDADG-204"><a href="#ChildDADG-204"><span class="linenos">204</span></a>                    <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">updated</span><span class="p">]</span>
</span><span id="ChildDADG-205"><a href="#ChildDADG-205"><span class="linenos">205</span></a>                <span class="n">node</span><span class="o">.</span><span class="n">updater</span> <span class="o">=</span> <span class="n">updater_name</span>
</span><span id="ChildDADG-206"><a href="#ChildDADG-206"><span class="linenos">206</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ChildDADG-207"><a href="#ChildDADG-207"><span class="linenos">207</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="n">updated</span><span class="si">}</span><span class="s2"> is already updated by </span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">updater</span><span class="si">}</span><span class="s2">; tried to add updater &quot;</span>
</span><span id="ChildDADG-208"><a href="#ChildDADG-208"><span class="linenos">208</span></a>                             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2"> which wants to update the same node.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-209"><a href="#ChildDADG-209"><span class="linenos">209</span></a>        <span class="c1"># add dependencies now that updated nodes have assigned updaters</span>
</span><span id="ChildDADG-210"><a href="#ChildDADG-210"><span class="linenos">210</span></a>        <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="n">updater</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
</span><span id="ChildDADG-211"><a href="#ChildDADG-211"><span class="linenos">211</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__add_dependency</span><span class="p">(</span><span class="n">dependency</span><span class="p">)</span>
</span><span id="ChildDADG-212"><a href="#ChildDADG-212"><span class="linenos">212</span></a>        <span class="c1"># check that the graph is not acyclic</span>
</span><span id="ChildDADG-213"><a href="#ChildDADG-213"><span class="linenos">213</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__check_acyclic</span><span class="p">():</span>
</span><span id="ChildDADG-214"><a href="#ChildDADG-214"><span class="linenos">214</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">remove_updater</span><span class="p">(</span><span class="n">updater_name</span><span class="p">)</span>
</span><span id="ChildDADG-215"><a href="#ChildDADG-215"><span class="linenos">215</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to add updater &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39;, as this added cycles to the graph.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-216"><a href="#ChildDADG-216"><span class="linenos">216</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG-217"><a href="#ChildDADG-217"><span class="linenos">217</span></a>
</span><span id="ChildDADG-218"><a href="#ChildDADG-218"><span class="linenos">218</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_updater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG-219"><a href="#ChildDADG-219"><span class="linenos">219</span></a>        <span class="c1"># check updater exists with given updater_name</span>
</span><span id="ChildDADG-220"><a href="#ChildDADG-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="n">updater_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">:</span>
</span><span id="ChildDADG-221"><a href="#ChildDADG-221"><span class="linenos">221</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to remove updater &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39;; it doesn&#39;t exist.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-222"><a href="#ChildDADG-222"><span class="linenos">222</span></a>        <span class="c1"># remove the dependencies</span>
</span><span id="ChildDADG-223"><a href="#ChildDADG-223"><span class="linenos">223</span></a>        <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">[</span><span class="n">updater_name</span><span class="p">]</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
</span><span id="ChildDADG-224"><a href="#ChildDADG-224"><span class="linenos">224</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__remove_dependency</span><span class="p">(</span><span class="n">dependency</span><span class="p">)</span>
</span><span id="ChildDADG-225"><a href="#ChildDADG-225"><span class="linenos">225</span></a>        <span class="c1"># remove the updater names for the updated nodes</span>
</span><span id="ChildDADG-226"><a href="#ChildDADG-226"><span class="linenos">226</span></a>        <span class="k">for</span> <span class="n">updated</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">[</span><span class="n">updater_name</span><span class="p">]</span><span class="o">.</span><span class="n">returned</span><span class="p">:</span>
</span><span id="ChildDADG-227"><a href="#ChildDADG-227"><span class="linenos">227</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">updated</span><span class="p">)</span>
</span><span id="ChildDADG-228"><a href="#ChildDADG-228"><span class="linenos">228</span></a>            <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG-229"><a href="#ChildDADG-229"><span class="linenos">229</span></a>                <span class="k">continue</span>
</span><span id="ChildDADG-230"><a href="#ChildDADG-230"><span class="linenos">230</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">updated</span><span class="p">)</span>
</span><span id="ChildDADG-231"><a href="#ChildDADG-231"><span class="linenos">231</span></a>            <span class="k">if</span> <span class="n">updated</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG-232"><a href="#ChildDADG-232"><span class="linenos">232</span></a>                <span class="c1"># This is a parent node, so we copy in order to mutate</span>
</span><span id="ChildDADG-233"><a href="#ChildDADG-233"><span class="linenos">233</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">updated</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ChildDADG-234"><a href="#ChildDADG-234"><span class="linenos">234</span></a>                <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">updated</span><span class="p">]</span>
</span><span id="ChildDADG-235"><a href="#ChildDADG-235"><span class="linenos">235</span></a>            <span class="n">node</span><span class="o">.</span><span class="n">updater</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ChildDADG-236"><a href="#ChildDADG-236"><span class="linenos">236</span></a>        <span class="c1"># remove the updater</span>
</span><span id="ChildDADG-237"><a href="#ChildDADG-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">updater_name</span><span class="p">)</span>
</span><span id="ChildDADG-238"><a href="#ChildDADG-238"><span class="linenos">238</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG-239"><a href="#ChildDADG-239"><span class="linenos">239</span></a>
</span><span id="ChildDADG-240"><a href="#ChildDADG-240"><span class="linenos">240</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="ChildDADG-241"><a href="#ChildDADG-241"><span class="linenos">241</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_with_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FunctionArgument</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG-242"><a href="#ChildDADG-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChildDADG-243"><a href="#ChildDADG-243"><span class="linenos">243</span></a><span class="sd">        Get the given list of named arguments from the `DAG`, returning an Error if any required argument is not</span>
</span><span id="ChildDADG-244"><a href="#ChildDADG-244"><span class="linenos">244</span></a><span class="sd">        available.</span>
</span><span id="ChildDADG-245"><a href="#ChildDADG-245"><span class="linenos">245</span></a><span class="sd">        :param args: list of function arguments, marked with whether they are required</span>
</span><span id="ChildDADG-246"><a href="#ChildDADG-246"><span class="linenos">246</span></a><span class="sd">        :return: A dictionary mapping argument name to retrieved value.</span>
</span><span id="ChildDADG-247"><a href="#ChildDADG-247"><span class="linenos">247</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChildDADG-248"><a href="#ChildDADG-248"><span class="linenos">248</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ChildDADG-249"><a href="#ChildDADG-249"><span class="linenos">249</span></a>        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
</span><span id="ChildDADG-250"><a href="#ChildDADG-250"><span class="linenos">250</span></a>            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="ChildDADG-251"><a href="#ChildDADG-251"><span class="linenos">251</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="ChildDADG-252"><a href="#ChildDADG-252"><span class="linenos">252</span></a>                <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
</span><span id="ChildDADG-253"><a href="#ChildDADG-253"><span class="linenos">253</span></a>                    <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting argument </span><span class="si">{</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: &#39;</span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-254"><a href="#ChildDADG-254"><span class="linenos">254</span></a>                <span class="k">continue</span>
</span><span id="ChildDADG-255"><a href="#ChildDADG-255"><span class="linenos">255</span></a>            <span class="n">ret</span><span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="ChildDADG-256"><a href="#ChildDADG-256"><span class="linenos">256</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span><span id="ChildDADG-257"><a href="#ChildDADG-257"><span class="linenos">257</span></a>
</span><span id="ChildDADG-258"><a href="#ChildDADG-258"><span class="linenos">258</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG-259"><a href="#ChildDADG-259"><span class="linenos">259</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">graphviz</span>
</span><span id="ChildDADG-260"><a href="#ChildDADG-260"><span class="linenos">260</span></a>        <span class="n">g</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Digraph</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>
</span><span id="ChildDADG-261"><a href="#ChildDADG-261"><span class="linenos">261</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">updater</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ChildDADG-262"><a href="#ChildDADG-262"><span class="linenos">262</span></a>            <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="n">updater</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
</span><span id="ChildDADG-263"><a href="#ChildDADG-263"><span class="linenos">263</span></a>                <span class="n">g</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="p">,</span> <span class="n">dependency</span><span class="o">.</span><span class="n">depended</span><span class="p">)</span>
</span><span id="ChildDADG-264"><a href="#ChildDADG-264"><span class="linenos">264</span></a>        <span class="n">g</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-265"><a href="#ChildDADG-265"><span class="linenos">265</span></a>
</span><span id="ChildDADG-266"><a href="#ChildDADG-266"><span class="linenos">266</span></a>    <span class="c1">##### Protected methods and properties</span>
</span><span id="ChildDADG-267"><a href="#ChildDADG-267"><span class="linenos">267</span></a>
</span><span id="ChildDADG-268"><a href="#ChildDADG-268"><span class="linenos">268</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_node_if_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG-269"><a href="#ChildDADG-269"><span class="linenos">269</span></a>        <span class="k">if</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG-270"><a href="#ChildDADG-270"><span class="linenos">270</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span>
</span><span id="ChildDADG-271"><a href="#ChildDADG-271"><span class="linenos">271</span></a>        <span class="k">if</span> <span class="n">node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes_inheriting</span><span class="p">:</span>
</span><span id="ChildDADG-272"><a href="#ChildDADG-272"><span class="linenos">272</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG-273"><a href="#ChildDADG-273"><span class="linenos">273</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__parent</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG-274"><a href="#ChildDADG-274"><span class="linenos">274</span></a>
</span><span id="ChildDADG-275"><a href="#ChildDADG-275"><span class="linenos">275</span></a>    <span class="nd">@property</span>
</span><span id="ChildDADG-276"><a href="#ChildDADG-276"><span class="linenos">276</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Node</span><span class="p">]:</span>
</span><span id="ChildDADG-277"><a href="#ChildDADG-277"><span class="linenos">277</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span> <span class="o">|</span> <span class="p">{</span>  <span class="c1">#</span>
</span><span id="ChildDADG-278"><a href="#ChildDADG-278"><span class="linenos">278</span></a>            <span class="n">node_name</span><span class="p">:</span> <span class="n">node</span>  <span class="c1">#</span>
</span><span id="ChildDADG-279"><a href="#ChildDADG-279"><span class="linenos">279</span></a>            <span class="k">for</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__parent</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span>
</span><span id="ChildDADG-280"><a href="#ChildDADG-280"><span class="linenos">280</span></a>            <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes_inheriting</span> <span class="ow">and</span> <span class="n">node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span>  <span class="c1">#</span>
</span><span id="ChildDADG-281"><a href="#ChildDADG-281"><span class="linenos">281</span></a>        <span class="p">}</span>
</span><span id="ChildDADG-282"><a href="#ChildDADG-282"><span class="linenos">282</span></a>
</span><span id="ChildDADG-283"><a href="#ChildDADG-283"><span class="linenos">283</span></a>    <span class="nd">@property</span>
</span><span id="ChildDADG-284"><a href="#ChildDADG-284"><span class="linenos">284</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_updaters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Updater</span><span class="p">]:</span>
</span><span id="ChildDADG-285"><a href="#ChildDADG-285"><span class="linenos">285</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span>
</span><span id="ChildDADG-286"><a href="#ChildDADG-286"><span class="linenos">286</span></a>
</span><span id="ChildDADG-287"><a href="#ChildDADG-287"><span class="linenos">287</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_add_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">:</span> <span class="n">ChildDirectedAcyclicDataGraph</span><span class="p">):</span>
</span><span id="ChildDADG-288"><a href="#ChildDADG-288"><span class="linenos">288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__children</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
</span><span id="ChildDADG-289"><a href="#ChildDADG-289"><span class="linenos">289</span></a>
</span><span id="ChildDADG-290"><a href="#ChildDADG-290"><span class="linenos">290</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_make_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG-291"><a href="#ChildDADG-291"><span class="linenos">291</span></a>        <span class="k">if</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span> <span class="ow">or</span> <span class="n">node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes_inheriting</span><span class="p">:</span>
</span><span id="ChildDADG-292"><a href="#ChildDADG-292"><span class="linenos">292</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG-293"><a href="#ChildDADG-293"><span class="linenos">293</span></a>        <span class="n">parent_node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">|</span> <span class="n">Error</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__parent</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG-294"><a href="#ChildDADG-294"><span class="linenos">294</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent_node</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="ChildDADG-295"><a href="#ChildDADG-295"><span class="linenos">295</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not copy node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; to child as it doesn&#39;t exist in the parent.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-296"><a href="#ChildDADG-296"><span class="linenos">296</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">parent_node</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ChildDADG-297"><a href="#ChildDADG-297"><span class="linenos">297</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG-298"><a href="#ChildDADG-298"><span class="linenos">298</span></a>
</span><span id="ChildDADG-299"><a href="#ChildDADG-299"><span class="linenos">299</span></a>    <span class="c1">##### Private methods</span>
</span><span id="ChildDADG-300"><a href="#ChildDADG-300"><span class="linenos">300</span></a>
</span><span id="ChildDADG-301"><a href="#ChildDADG-301"><span class="linenos">301</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__get_node_ensure_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
</span><span id="ChildDADG-302"><a href="#ChildDADG-302"><span class="linenos">302</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG-303"><a href="#ChildDADG-303"><span class="linenos">303</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
</span><span id="ChildDADG-304"><a href="#ChildDADG-304"><span class="linenos">304</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes_inheriting</span><span class="p">:</span>
</span><span id="ChildDADG-305"><a href="#ChildDADG-305"><span class="linenos">305</span></a>            <span class="n">maybe_parent_node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__parent</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="ChildDADG-306"><a href="#ChildDADG-306"><span class="linenos">306</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">maybe_parent_node</span><span class="p">,</span> <span class="n">Node</span><span class="p">):</span>
</span><span id="ChildDADG-307"><a href="#ChildDADG-307"><span class="linenos">307</span></a>                <span class="k">return</span> <span class="n">maybe_parent_node</span>
</span><span id="ChildDADG-308"><a href="#ChildDADG-308"><span class="linenos">308</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">()</span>
</span><span id="ChildDADG-309"><a href="#ChildDADG-309"><span class="linenos">309</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
</span><span id="ChildDADG-310"><a href="#ChildDADG-310"><span class="linenos">310</span></a>
</span><span id="ChildDADG-311"><a href="#ChildDADG-311"><span class="linenos">311</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__set_dirty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG-312"><a href="#ChildDADG-312"><span class="linenos">312</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG-313"><a href="#ChildDADG-313"><span class="linenos">313</span></a>        <span class="n">node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG-314"><a href="#ChildDADG-314"><span class="linenos">314</span></a>        <span class="k">if</span> <span class="n">node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG-315"><a href="#ChildDADG-315"><span class="linenos">315</span></a>            <span class="c1"># This is a parent node, so we copy in order to mutate</span>
</span><span id="ChildDADG-316"><a href="#ChildDADG-316"><span class="linenos">316</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ChildDADG-317"><a href="#ChildDADG-317"><span class="linenos">317</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span>
</span><span id="ChildDADG-318"><a href="#ChildDADG-318"><span class="linenos">318</span></a>        <span class="c1"># make node and all dependents dirty</span>
</span><span id="ChildDADG-319"><a href="#ChildDADG-319"><span class="linenos">319</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">dirty</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="ChildDADG-320"><a href="#ChildDADG-320"><span class="linenos">320</span></a>        <span class="k">for</span> <span class="n">dependent</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">dependents</span><span class="p">:</span>
</span><span id="ChildDADG-321"><a href="#ChildDADG-321"><span class="linenos">321</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__set_dirty</span><span class="p">(</span><span class="n">dependent</span><span class="p">)</span>
</span><span id="ChildDADG-322"><a href="#ChildDADG-322"><span class="linenos">322</span></a>
</span><span id="ChildDADG-323"><a href="#ChildDADG-323"><span class="linenos">323</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__add_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dependency</span><span class="p">:</span> <span class="n">Dependency</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG-324"><a href="#ChildDADG-324"><span class="linenos">324</span></a>        <span class="c1"># make sure both nodes exist</span>
</span><span id="ChildDADG-325"><a href="#ChildDADG-325"><span class="linenos">325</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="p">)</span>
</span><span id="ChildDADG-326"><a href="#ChildDADG-326"><span class="linenos">326</span></a>        <span class="n">depended_node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depended</span><span class="p">)</span>
</span><span id="ChildDADG-327"><a href="#ChildDADG-327"><span class="linenos">327</span></a>        <span class="c1"># make sure depender is in depended&#39;s list of dependents</span>
</span><span id="ChildDADG-328"><a href="#ChildDADG-328"><span class="linenos">328</span></a>        <span class="k">if</span> <span class="n">dependency</span><span class="o">.</span><span class="n">depender</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">depended_node</span><span class="o">.</span><span class="n">dependents</span><span class="p">:</span>
</span><span id="ChildDADG-329"><a href="#ChildDADG-329"><span class="linenos">329</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depended</span><span class="p">)</span>
</span><span id="ChildDADG-330"><a href="#ChildDADG-330"><span class="linenos">330</span></a>            <span class="k">if</span> <span class="n">dependency</span><span class="o">.</span><span class="n">depended</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG-331"><a href="#ChildDADG-331"><span class="linenos">331</span></a>                <span class="c1"># This is a parent node, so we copy in order to mutate</span>
</span><span id="ChildDADG-332"><a href="#ChildDADG-332"><span class="linenos">332</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">dependency</span><span class="o">.</span><span class="n">depended</span><span class="p">]</span> <span class="o">=</span> <span class="n">depended_node</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ChildDADG-333"><a href="#ChildDADG-333"><span class="linenos">333</span></a>                <span class="n">depended_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">dependency</span><span class="o">.</span><span class="n">depended</span><span class="p">]</span>
</span><span id="ChildDADG-334"><a href="#ChildDADG-334"><span class="linenos">334</span></a>            <span class="n">depended_node</span><span class="o">.</span><span class="n">dependents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="p">)</span>
</span><span id="ChildDADG-335"><a href="#ChildDADG-335"><span class="linenos">335</span></a>        <span class="c1"># make depender dirty</span>
</span><span id="ChildDADG-336"><a href="#ChildDADG-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__set_dirty</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="p">)</span>
</span><span id="ChildDADG-337"><a href="#ChildDADG-337"><span class="linenos">337</span></a>
</span><span id="ChildDADG-338"><a href="#ChildDADG-338"><span class="linenos">338</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__remove_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dependency</span><span class="p">:</span> <span class="n">Dependency</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG-339"><a href="#ChildDADG-339"><span class="linenos">339</span></a>        <span class="c1"># check both nodes exist</span>
</span><span id="ChildDADG-340"><a href="#ChildDADG-340"><span class="linenos">340</span></a>        <span class="n">depender_node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="p">)</span>
</span><span id="ChildDADG-341"><a href="#ChildDADG-341"><span class="linenos">341</span></a>        <span class="n">depended_node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depended</span><span class="p">)</span>
</span><span id="ChildDADG-342"><a href="#ChildDADG-342"><span class="linenos">342</span></a>        <span class="k">if</span> <span class="n">depender_node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG-343"><a href="#ChildDADG-343"><span class="linenos">343</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error removing dependency: depender </span><span class="si">{</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="si">}</span><span class="s2"> doesn&#39;t exist.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-344"><a href="#ChildDADG-344"><span class="linenos">344</span></a>        <span class="k">if</span> <span class="n">depended_node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG-345"><a href="#ChildDADG-345"><span class="linenos">345</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error removing dependency: depender </span><span class="si">{</span><span class="n">dependency</span><span class="o">.</span><span class="n">depended</span><span class="si">}</span><span class="s2"> doesn&#39;t exist.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-346"><a href="#ChildDADG-346"><span class="linenos">346</span></a>        <span class="c1"># make sure depender is not in depended&#39;s list of dependents</span>
</span><span id="ChildDADG-347"><a href="#ChildDADG-347"><span class="linenos">347</span></a>        <span class="k">if</span> <span class="n">dependency</span><span class="o">.</span><span class="n">depender</span> <span class="ow">in</span> <span class="n">depended_node</span><span class="o">.</span><span class="n">dependents</span><span class="p">:</span>
</span><span id="ChildDADG-348"><a href="#ChildDADG-348"><span class="linenos">348</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="p">)</span>
</span><span id="ChildDADG-349"><a href="#ChildDADG-349"><span class="linenos">349</span></a>            <span class="k">if</span> <span class="n">dependency</span><span class="o">.</span><span class="n">depended</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG-350"><a href="#ChildDADG-350"><span class="linenos">350</span></a>                <span class="c1"># This is a parent node, so we copy in order to mutate</span>
</span><span id="ChildDADG-351"><a href="#ChildDADG-351"><span class="linenos">351</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">dependency</span><span class="o">.</span><span class="n">depended</span><span class="p">]</span> <span class="o">=</span> <span class="n">depended_node</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ChildDADG-352"><a href="#ChildDADG-352"><span class="linenos">352</span></a>                <span class="n">depended_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">dependency</span><span class="o">.</span><span class="n">depended</span><span class="p">]</span>
</span><span id="ChildDADG-353"><a href="#ChildDADG-353"><span class="linenos">353</span></a>            <span class="n">depended_node</span><span class="o">.</span><span class="n">dependents</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="p">)</span>
</span><span id="ChildDADG-354"><a href="#ChildDADG-354"><span class="linenos">354</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG-355"><a href="#ChildDADG-355"><span class="linenos">355</span></a>
</span><span id="ChildDADG-356"><a href="#ChildDADG-356"><span class="linenos">356</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__run_updater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">soft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG-357"><a href="#ChildDADG-357"><span class="linenos">357</span></a>        <span class="c1"># get the updater object</span>
</span><span id="ChildDADG-358"><a href="#ChildDADG-358"><span class="linenos">358</span></a>        <span class="k">if</span> <span class="n">updater_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">:</span>
</span><span id="ChildDADG-359"><a href="#ChildDADG-359"><span class="linenos">359</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No updater named &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39; in graph.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-360"><a href="#ChildDADG-360"><span class="linenos">360</span></a>        <span class="n">updater</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">[</span><span class="n">updater_name</span><span class="p">]</span>
</span><span id="ChildDADG-361"><a href="#ChildDADG-361"><span class="linenos">361</span></a>        <span class="c1"># get the arguments for the function</span>
</span><span id="ChildDADG-362"><a href="#ChildDADG-362"><span class="linenos">362</span></a>        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_with_args</span><span class="p">(</span><span class="n">updater</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span>
</span><span id="ChildDADG-363"><a href="#ChildDADG-363"><span class="linenos">363</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="ChildDADG-364"><a href="#ChildDADG-364"><span class="linenos">364</span></a>            <span class="k">if</span> <span class="n">soft</span><span class="p">:</span>
</span><span id="ChildDADG-365"><a href="#ChildDADG-365"><span class="linenos">365</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG-366"><a href="#ChildDADG-366"><span class="linenos">366</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to get arguments to run updater &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">kwargs</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-367"><a href="#ChildDADG-367"><span class="linenos">367</span></a>        <span class="c1"># execute the function</span>
</span><span id="ChildDADG-368"><a href="#ChildDADG-368"><span class="linenos">368</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="n">updater</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ChildDADG-369"><a href="#ChildDADG-369"><span class="linenos">369</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="ChildDADG-370"><a href="#ChildDADG-370"><span class="linenos">370</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error running updater function &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-371"><a href="#ChildDADG-371"><span class="linenos">371</span></a>        <span class="c1"># for each promised value, check it exists, and set the data</span>
</span><span id="ChildDADG-372"><a href="#ChildDADG-372"><span class="linenos">372</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="ChildDADG-373"><a href="#ChildDADG-373"><span class="linenos">373</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected data updater function &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39; to return a dictionary.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-374"><a href="#ChildDADG-374"><span class="linenos">374</span></a>        <span class="k">for</span> <span class="n">variable_updated</span> <span class="ow">in</span> <span class="n">updater</span><span class="o">.</span><span class="n">returned</span><span class="p">:</span>
</span><span id="ChildDADG-375"><a href="#ChildDADG-375"><span class="linenos">375</span></a>            <span class="k">if</span> <span class="n">variable_updated</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="ChildDADG-376"><a href="#ChildDADG-376"><span class="linenos">376</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span>
</span><span id="ChildDADG-377"><a href="#ChildDADG-377"><span class="linenos">377</span></a>                    <span class="sa">f</span><span class="s2">&quot;Variable &#39;</span><span class="si">{</span><span class="n">variable_updated</span><span class="si">}</span><span class="s2">&#39; not returned by updater function &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39; which promised &quot;</span>
</span><span id="ChildDADG-378"><a href="#ChildDADG-378"><span class="linenos">378</span></a>                    <span class="sa">f</span><span class="s2">&quot;it.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-379"><a href="#ChildDADG-379"><span class="linenos">379</span></a>            <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">variable_updated</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">variable_updated</span><span class="p">))</span>
</span><span id="ChildDADG-380"><a href="#ChildDADG-380"><span class="linenos">380</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="ChildDADG-381"><a href="#ChildDADG-381"><span class="linenos">381</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error setting value for &#39;</span><span class="si">{</span><span class="n">variable_updated</span><span class="si">}</span><span class="s2">&#39; after running updater &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39;: &quot;</span>
</span><span id="ChildDADG-382"><a href="#ChildDADG-382"><span class="linenos">382</span></a>                             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-383"><a href="#ChildDADG-383"><span class="linenos">383</span></a>        <span class="c1"># check for values returned that weren&#39;t promised</span>
</span><span id="ChildDADG-384"><a href="#ChildDADG-384"><span class="linenos">384</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ChildDADG-385"><a href="#ChildDADG-385"><span class="linenos">385</span></a>            <span class="n">variable_names</span> <span class="o">=</span> <span class="s2">&quot;&#39;, &#39;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="ChildDADG-386"><a href="#ChildDADG-386"><span class="linenos">386</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updater function &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39; returned unexpected variables: &#39;</span><span class="si">{</span><span class="n">variable_names</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-387"><a href="#ChildDADG-387"><span class="linenos">387</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG-388"><a href="#ChildDADG-388"><span class="linenos">388</span></a>
</span><span id="ChildDADG-389"><a href="#ChildDADG-389"><span class="linenos">389</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__clean_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">soft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG-390"><a href="#ChildDADG-390"><span class="linenos">390</span></a>        <span class="n">node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG-391"><a href="#ChildDADG-391"><span class="linenos">391</span></a>        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG-392"><a href="#ChildDADG-392"><span class="linenos">392</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No node named &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; in graph.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-393"><a href="#ChildDADG-393"><span class="linenos">393</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">dirty</span><span class="p">:</span>
</span><span id="ChildDADG-394"><a href="#ChildDADG-394"><span class="linenos">394</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG-395"><a href="#ChildDADG-395"><span class="linenos">395</span></a>        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">updater</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG-396"><a href="#ChildDADG-396"><span class="linenos">396</span></a>            <span class="k">if</span> <span class="n">soft</span><span class="p">:</span>
</span><span id="ChildDADG-397"><a href="#ChildDADG-397"><span class="linenos">397</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG-398"><a href="#ChildDADG-398"><span class="linenos">398</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dirty node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; cannot be cleaned as it has no updater.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-399"><a href="#ChildDADG-399"><span class="linenos">399</span></a>        <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__run_updater</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">updater</span><span class="p">,</span> <span class="n">soft</span><span class="o">=</span><span class="n">soft</span><span class="p">)</span>
</span><span id="ChildDADG-400"><a href="#ChildDADG-400"><span class="linenos">400</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="ChildDADG-401"><a href="#ChildDADG-401"><span class="linenos">401</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to clean dirty node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39;; error running updater &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">updater</span><span class="si">}</span><span class="s2">&#39;: &quot;</span>
</span><span id="ChildDADG-402"><a href="#ChildDADG-402"><span class="linenos">402</span></a>                         <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-403"><a href="#ChildDADG-403"><span class="linenos">403</span></a>        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">dirty</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">soft</span><span class="p">:</span>
</span><span id="ChildDADG-404"><a href="#ChildDADG-404"><span class="linenos">404</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; still dirty after running updater &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">updater</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-405"><a href="#ChildDADG-405"><span class="linenos">405</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG-406"><a href="#ChildDADG-406"><span class="linenos">406</span></a>
</span><span id="ChildDADG-407"><a href="#ChildDADG-407"><span class="linenos">407</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__clean_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG-408"><a href="#ChildDADG-408"><span class="linenos">408</span></a>        <span class="k">for</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ChildDADG-409"><a href="#ChildDADG-409"><span class="linenos">409</span></a>            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">lazily_evaluated</span><span class="p">:</span>
</span><span id="ChildDADG-410"><a href="#ChildDADG-410"><span class="linenos">410</span></a>                <span class="k">continue</span>
</span><span id="ChildDADG-411"><a href="#ChildDADG-411"><span class="linenos">411</span></a>            <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__clean_node</span><span class="p">(</span><span class="n">node_name</span><span class="p">,</span> <span class="n">soft</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ChildDADG-412"><a href="#ChildDADG-412"><span class="linenos">412</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="ChildDADG-413"><a href="#ChildDADG-413"><span class="linenos">413</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Graph clean failed on node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG-414"><a href="#ChildDADG-414"><span class="linenos">414</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG-415"><a href="#ChildDADG-415"><span class="linenos">415</span></a>
</span><span id="ChildDADG-416"><a href="#ChildDADG-416"><span class="linenos">416</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__eval_in_degrees</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="ChildDADG-417"><a href="#ChildDADG-417"><span class="linenos">417</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="p">{</span><span class="n">node_name</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">}</span>
</span><span id="ChildDADG-418"><a href="#ChildDADG-418"><span class="linenos">418</span></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ChildDADG-419"><a href="#ChildDADG-419"><span class="linenos">419</span></a>            <span class="k">for</span> <span class="n">dependent</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">dependents</span><span class="p">:</span>
</span><span id="ChildDADG-420"><a href="#ChildDADG-420"><span class="linenos">420</span></a>                <span class="n">ret</span><span class="p">[</span><span class="n">dependent</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="ChildDADG-421"><a href="#ChildDADG-421"><span class="linenos">421</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span><span id="ChildDADG-422"><a href="#ChildDADG-422"><span class="linenos">422</span></a>
</span><span id="ChildDADG-423"><a href="#ChildDADG-423"><span class="linenos">423</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__check_acyclic</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="ChildDADG-424"><a href="#ChildDADG-424"><span class="linenos">424</span></a>        <span class="n">in_degrees</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__eval_in_degrees</span><span class="p">()</span>
</span><span id="ChildDADG-425"><a href="#ChildDADG-425"><span class="linenos">425</span></a>        <span class="n">q</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">([</span><span class="n">node_name</span> <span class="k">for</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span> <span class="k">if</span> <span class="n">in_degrees</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="ChildDADG-426"><a href="#ChildDADG-426"><span class="linenos">426</span></a>        <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ChildDADG-427"><a href="#ChildDADG-427"><span class="linenos">427</span></a>        <span class="k">while</span> <span class="n">q</span><span class="p">:</span>
</span><span id="ChildDADG-428"><a href="#ChildDADG-428"><span class="linenos">428</span></a>            <span class="n">first</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</span><span id="ChildDADG-429"><a href="#ChildDADG-429"><span class="linenos">429</span></a>            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="ChildDADG-430"><a href="#ChildDADG-430"><span class="linenos">430</span></a>            <span class="k">for</span> <span class="n">dependent</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">first</span><span class="p">)</span><span class="o">.</span><span class="n">dependents</span><span class="p">:</span>
</span><span id="ChildDADG-431"><a href="#ChildDADG-431"><span class="linenos">431</span></a>                <span class="n">in_degrees</span><span class="p">[</span><span class="n">dependent</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="ChildDADG-432"><a href="#ChildDADG-432"><span class="linenos">432</span></a>                <span class="k">if</span> <span class="n">in_degrees</span><span class="p">[</span><span class="n">dependent</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ChildDADG-433"><a href="#ChildDADG-433"><span class="linenos">433</span></a>                    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dependent</span><span class="p">)</span>
</span><span id="ChildDADG-434"><a href="#ChildDADG-434"><span class="linenos">434</span></a>        <span class="k">return</span> <span class="n">count</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">)</span>
</span><span id="ChildDADG-435"><a href="#ChildDADG-435"><span class="linenos">435</span></a>
</span><span id="ChildDADG-436"><a href="#ChildDADG-436"><span class="linenos">436</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__send_children_copies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG-437"><a href="#ChildDADG-437"><span class="linenos">437</span></a>        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__children</span><span class="p">:</span>
</span><span id="ChildDADG-438"><a href="#ChildDADG-438"><span class="linenos">438</span></a>            <span class="n">child</span><span class="o">.</span><span class="n">_make_copy</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Helper class that provides a standard way to create an ABC using
inheritance.</p>
</div>


                            <div id="ChildDADG.__init__" class="classattr">
                                        <input id="ChildDADG.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ChildDADG</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">parent</span><span class="p">:</span> <span class="n"><a href="#DirectedAcyclicDataGraph">DirectedAcyclicDataGraph</a></span></span>)</span>

                <label class="view-source-button" for="ChildDADG.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChildDADG.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChildDADG.__init__-21"><a href="#ChildDADG.__init__-21"><span class="linenos">21</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">DirectedAcyclicDataGraph</span><span class="p">):</span>
</span><span id="ChildDADG.__init__-22"><a href="#ChildDADG.__init__-22"><span class="linenos">22</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__parent</span> <span class="o">=</span> <span class="n">parent</span>  <span class="c1"># strong reference to parent, so parent stays alive as long as there are children</span>
</span><span id="ChildDADG.__init__-23"><a href="#ChildDADG.__init__-23"><span class="linenos">23</span></a>        <span class="c1"># parent holds weak reference to this, which will automatically be removed from the WeakSet when this is</span>
</span><span id="ChildDADG.__init__-24"><a href="#ChildDADG.__init__-24"><span class="linenos">24</span></a>        <span class="c1"># destroyed</span>
</span><span id="ChildDADG.__init__-25"><a href="#ChildDADG.__init__-25"><span class="linenos">25</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__parent</span><span class="o">.</span><span class="n">_add_child</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="ChildDADG.__init__-26"><a href="#ChildDADG.__init__-26"><span class="linenos">26</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__nodes_inheriting</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__parent</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="ChildDADG.__init__-27"><a href="#ChildDADG.__init__-27"><span class="linenos">27</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Node</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="ChildDADG.__init__-28"><a href="#ChildDADG.__init__-28"><span class="linenos">28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Updater</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__parent</span><span class="o">.</span><span class="n">_updaters</span><span class="p">)</span>
</span><span id="ChildDADG.__init__-29"><a href="#ChildDADG.__init__-29"><span class="linenos">29</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__in_top_level_call</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="ChildDADG.__init__-30"><a href="#ChildDADG.__init__-30"><span class="linenos">30</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__children</span><span class="p">:</span> <span class="n">weakref</span><span class="o">.</span><span class="n">WeakSet</span><span class="p">[</span>
</span><span id="ChildDADG.__init__-31"><a href="#ChildDADG.__init__-31"><span class="linenos">31</span></a>            <span class="n">ChildDirectedAcyclicDataGraph</span><span class="p">]</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">WeakSet</span><span class="p">()</span>  <span class="c1"># children add themselves, and will be automatically</span>
</span><span id="ChildDADG.__init__-32"><a href="#ChildDADG.__init__-32"><span class="linenos">32</span></a>        <span class="c1"># removed on destruction</span>
</span></pre></div>


    

                            </div>
                            <div id="ChildDADG.has_node" class="classattr">
                                        <input id="ChildDADG.has_node-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">has_node</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="ChildDADG.has_node-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChildDADG.has_node"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChildDADG.has_node-66"><a href="#ChildDADG.has_node-66"><span class="linenos">66</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">has_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="ChildDADG.has_node-67"><a href="#ChildDADG.has_node-67"><span class="linenos">67</span></a>        <span class="k">return</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span> <span class="ow">or</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes_inheriting</span>
</span></pre></div>


    

                            </div>
                            <div id="ChildDADG.get" class="classattr">
                                        <input id="ChildDADG.get-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">soft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="ChildDADG.get-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChildDADG.get"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChildDADG.get-69"><a href="#ChildDADG.get-69"><span class="linenos">69</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="ChildDADG.get-70"><a href="#ChildDADG.get-70"><span class="linenos">70</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">soft</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG.get-71"><a href="#ChildDADG.get-71"><span class="linenos">71</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChildDADG.get-72"><a href="#ChildDADG.get-72"><span class="linenos">72</span></a><span class="sd">        Get the data associated with the named node. Will lazily re-calculate the value if previously made dirty by</span>
</span><span id="ChildDADG.get-73"><a href="#ChildDADG.get-73"><span class="linenos">73</span></a><span class="sd">        changes to other values.</span>
</span><span id="ChildDADG.get-74"><a href="#ChildDADG.get-74"><span class="linenos">74</span></a><span class="sd">        :param node_name: The name of the node.</span>
</span><span id="ChildDADG.get-75"><a href="#ChildDADG.get-75"><span class="linenos">75</span></a><span class="sd">        :param soft: [Optional; default=False] Whether to return an Error if there is not enough data to clean the node.</span>
</span><span id="ChildDADG.get-76"><a href="#ChildDADG.get-76"><span class="linenos">76</span></a><span class="sd">        :return: The data associated with the name node, or an instance of `Error` on failure.</span>
</span><span id="ChildDADG.get-77"><a href="#ChildDADG.get-77"><span class="linenos">77</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChildDADG.get-78"><a href="#ChildDADG.get-78"><span class="linenos">78</span></a>        <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__clean_node</span><span class="p">(</span><span class="n">node_name</span><span class="p">,</span> <span class="n">soft</span><span class="o">=</span><span class="n">soft</span><span class="p">)</span>
</span><span id="ChildDADG.get-79"><a href="#ChildDADG.get-79"><span class="linenos">79</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="ChildDADG.get-80"><a href="#ChildDADG.get-80"><span class="linenos">80</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error cleaning node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; before &#39;get&#39;: </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG.get-81"><a href="#ChildDADG.get-81"><span class="linenos">81</span></a>        <span class="n">data</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
</span><span id="ChildDADG.get-82"><a href="#ChildDADG.get-82"><span class="linenos">82</span></a>        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">NoNodeData</span><span class="p">:</span>
</span><span id="ChildDADG.get-83"><a href="#ChildDADG.get-83"><span class="linenos">83</span></a>            <span class="k">if</span> <span class="n">soft</span><span class="p">:</span>
</span><span id="ChildDADG.get-84"><a href="#ChildDADG.get-84"><span class="linenos">84</span></a>                <span class="k">return</span> <span class="n">NoNodeData</span>
</span><span id="ChildDADG.get-85"><a href="#ChildDADG.get-85"><span class="linenos">85</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No data stored for node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; in graph.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG.get-86"><a href="#ChildDADG.get-86"><span class="linenos">86</span></a>        <span class="k">return</span> <span class="n">data</span>
</span></pre></div>


            <div class="docstring"><p>Get the data associated with the named node. Will lazily re-calculate the value if previously made dirty by
changes to other values.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>node_name</strong>:  The name of the node.</li>
<li><strong>soft</strong>:  [Optional; default=False] Whether to return an Error if there is not enough data to clean the node.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>The data associated with the name node, or an instance of <code>Error</code> on failure.</p>
</blockquote>
</div>


                            </div>
                            <div id="ChildDADG.set" class="classattr">
                                        <input id="ChildDADG.set-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">data</span><span class="p">:</span> <span class="n">Any</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">check_equality</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="kc">None</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="ChildDADG.set-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChildDADG.set"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChildDADG.set-88"><a href="#ChildDADG.set-88"><span class="linenos"> 88</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="ChildDADG.set-89"><a href="#ChildDADG.set-89"><span class="linenos"> 89</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">check_equality</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG.set-90"><a href="#ChildDADG.set-90"><span class="linenos"> 90</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChildDADG.set-91"><a href="#ChildDADG.set-91"><span class="linenos"> 91</span></a><span class="sd">        Set the data associated with a named node. Will create the node if it doesn&#39;t exist.</span>
</span><span id="ChildDADG.set-92"><a href="#ChildDADG.set-92"><span class="linenos"> 92</span></a><span class="sd">        :param node_name: Name of the node.</span>
</span><span id="ChildDADG.set-93"><a href="#ChildDADG.set-93"><span class="linenos"> 93</span></a><span class="sd">        :param data: New data to assign.</span>
</span><span id="ChildDADG.set-94"><a href="#ChildDADG.set-94"><span class="linenos"> 94</span></a><span class="sd">        :param check_equality: [Optional; default=False] Whether to check the new value against the old value,</span>
</span><span id="ChildDADG.set-95"><a href="#ChildDADG.set-95"><span class="linenos"> 95</span></a><span class="sd">        and leave the node clean if the new value is the same.</span>
</span><span id="ChildDADG.set-96"><a href="#ChildDADG.set-96"><span class="linenos"> 96</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChildDADG.set-97"><a href="#ChildDADG.set-97"><span class="linenos"> 97</span></a>        <span class="c1"># make sure node exists</span>
</span><span id="ChildDADG.set-98"><a href="#ChildDADG.set-98"><span class="linenos"> 98</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG.set-99"><a href="#ChildDADG.set-99"><span class="linenos"> 99</span></a>        <span class="c1"># set the data and make not dirty</span>
</span><span id="ChildDADG.set-100"><a href="#ChildDADG.set-100"><span class="linenos">100</span></a>        <span class="k">if</span> <span class="n">check_equality</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="n">data</span><span class="p">:</span>
</span><span id="ChildDADG.set-101"><a href="#ChildDADG.set-101"><span class="linenos">101</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="ChildDADG.set-102"><a href="#ChildDADG.set-102"><span class="linenos">102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG.set-103"><a href="#ChildDADG.set-103"><span class="linenos">103</span></a>        <span class="k">if</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG.set-104"><a href="#ChildDADG.set-104"><span class="linenos">104</span></a>            <span class="c1"># this node is already in the child, so we can just mutate it</span>
</span><span id="ChildDADG.set-105"><a href="#ChildDADG.set-105"><span class="linenos">105</span></a>            <span class="n">node</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
</span><span id="ChildDADG.set-106"><a href="#ChildDADG.set-106"><span class="linenos">106</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ChildDADG.set-107"><a href="#ChildDADG.set-107"><span class="linenos">107</span></a>            <span class="c1"># this is a parent node, so now we copy this node to the child so that we can mutate it</span>
</span><span id="ChildDADG.set-108"><a href="#ChildDADG.set-108"><span class="linenos">108</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">copy_with_new_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="ChildDADG.set-109"><a href="#ChildDADG.set-109"><span class="linenos">109</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span>
</span><span id="ChildDADG.set-110"><a href="#ChildDADG.set-110"><span class="linenos">110</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">dirty</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ChildDADG.set-111"><a href="#ChildDADG.set-111"><span class="linenos">111</span></a>        <span class="c1"># call the node&#39;s observer callbacks</span>
</span><span id="ChildDADG.set-112"><a href="#ChildDADG.set-112"><span class="linenos">112</span></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">observers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ChildDADG.set-113"><a href="#ChildDADG.set-113"><span class="linenos">113</span></a>            <span class="n">err</span> <span class="o">=</span> <span class="n">callback</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="ChildDADG.set-114"><a href="#ChildDADG.set-114"><span class="linenos">114</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="ChildDADG.set-115"><a href="#ChildDADG.set-115"><span class="linenos">115</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Observer callback returned error: </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG.set-116"><a href="#ChildDADG.set-116"><span class="linenos">116</span></a>        <span class="c1"># make all dependents dirty</span>
</span><span id="ChildDADG.set-117"><a href="#ChildDADG.set-117"><span class="linenos">117</span></a>        <span class="k">for</span> <span class="n">dependent</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">dependents</span><span class="p">:</span>
</span><span id="ChildDADG.set-118"><a href="#ChildDADG.set-118"><span class="linenos">118</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__set_dirty</span><span class="p">(</span><span class="n">dependent</span><span class="p">)</span>
</span><span id="ChildDADG.set-119"><a href="#ChildDADG.set-119"><span class="linenos">119</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Set the data associated with a named node. Will create the node if it doesn't exist.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>node_name</strong>:  Name of the node.</li>
<li><strong>data</strong>:  New data to assign.</li>
<li><strong>check_equality</strong>:  [Optional; default=False] Whether to check the new value against the old value,
and leave the node clean if the new value is the same.</li>
</ul>
</div>


                            </div>
                            <div id="ChildDADG.set_multiple" class="classattr">
                                        <input id="ChildDADG.set_multiple-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_multiple</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="kc">None</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="ChildDADG.set_multiple-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChildDADG.set_multiple"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChildDADG.set_multiple-121"><a href="#ChildDADG.set_multiple-121"><span class="linenos">121</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="ChildDADG.set_multiple-122"><a href="#ChildDADG.set_multiple-122"><span class="linenos">122</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_multiple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG.set_multiple-123"><a href="#ChildDADG.set_multiple-123"><span class="linenos">123</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChildDADG.set_multiple-124"><a href="#ChildDADG.set_multiple-124"><span class="linenos">124</span></a><span class="sd">        Set the data associated with multiple named nodes. Will create the node if it doesn&#39;t exist.</span>
</span><span id="ChildDADG.set_multiple-125"><a href="#ChildDADG.set_multiple-125"><span class="linenos">125</span></a><span class="sd">        Each keyword argument `name=value` will set the data `value` for the node `name`.</span>
</span><span id="ChildDADG.set_multiple-126"><a href="#ChildDADG.set_multiple-126"><span class="linenos">126</span></a><span class="sd">        :return: Nothing on success; an `Error` on failure.</span>
</span><span id="ChildDADG.set_multiple-127"><a href="#ChildDADG.set_multiple-127"><span class="linenos">127</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChildDADG.set_multiple-128"><a href="#ChildDADG.set_multiple-128"><span class="linenos">128</span></a>        <span class="k">for</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ChildDADG.set_multiple-129"><a href="#ChildDADG.set_multiple-129"><span class="linenos">129</span></a>            <span class="n">err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">node_name</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="ChildDADG.set_multiple-130"><a href="#ChildDADG.set_multiple-130"><span class="linenos">130</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="ChildDADG.set_multiple-131"><a href="#ChildDADG.set_multiple-131"><span class="linenos">131</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error setting multiple data; specifically for &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">err</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG.set_multiple-132"><a href="#ChildDADG.set_multiple-132"><span class="linenos">132</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Set the data associated with multiple named nodes. Will create the node if it doesn't exist.
Each keyword argument <code>name=value</code> will set the data <code>value</code> for the node <code>name</code>.</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Nothing on success; an <code>Error</code> on failure.</p>
</blockquote>
</div>


                            </div>
                            <div id="ChildDADG.set_evaluation_laziness" class="classattr">
                                        <input id="ChildDADG.set_evaluation_laziness-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_evaluation_laziness</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">lazily_evaluated</span><span class="p">:</span> <span class="nb">bool</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="ChildDADG.set_evaluation_laziness-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChildDADG.set_evaluation_laziness"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChildDADG.set_evaluation_laziness-134"><a href="#ChildDADG.set_evaluation_laziness-134"><span class="linenos">134</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="ChildDADG.set_evaluation_laziness-135"><a href="#ChildDADG.set_evaluation_laziness-135"><span class="linenos">135</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_evaluation_laziness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">lazily_evaluated</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG.set_evaluation_laziness-136"><a href="#ChildDADG.set_evaluation_laziness-136"><span class="linenos">136</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChildDADG.set_evaluation_laziness-137"><a href="#ChildDADG.set_evaluation_laziness-137"><span class="linenos">137</span></a><span class="sd">        Set whether the named node will be evaluated lazily. Nodes will be evaluated lazily by default. A node that is</span>
</span><span id="ChildDADG.set_evaluation_laziness-138"><a href="#ChildDADG.set_evaluation_laziness-138"><span class="linenos">138</span></a><span class="sd">        not evaluated lazily will be re-evaluated if dirty and the required data exists, every time data in the graph</span>
</span><span id="ChildDADG.set_evaluation_laziness-139"><a href="#ChildDADG.set_evaluation_laziness-139"><span class="linenos">139</span></a><span class="sd">        changes.</span>
</span><span id="ChildDADG.set_evaluation_laziness-140"><a href="#ChildDADG.set_evaluation_laziness-140"><span class="linenos">140</span></a><span class="sd">        :param node_name: The name of the node to modify</span>
</span><span id="ChildDADG.set_evaluation_laziness-141"><a href="#ChildDADG.set_evaluation_laziness-141"><span class="linenos">141</span></a><span class="sd">        :param lazily_evaluated: Whether the named node should be evaluated lazily</span>
</span><span id="ChildDADG.set_evaluation_laziness-142"><a href="#ChildDADG.set_evaluation_laziness-142"><span class="linenos">142</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChildDADG.set_evaluation_laziness-143"><a href="#ChildDADG.set_evaluation_laziness-143"><span class="linenos">143</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG.set_evaluation_laziness-144"><a href="#ChildDADG.set_evaluation_laziness-144"><span class="linenos">144</span></a>        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG.set_evaluation_laziness-145"><a href="#ChildDADG.set_evaluation_laziness-145"><span class="linenos">145</span></a>            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">lazily_evaluated</span> <span class="o">==</span> <span class="n">lazily_evaluated</span><span class="p">:</span>
</span><span id="ChildDADG.set_evaluation_laziness-146"><a href="#ChildDADG.set_evaluation_laziness-146"><span class="linenos">146</span></a>                <span class="k">return</span>
</span><span id="ChildDADG.set_evaluation_laziness-147"><a href="#ChildDADG.set_evaluation_laziness-147"><span class="linenos">147</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG.set_evaluation_laziness-148"><a href="#ChildDADG.set_evaluation_laziness-148"><span class="linenos">148</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG.set_evaluation_laziness-149"><a href="#ChildDADG.set_evaluation_laziness-149"><span class="linenos">149</span></a>        <span class="k">if</span> <span class="n">node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG.set_evaluation_laziness-150"><a href="#ChildDADG.set_evaluation_laziness-150"><span class="linenos">150</span></a>            <span class="c1"># This is a parent node, so we copy in order to mutate</span>
</span><span id="ChildDADG.set_evaluation_laziness-151"><a href="#ChildDADG.set_evaluation_laziness-151"><span class="linenos">151</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ChildDADG.set_evaluation_laziness-152"><a href="#ChildDADG.set_evaluation_laziness-152"><span class="linenos">152</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span>
</span><span id="ChildDADG.set_evaluation_laziness-153"><a href="#ChildDADG.set_evaluation_laziness-153"><span class="linenos">153</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">lazily_evaluated</span> <span class="o">=</span> <span class="n">lazily_evaluated</span>
</span></pre></div>


            <div class="docstring"><p>Set whether the named node will be evaluated lazily. Nodes will be evaluated lazily by default. A node that is
not evaluated lazily will be re-evaluated if dirty and the required data exists, every time data in the graph
changes.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>node_name</strong>:  The name of the node to modify</li>
<li><strong>lazily_evaluated</strong>:  Whether the named node should be evaluated lazily</li>
</ul>
</div>


                            </div>
                            <div id="ChildDADG.observe" class="classattr">
                                        <input id="ChildDADG.observe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">observe</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="ChildDADG.observe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChildDADG.observe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChildDADG.observe-155"><a href="#ChildDADG.observe-155"><span class="linenos">155</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">observe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="kc">None</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG.observe-156"><a href="#ChildDADG.observe-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChildDADG.observe-157"><a href="#ChildDADG.observe-157"><span class="linenos">157</span></a><span class="sd">        Add a callback function to a node that will be called whenever the node&#39;s data changes.</span>
</span><span id="ChildDADG.observe-158"><a href="#ChildDADG.observe-158"><span class="linenos">158</span></a><span class="sd">        :param node_name:</span>
</span><span id="ChildDADG.observe-159"><a href="#ChildDADG.observe-159"><span class="linenos">159</span></a><span class="sd">        :param observer_name:</span>
</span><span id="ChildDADG.observe-160"><a href="#ChildDADG.observe-160"><span class="linenos">160</span></a><span class="sd">        :param callback:</span>
</span><span id="ChildDADG.observe-161"><a href="#ChildDADG.observe-161"><span class="linenos">161</span></a><span class="sd">        :return:</span>
</span><span id="ChildDADG.observe-162"><a href="#ChildDADG.observe-162"><span class="linenos">162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChildDADG.observe-163"><a href="#ChildDADG.observe-163"><span class="linenos">163</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG.observe-164"><a href="#ChildDADG.observe-164"><span class="linenos">164</span></a>        <span class="k">if</span> <span class="n">node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG.observe-165"><a href="#ChildDADG.observe-165"><span class="linenos">165</span></a>            <span class="c1"># This is a parent node, so we copy in order to mutate</span>
</span><span id="ChildDADG.observe-166"><a href="#ChildDADG.observe-166"><span class="linenos">166</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ChildDADG.observe-167"><a href="#ChildDADG.observe-167"><span class="linenos">167</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span>
</span><span id="ChildDADG.observe-168"><a href="#ChildDADG.observe-168"><span class="linenos">168</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">observers</span><span class="p">[</span><span class="n">observer_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
</span></pre></div>


            <div class="docstring"><p>Add a callback function to a node that will be called whenever the node's data changes.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>node_name</strong>: </li>
<li><strong>observer_name</strong>: </li>
<li><strong>callback</strong>: </li>
</ul>

<h6 id="returns">Returns</h6>
</div>


                            </div>
                            <div id="ChildDADG.remove_observer" class="classattr">
                                        <input id="ChildDADG.remove_observer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_observer</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="ChildDADG.remove_observer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChildDADG.remove_observer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChildDADG.remove_observer-170"><a href="#ChildDADG.remove_observer-170"><span class="linenos">170</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_observer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">observer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG.remove_observer-171"><a href="#ChildDADG.remove_observer-171"><span class="linenos">171</span></a>        <span class="n">node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG.remove_observer-172"><a href="#ChildDADG.remove_observer-172"><span class="linenos">172</span></a>        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG.remove_observer-173"><a href="#ChildDADG.remove_observer-173"><span class="linenos">173</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No node named &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39; from which to remove callback.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG.remove_observer-174"><a href="#ChildDADG.remove_observer-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="ChildDADG.remove_observer-175"><a href="#ChildDADG.remove_observer-175"><span class="linenos">175</span></a>        <span class="k">if</span> <span class="n">observer_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">observers</span><span class="p">:</span>
</span><span id="ChildDADG.remove_observer-176"><a href="#ChildDADG.remove_observer-176"><span class="linenos">176</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No observer named &#39;</span><span class="si">{</span><span class="n">observer_name</span><span class="si">}</span><span class="s2">&#39; in node &#39;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG.remove_observer-177"><a href="#ChildDADG.remove_observer-177"><span class="linenos">177</span></a>        <span class="k">if</span> <span class="n">node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG.remove_observer-178"><a href="#ChildDADG.remove_observer-178"><span class="linenos">178</span></a>            <span class="c1"># This is a parent node, so we copy in order to mutate</span>
</span><span id="ChildDADG.remove_observer-179"><a href="#ChildDADG.remove_observer-179"><span class="linenos">179</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ChildDADG.remove_observer-180"><a href="#ChildDADG.remove_observer-180"><span class="linenos">180</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span>
</span><span id="ChildDADG.remove_observer-181"><a href="#ChildDADG.remove_observer-181"><span class="linenos">181</span></a>        <span class="n">node</span><span class="o">.</span><span class="n">observers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">observer_name</span><span class="p">)</span>
</span><span id="ChildDADG.remove_observer-182"><a href="#ChildDADG.remove_observer-182"><span class="linenos">182</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


    

                            </div>
                            <div id="ChildDADG.add_updater" class="classattr">
                                        <input id="ChildDADG.add_updater-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_updater</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">updater</span><span class="p">:</span> <span class="n"><a href="#Updater">Updater</a></span></span><span class="return-annotation">) -> <span class="kc">None</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="ChildDADG.add_updater-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChildDADG.add_updater"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChildDADG.add_updater-184"><a href="#ChildDADG.add_updater-184"><span class="linenos">184</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="ChildDADG.add_updater-185"><a href="#ChildDADG.add_updater-185"><span class="linenos">185</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_updater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">updater</span><span class="p">:</span> <span class="n">Updater</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG.add_updater-186"><a href="#ChildDADG.add_updater-186"><span class="linenos">186</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChildDADG.add_updater-187"><a href="#ChildDADG.add_updater-187"><span class="linenos">187</span></a><span class="sd">        Add a new updater object to the DAG. Each node may only be updated by a single updater, or no updater.</span>
</span><span id="ChildDADG.add_updater-188"><a href="#ChildDADG.add_updater-188"><span class="linenos">188</span></a><span class="sd">        :param updater_name: A human-readable name to assign to the added updater.</span>
</span><span id="ChildDADG.add_updater-189"><a href="#ChildDADG.add_updater-189"><span class="linenos">189</span></a><span class="sd">        :param updater: The updater object. Can be created from a function using the `dag_updater` decorator.</span>
</span><span id="ChildDADG.add_updater-190"><a href="#ChildDADG.add_updater-190"><span class="linenos">190</span></a><span class="sd">        :return: None, or an `Error` object on failure.</span>
</span><span id="ChildDADG.add_updater-191"><a href="#ChildDADG.add_updater-191"><span class="linenos">191</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChildDADG.add_updater-192"><a href="#ChildDADG.add_updater-192"><span class="linenos">192</span></a>        <span class="c1"># insert the new updater, checking that there isn&#39;t already one of the same name</span>
</span><span id="ChildDADG.add_updater-193"><a href="#ChildDADG.add_updater-193"><span class="linenos">193</span></a>        <span class="k">if</span> <span class="n">updater_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">:</span>
</span><span id="ChildDADG.add_updater-194"><a href="#ChildDADG.add_updater-194"><span class="linenos">194</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updater named &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39; already exists in graph.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG.add_updater-195"><a href="#ChildDADG.add_updater-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">[</span><span class="n">updater_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">updater</span>
</span><span id="ChildDADG.add_updater-196"><a href="#ChildDADG.add_updater-196"><span class="linenos">196</span></a>        <span class="c1"># set the updater names for updated nodes</span>
</span><span id="ChildDADG.add_updater-197"><a href="#ChildDADG.add_updater-197"><span class="linenos">197</span></a>        <span class="k">for</span> <span class="n">updated</span> <span class="ow">in</span> <span class="n">updater</span><span class="o">.</span><span class="n">returned</span><span class="p">:</span>
</span><span id="ChildDADG.add_updater-198"><a href="#ChildDADG.add_updater-198"><span class="linenos">198</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">updated</span><span class="p">)</span>
</span><span id="ChildDADG.add_updater-199"><a href="#ChildDADG.add_updater-199"><span class="linenos">199</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_node_ensure_exists</span><span class="p">(</span><span class="n">updated</span><span class="p">)</span>
</span><span id="ChildDADG.add_updater-200"><a href="#ChildDADG.add_updater-200"><span class="linenos">200</span></a>            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">updater</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG.add_updater-201"><a href="#ChildDADG.add_updater-201"><span class="linenos">201</span></a>                <span class="k">if</span> <span class="n">updated</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG.add_updater-202"><a href="#ChildDADG.add_updater-202"><span class="linenos">202</span></a>                    <span class="c1"># This is a parent node, so we copy in order to mutate</span>
</span><span id="ChildDADG.add_updater-203"><a href="#ChildDADG.add_updater-203"><span class="linenos">203</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">updated</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ChildDADG.add_updater-204"><a href="#ChildDADG.add_updater-204"><span class="linenos">204</span></a>                    <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">updated</span><span class="p">]</span>
</span><span id="ChildDADG.add_updater-205"><a href="#ChildDADG.add_updater-205"><span class="linenos">205</span></a>                <span class="n">node</span><span class="o">.</span><span class="n">updater</span> <span class="o">=</span> <span class="n">updater_name</span>
</span><span id="ChildDADG.add_updater-206"><a href="#ChildDADG.add_updater-206"><span class="linenos">206</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ChildDADG.add_updater-207"><a href="#ChildDADG.add_updater-207"><span class="linenos">207</span></a>                <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="n">updated</span><span class="si">}</span><span class="s2"> is already updated by </span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">updater</span><span class="si">}</span><span class="s2">; tried to add updater &quot;</span>
</span><span id="ChildDADG.add_updater-208"><a href="#ChildDADG.add_updater-208"><span class="linenos">208</span></a>                             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2"> which wants to update the same node.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG.add_updater-209"><a href="#ChildDADG.add_updater-209"><span class="linenos">209</span></a>        <span class="c1"># add dependencies now that updated nodes have assigned updaters</span>
</span><span id="ChildDADG.add_updater-210"><a href="#ChildDADG.add_updater-210"><span class="linenos">210</span></a>        <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="n">updater</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
</span><span id="ChildDADG.add_updater-211"><a href="#ChildDADG.add_updater-211"><span class="linenos">211</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__add_dependency</span><span class="p">(</span><span class="n">dependency</span><span class="p">)</span>
</span><span id="ChildDADG.add_updater-212"><a href="#ChildDADG.add_updater-212"><span class="linenos">212</span></a>        <span class="c1"># check that the graph is not acyclic</span>
</span><span id="ChildDADG.add_updater-213"><a href="#ChildDADG.add_updater-213"><span class="linenos">213</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__check_acyclic</span><span class="p">():</span>
</span><span id="ChildDADG.add_updater-214"><a href="#ChildDADG.add_updater-214"><span class="linenos">214</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">remove_updater</span><span class="p">(</span><span class="n">updater_name</span><span class="p">)</span>
</span><span id="ChildDADG.add_updater-215"><a href="#ChildDADG.add_updater-215"><span class="linenos">215</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to add updater &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39;, as this added cycles to the graph.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG.add_updater-216"><a href="#ChildDADG.add_updater-216"><span class="linenos">216</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Add a new updater object to the DAG. Each node may only be updated by a single updater, or no updater.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>updater_name</strong>:  A human-readable name to assign to the added updater.</li>
<li><strong>updater</strong>:  The updater object. Can be created from a function using the <code>dag_updater</code> decorator.</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>None, or an <code>Error</code> object on failure.</p>
</blockquote>
</div>


                            </div>
                            <div id="ChildDADG.remove_updater" class="classattr">
                                        <input id="ChildDADG.remove_updater-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_updater</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="ChildDADG.remove_updater-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChildDADG.remove_updater"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChildDADG.remove_updater-218"><a href="#ChildDADG.remove_updater-218"><span class="linenos">218</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">remove_updater</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">updater_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG.remove_updater-219"><a href="#ChildDADG.remove_updater-219"><span class="linenos">219</span></a>        <span class="c1"># check updater exists with given updater_name</span>
</span><span id="ChildDADG.remove_updater-220"><a href="#ChildDADG.remove_updater-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="n">updater_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">:</span>
</span><span id="ChildDADG.remove_updater-221"><a href="#ChildDADG.remove_updater-221"><span class="linenos">221</span></a>            <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to remove updater &#39;</span><span class="si">{</span><span class="n">updater_name</span><span class="si">}</span><span class="s2">&#39;; it doesn&#39;t exist.&quot;</span><span class="p">)</span>
</span><span id="ChildDADG.remove_updater-222"><a href="#ChildDADG.remove_updater-222"><span class="linenos">222</span></a>        <span class="c1"># remove the dependencies</span>
</span><span id="ChildDADG.remove_updater-223"><a href="#ChildDADG.remove_updater-223"><span class="linenos">223</span></a>        <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">[</span><span class="n">updater_name</span><span class="p">]</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
</span><span id="ChildDADG.remove_updater-224"><a href="#ChildDADG.remove_updater-224"><span class="linenos">224</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__remove_dependency</span><span class="p">(</span><span class="n">dependency</span><span class="p">)</span>
</span><span id="ChildDADG.remove_updater-225"><a href="#ChildDADG.remove_updater-225"><span class="linenos">225</span></a>        <span class="c1"># remove the updater names for the updated nodes</span>
</span><span id="ChildDADG.remove_updater-226"><a href="#ChildDADG.remove_updater-226"><span class="linenos">226</span></a>        <span class="k">for</span> <span class="n">updated</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="p">[</span><span class="n">updater_name</span><span class="p">]</span><span class="o">.</span><span class="n">returned</span><span class="p">:</span>
</span><span id="ChildDADG.remove_updater-227"><a href="#ChildDADG.remove_updater-227"><span class="linenos">227</span></a>            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_if_exists</span><span class="p">(</span><span class="n">updated</span><span class="p">)</span>
</span><span id="ChildDADG.remove_updater-228"><a href="#ChildDADG.remove_updater-228"><span class="linenos">228</span></a>            <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG.remove_updater-229"><a href="#ChildDADG.remove_updater-229"><span class="linenos">229</span></a>                <span class="k">continue</span>
</span><span id="ChildDADG.remove_updater-230"><a href="#ChildDADG.remove_updater-230"><span class="linenos">230</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__send_children_copies</span><span class="p">(</span><span class="n">updated</span><span class="p">)</span>
</span><span id="ChildDADG.remove_updater-231"><a href="#ChildDADG.remove_updater-231"><span class="linenos">231</span></a>            <span class="k">if</span> <span class="n">updated</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">:</span>
</span><span id="ChildDADG.remove_updater-232"><a href="#ChildDADG.remove_updater-232"><span class="linenos">232</span></a>                <span class="c1"># This is a parent node, so we copy in order to mutate</span>
</span><span id="ChildDADG.remove_updater-233"><a href="#ChildDADG.remove_updater-233"><span class="linenos">233</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">updated</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ChildDADG.remove_updater-234"><a href="#ChildDADG.remove_updater-234"><span class="linenos">234</span></a>                <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nodes</span><span class="p">[</span><span class="n">updated</span><span class="p">]</span>
</span><span id="ChildDADG.remove_updater-235"><a href="#ChildDADG.remove_updater-235"><span class="linenos">235</span></a>            <span class="n">node</span><span class="o">.</span><span class="n">updater</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ChildDADG.remove_updater-236"><a href="#ChildDADG.remove_updater-236"><span class="linenos">236</span></a>        <span class="c1"># remove the updater</span>
</span><span id="ChildDADG.remove_updater-237"><a href="#ChildDADG.remove_updater-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">updater_name</span><span class="p">)</span>
</span><span id="ChildDADG.remove_updater-238"><a href="#ChildDADG.remove_updater-238"><span class="linenos">238</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


    

                            </div>
                            <div id="ChildDADG.get_with_args" class="classattr">
                                        <input id="ChildDADG.get_with_args-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_with_args</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="../utils/reflection.html#FunctionArgument">reg23_experiments.utils.reflection.FunctionArgument</a></span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n"><a href="../data/structs.html#Error">reg23_experiments.data.structs.Error</a></span>:</span></span>

                <label class="view-source-button" for="ChildDADG.get_with_args-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChildDADG.get_with_args"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChildDADG.get_with_args-240"><a href="#ChildDADG.get_with_args-240"><span class="linenos">240</span></a>    <span class="nd">@__data_mutating</span>
</span><span id="ChildDADG.get_with_args-241"><a href="#ChildDADG.get_with_args-241"><span class="linenos">241</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_with_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FunctionArgument</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">Error</span><span class="p">:</span>
</span><span id="ChildDADG.get_with_args-242"><a href="#ChildDADG.get_with_args-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ChildDADG.get_with_args-243"><a href="#ChildDADG.get_with_args-243"><span class="linenos">243</span></a><span class="sd">        Get the given list of named arguments from the `DAG`, returning an Error if any required argument is not</span>
</span><span id="ChildDADG.get_with_args-244"><a href="#ChildDADG.get_with_args-244"><span class="linenos">244</span></a><span class="sd">        available.</span>
</span><span id="ChildDADG.get_with_args-245"><a href="#ChildDADG.get_with_args-245"><span class="linenos">245</span></a><span class="sd">        :param args: list of function arguments, marked with whether they are required</span>
</span><span id="ChildDADG.get_with_args-246"><a href="#ChildDADG.get_with_args-246"><span class="linenos">246</span></a><span class="sd">        :return: A dictionary mapping argument name to retrieved value.</span>
</span><span id="ChildDADG.get_with_args-247"><a href="#ChildDADG.get_with_args-247"><span class="linenos">247</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ChildDADG.get_with_args-248"><a href="#ChildDADG.get_with_args-248"><span class="linenos">248</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ChildDADG.get_with_args-249"><a href="#ChildDADG.get_with_args-249"><span class="linenos">249</span></a>        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
</span><span id="ChildDADG.get_with_args-250"><a href="#ChildDADG.get_with_args-250"><span class="linenos">250</span></a>            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="ChildDADG.get_with_args-251"><a href="#ChildDADG.get_with_args-251"><span class="linenos">251</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Error</span><span class="p">):</span>
</span><span id="ChildDADG.get_with_args-252"><a href="#ChildDADG.get_with_args-252"><span class="linenos">252</span></a>                <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
</span><span id="ChildDADG.get_with_args-253"><a href="#ChildDADG.get_with_args-253"><span class="linenos">253</span></a>                    <span class="k">return</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting argument </span><span class="si">{</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: &#39;</span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="ChildDADG.get_with_args-254"><a href="#ChildDADG.get_with_args-254"><span class="linenos">254</span></a>                <span class="k">continue</span>
</span><span id="ChildDADG.get_with_args-255"><a href="#ChildDADG.get_with_args-255"><span class="linenos">255</span></a>            <span class="n">ret</span><span class="p">[</span><span class="n">arg</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="ChildDADG.get_with_args-256"><a href="#ChildDADG.get_with_args-256"><span class="linenos">256</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span></pre></div>


            <div class="docstring"><p>Get the given list of named arguments from the <code>DAG</code>, returning an Error if any required argument is not
available.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>args</strong>:  list of function arguments, marked with whether they are required</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>A dictionary mapping argument name to retrieved value.</p>
</blockquote>
</div>


                            </div>
                            <div id="ChildDADG.render" class="classattr">
                                        <input id="ChildDADG.render-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">render</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="ChildDADG.render-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ChildDADG.render"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ChildDADG.render-258"><a href="#ChildDADG.render-258"><span class="linenos">258</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ChildDADG.render-259"><a href="#ChildDADG.render-259"><span class="linenos">259</span></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">graphviz</span>
</span><span id="ChildDADG.render-260"><a href="#ChildDADG.render-260"><span class="linenos">260</span></a>        <span class="n">g</span> <span class="o">=</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Digraph</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>
</span><span id="ChildDADG.render-261"><a href="#ChildDADG.render-261"><span class="linenos">261</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">updater</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__updaters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ChildDADG.render-262"><a href="#ChildDADG.render-262"><span class="linenos">262</span></a>            <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="n">updater</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
</span><span id="ChildDADG.render-263"><a href="#ChildDADG.render-263"><span class="linenos">263</span></a>                <span class="n">g</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">dependency</span><span class="o">.</span><span class="n">depender</span><span class="p">,</span> <span class="n">dependency</span><span class="o">.</span><span class="n">depended</span><span class="p">)</span>
</span><span id="ChildDADG.render-264"><a href="#ChildDADG.render-264"><span class="linenos">264</span></a>        <span class="n">g</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>